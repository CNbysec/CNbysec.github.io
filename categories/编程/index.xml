<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>编程 - 分类 - bysec</title>
        <link>https://www.bysec.cn/categories/%E7%BC%96%E7%A8%8B/</link>
        <description>编程 - 分类 - bysec</description>
        <generator>Hugo -- gohugo.io</generator><language>zh-CN</language><managingEditor>CNbysec@foxmail.com (bysec)</managingEditor>
            <webMaster>CNbysec@foxmail.com (bysec)</webMaster><lastBuildDate>Fri, 19 Nov 2021 18:41:25 &#43;0800</lastBuildDate><atom:link href="https://www.bysec.cn/categories/%E7%BC%96%E7%A8%8B/" rel="self" type="application/rss+xml" /><item>
    <title>Python中的句柄操作的方法示例</title>
    <link>https://www.bysec.cn/python%E4%B8%AD%E7%9A%84%E5%8F%A5%E6%9F%84%E6%93%8D%E4%BD%9C%E7%9A%84%E6%96%B9%E6%B3%95%E7%A4%BA%E4%BE%8B/</link>
    <pubDate>Fri, 19 Nov 2021 18:41:25 &#43;0800</pubDate><author>
        <name>bysec</name>
    </author><guid>https://www.bysec.cn/python%E4%B8%AD%E7%9A%84%E5%8F%A5%E6%9F%84%E6%93%8D%E4%BD%9C%E7%9A%84%E6%96%B9%E6%B3%95%E7%A4%BA%E4%BE%8B/</guid>
    <description><![CDATA[<h1 id="遍历windows下-所有句柄及窗口名称">遍历windows下 所有句柄及窗口名称</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">win32gui</span>
<span class="n">hwnd_title</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">get_all_hwnd</span><span class="p">(</span><span class="n">hwnd</span><span class="p">,</span><span class="n">mouse</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">IsWindow</span><span class="p">(</span><span class="n">hwnd</span><span class="p">)</span> <span class="ow">and</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">IsWindowEnabled</span><span class="p">(</span><span class="n">hwnd</span><span class="p">)</span> <span class="ow">and</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">IsWindowVisible</span><span class="p">(</span><span class="n">hwnd</span><span class="p">):</span>
        <span class="n">hwnd_title</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">hwnd</span><span class="p">:</span><span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowText</span><span class="p">(</span><span class="n">hwnd</span><span class="p">)})</span>
<span class="n">win32gui</span><span class="o">.</span><span class="n">EnumWindows</span><span class="p">(</span><span class="n">get_all_hwnd</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
 
<span class="k">for</span> <span class="n">h</span><span class="p">,</span><span class="n">t</span> <span class="ow">in</span> <span class="n">hwnd_title</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s2">&#34;&#34;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><h1 id="通过窗口标题获取句柄">通过窗口标题获取句柄</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">win32gui</span>
 
<span class="n">hld</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">FindWindow</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span><span class="sa">u</span><span class="s2">&#34;Adobe Acrobat&#34;</span><span class="p">)</span> <span class="c1">#返回窗口标题为Adobe Acrobat的句柄 </span>
</code></pre></td></tr></table>
</div>
</div><h1 id="通过父窗口句柄获取子句柄">通过父窗口句柄获取子句柄</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="c1">#parent为父窗口句柄id</span>
<span class="k">def</span> <span class="nf">get_child_windows</span><span class="p">(</span><span class="n">parent</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">parent</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">hwndChildList</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">win32gui</span><span class="o">.</span><span class="n">EnumChildWindows</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">hwnd</span><span class="p">,</span> <span class="n">param</span><span class="p">:</span> <span class="n">param</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">hwnd</span><span class="p">),</span> <span class="n">hwndChildList</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hwndChildList</span> 
</code></pre></td></tr></table>
</div>
</div><h1 id="根据句柄获取句柄标题和类名">根据句柄获取句柄标题和类名</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">win32gui</span>
<span class="c1">#获取标题</span>
<span class="n">title</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowText</span><span class="p">(</span><span class="n">jbid</span><span class="p">)</span>  
<span class="c1">#获取类名 </span>
<span class="n">clsname</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetClassName</span><span class="p">(</span><span class="n">jbid</span><span class="p">)</span>  
</code></pre></td></tr></table>
</div>
</div><h1 id="根据句柄获取窗口位置">根据句柄获取窗口位置</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">win32gui</span>
<span class="n">left</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">=</span> <span class="n">win32gui</span><span class="o">.</span><span class="n">GetWindowRect</span><span class="p">(</span><span class="n">jbid</span><span class="p">)</span>
<span class="c1">#分别为左、上、右、下的窗口位置 </span>
</code></pre></td></tr></table>
</div>
</div><h1 id="根据句柄进行点击操作">根据句柄进行点击操作</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">win32api</span><span class="o">,</span><span class="nn">win32con</span>
 
<span class="n">win32api</span><span class="o">.</span><span class="n">SetCursorPos</span><span class="p">([</span><span class="n">横坐标</span><span class="p">,</span> <span class="n">纵坐标</span><span class="p">])</span>
<span class="c1">#根据横纵坐标定位光标</span>
<span class="n">win32api</span><span class="o">.</span><span class="n">mouse_event</span><span class="p">(</span><span class="n">win32con</span><span class="o">.</span><span class="n">MOUSEEVENTF_LEFTUP</span> <span class="o">|</span> <span class="n">win32con</span><span class="o">.</span><span class="n">MOUSEEVENTF_LEFTDOWN</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1">#给光标定位的位置进行单击操作（若想进行双击操作，可以延时几毫秒再点击一次）</span>
<span class="n">win32api</span><span class="o">.</span><span class="n">mouse_event</span><span class="p">(</span><span class="n">win32con</span><span class="o">.</span><span class="n">MOUSEEVENTF_RIGHTUP</span> <span class="o">|</span> <span class="n">win32con</span><span class="o">.</span><span class="n">MOUSEEVENTF_RIGHTDOWN</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1">#给光标定位的位置进行右击操作 </span>
</code></pre></td></tr></table>
</div>
</div><h1 id="根据句柄将窗口放在最前">根据句柄将窗口放在最前</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="n">win32gui</span><span class="o">.</span><span class="n">SetForegroundWindow</span><span class="p">(</span><span class="n">jbid</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div>]]></description>
</item></channel>
</rss>
