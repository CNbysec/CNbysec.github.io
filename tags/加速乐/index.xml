<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>加速乐 - 标签 - bysec</title>
        <link>http://localhost:1313/tags/%E5%8A%A0%E9%80%9F%E4%B9%90/</link>
        <description>加速乐 - 标签 - bysec</description>
        <generator>Hugo -- gohugo.io</generator><language>zh-CN</language><managingEditor>bysec@qq.com (bysec)</managingEditor>
            <webMaster>bysec@qq.com (bysec)</webMaster><lastBuildDate>Sun, 06 Oct 2024 20:42:37 &#43;0800</lastBuildDate><atom:link href="http://localhost:1313/tags/%E5%8A%A0%E9%80%9F%E4%B9%90/" rel="self" type="application/rss+xml" /><item>
    <title>逆向分析某网站加速乐参数流程详解</title>
    <link>http://localhost:1313/%E9%80%86%E5%90%91%E5%88%86%E6%9E%90%E6%9F%90%E7%BD%91%E7%AB%99%E5%8A%A0%E9%80%9F%E4%B9%90%E5%8F%82%E6%95%B0%E6%B5%81%E7%A8%8B%E8%AF%A6%E8%A7%A3/</link>
    <pubDate>Sun, 06 Oct 2024 20:42:37 &#43;0800</pubDate><author>
        <name>bysec</name>
    </author><guid>http://localhost:1313/%E9%80%86%E5%90%91%E5%88%86%E6%9E%90%E6%9F%90%E7%BD%91%E7%AB%99%E5%8A%A0%E9%80%9F%E4%B9%90%E5%8F%82%E6%95%B0%E6%B5%81%E7%A8%8B%E8%AF%A6%E8%A7%A3/</guid>
    <description><![CDATA[<blockquote>
<p><em>转载自： <a href="https://juejin.cn/post/7386485874300977178" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/7386485874300977178</a></em></p>
</blockquote>
<h2 id="前言" class="headerLink">
    <a href="#%e5%89%8d%e8%a8%80" class="header-mark"></a>前言</h2><p>加速乐作为一种常见的反爬虫技术，在网络上已有大量详尽深入的教程可供参考。然而，对于那些初次接触的人来说，直接面对它可能仍会感到困惑。</p>
<h2 id="声明" class="headerLink">
    <a href="#%e5%a3%b0%e6%98%8e" class="header-mark"></a>声明</h2><blockquote>
<p>本文仅用于学习交流，学习探讨逆向知识，欢迎私信共享学习心得。如有侵权，联系博主删除。请勿商用，否则后果自负。</p>
</blockquote>
<h2 id="什么是加速乐" class="headerLink">
    <a href="#%e4%bb%80%e4%b9%88%e6%98%af%e5%8a%a0%e9%80%9f%e4%b9%90" class="header-mark"></a>什么是加速乐？</h2><p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000010CdJ93CHwXA.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000010CdJ93CHwXA.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000010CdJ93CHwXA.jpg">
        
    </a></p>
<p>加速乐采用了一系列的高级反爬虫技术，包括OB混淆、动态加密算法和多层Cookie获取，以确保整体校验的严密性。关键校验字段位于Cookie中的<code>__jsl_clearance_s</code>。其<strong>验证过程通常涉及三次关键的请求</strong>：</p>
<ol>
<li>
<p><strong>首次请求</strong>：当用户首次尝试访问目标网站时，服务器会返回一个特殊的521状态码，其响应数据通过AAEncode技术进行混淆处理，以初步筛选访问者。</p>
</li>
<li>
<p><strong>二次请求</strong>：紧接着的第二次请求中，如果服务器继续检测到可疑行为，它会再次返回521状态码，但这次响应数据将采用更为复杂的OB混淆，进一步验证访问者的身份。</p>
</li>
<li>
<p><strong>三次请求</strong>：只有在前两次请求成功通过验证后，第三次请求才能成功访问网站，此时服务器将返回正常的状态码200，并提供用户所需的内容。</p>
</li>
</ol>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001spKf70Onvsc.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001spKf70Onvsc.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001spKf70Onvsc.jpg">
        
    </a></p>
<p>通过这一连串精心设计的步骤，加速乐确保了只有合法的访问者能够顺利获取网站数据，从而有效抵御恶意爬虫的侵扰，我们要做的就是模拟这些操作，获取想要的数据。</p>
<h2 id="今日网站" class="headerLink">
    <a href="#%e4%bb%8a%e6%97%a5%e7%bd%91%e7%ab%99" class="header-mark"></a>今日网站</h2><p>目标URL: <code>aHR0cHM6Ly93d3cuY252ZC5vcmcuY24vZmxhdy90eXBlbGlzdD90eXBlSWQ9Mjc=</code></p>
<h2 id="流程分析-浏览器" class="headerLink">
    <a href="#%e6%b5%81%e7%a8%8b%e5%88%86%e6%9e%90-%e6%b5%8f%e8%a7%88%e5%99%a8" class="header-mark"></a>流程分析-浏览器</h2><p>按照常规做法，我们首先进行网络抓包分析。</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00004JfmID1VsZLD.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00004JfmID1VsZLD.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00004JfmID1VsZLD.jpg">
        
    </a></p>
<h3 id="第一次请求" class="headerLink">
    <a href="#%e7%ac%ac%e4%b8%80%e6%ac%a1%e8%af%b7%e6%b1%82" class="header-mark"></a>第一次请求</h3><ul>
<li><code>发送</code>：未携带 Cookie</li>
<li><code>响应</code>：状态码<code>521</code>，Cookie 中的<code>__jsluid_s</code>值和<code>js</code>代码</li>
</ul>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000K7qZU3ItDc3.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000K7qZU3ItDc3.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000K7qZU3ItDc3.jpg">
        
    </a></p>
<h3 id="第二次请求" class="headerLink">
    <a href="#%e7%ac%ac%e4%ba%8c%e6%ac%a1%e8%af%b7%e6%b1%82" class="header-mark"></a>第二次请求</h3><ul>
<li><code>发送</code>：Cookie 携带<code>__jsluid_s</code>和<code>__jsl_clearance_s</code>值</li>
<li><code>响应</code>：状态码<code>521</code>，新的<code>js</code>代码</li>
</ul>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00002oaIvJ2FWXrj.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00002oaIvJ2FWXrj.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00002oaIvJ2FWXrj.jpg">
        
    </a></p>
<h3 id="第三次请求" class="headerLink">
    <a href="#%e7%ac%ac%e4%b8%89%e6%ac%a1%e8%af%b7%e6%b1%82" class="header-mark"></a>第三次请求</h3><ul>
<li><code>发送</code>：Cookie 携带原始<code>__jsluid_s</code>值，新的<code>__jsl_clearance_s</code>值</li>
<li><code>响应</code>：状态码<code>200</code>，正文内容</li>
</ul>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00003CsbsE3mrA5a.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00003CsbsE3mrA5a.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00003CsbsE3mrA5a.jpg">
        
    </a></p>
<blockquote>
<p>观察结果揭示了对同一页面共发起了三次<code>HTTP</code>请求：前两次请求均遭遇了<code>521</code>状态码的响应，而最后一次请求成功收到了<code>200</code>状态码。这种模式正是加速乐反爬虫机制的显著特征。</p>
</blockquote>
<h2 id="流程分析-抓包工具" class="headerLink">
    <a href="#%e6%b5%81%e7%a8%8b%e5%88%86%e6%9e%90-%e6%8a%93%e5%8c%85%e5%b7%a5%e5%85%b7" class="header-mark"></a>流程分析-抓包工具</h2><p>浏览器上我们没能看到具体的响应，我们借助抓包工具试试，这里使用的<code>Fiddler</code>。</p>
<h3 id="第一次请求-1" class="headerLink">
    <a href="#%e7%ac%ac%e4%b8%80%e6%ac%a1%e8%af%b7%e6%b1%82-1" class="header-mark"></a>第一次请求</h3><p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000bzZ1h0xViso.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000bzZ1h0xViso.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000bzZ1h0xViso.jpg">
        
    </a></p>
<h3 id="第二次请求-1" class="headerLink">
    <a href="#%e7%ac%ac%e4%ba%8c%e6%ac%a1%e8%af%b7%e6%b1%82-1" class="header-mark"></a>第二次请求</h3><p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001MlfbN033sPr.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001MlfbN033sPr.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001MlfbN033sPr.jpg">
        
    </a></p>
<h3 id="第三次请求-1" class="headerLink">
    <a href="#%e7%ac%ac%e4%b8%89%e6%ac%a1%e8%af%b7%e6%b1%82-1" class="header-mark"></a>第三次请求</h3><p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000fEc7o2dk3Gg.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000fEc7o2dk3Gg.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000fEc7o2dk3Gg.jpg">
        
    </a></p>
<blockquote>
<p>同样，看到了三次请求的过程，并且向我们展示了具体的响应。</p>
</blockquote>
<h2 id="逆向分析" class="headerLink">
    <a href="#%e9%80%86%e5%90%91%e5%88%86%e6%9e%90" class="header-mark"></a>逆向分析</h2><h3 id="获取第一个__jsl_clearance_s" class="headerLink">
    <a href="#%e8%8e%b7%e5%8f%96%e7%ac%ac%e4%b8%80%e4%b8%aa__jsl_clearance_s" class="header-mark"></a>获取第一个<code>__jsl_clearance_s</code></h3><p>通过<code>Fiddler</code>或使用<code>python</code>模拟请求，得到下面这样一段JS代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;j&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;l&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;s&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">+!+</span><span class="p">[]</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">3</span><span class="o">+</span><span class="mi">4</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">-~</span><span class="kc">false</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="mi">7</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">4</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">6</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">2</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">((</span><span class="mi">2</span><span class="o">&lt;&lt;</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">((</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(([</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="mi">0</span><span class="o">&gt;&gt;</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">-~</span><span class="mi">1</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">((</span><span class="mi">2</span><span class="o">^</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">((</span><span class="o">+</span><span class="kc">true</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;|&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;j&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;F&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">-~</span><span class="p">{}</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;j&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;j&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">~~</span><span class="s1">&#39;&#39;</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">~~</span><span class="kc">false</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">-~</span><span class="mi">1</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">((</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;%&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">&gt;&gt;</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;D&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;g&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">-~</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">-~</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">((</span><span class="o">+</span><span class="kc">false</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="o">~~</span><span class="p">{}</span><span class="o">+</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;P&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;m&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;N&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;o&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;n&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;u&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="s1">&#39;e&#39;</span><span class="p">);</span><span class="nx">location</span><span class="p">.</span><span class="nx">href</span><span class="o">=</span><span class="nx">location</span><span class="p">.</span><span class="nx">pathname</span><span class="o">+</span><span class="nx">location</span><span class="p">.</span><span class="nx">search</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>复制到浏览器执行下来看看:</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000025j1lt05AHCW.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000025j1lt05AHCW.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000025j1lt05AHCW.jpg">
        
    </a></p>
<p>得到了<code>__jsl_clearance_s=1719472445.236|-1|Lwj3uTFn1jj0Et0gI2JgiKm6Nf4%3D; Max-age=3600; Path=/; SameSite=None; Secure</code></p>
<p>而<code>__jsl_clearance_s</code>正是第二次请求需要带上的Cookie之一</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001H0vDS2nqE80.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001H0vDS2nqE80.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001H0vDS2nqE80.jpg">
        
    </a></p>
<blockquote>
<p>真的老登。为了使代码难以阅读和分析，还进行了<code>AAEncode</code>加密混淆。</p>
</blockquote>
<h3 id="获取第二个__jsl_clearance_s" class="headerLink">
    <a href="#%e8%8e%b7%e5%8f%96%e7%ac%ac%e4%ba%8c%e4%b8%aa__jsl_clearance_s" class="header-mark"></a>获取第二个<code>__jsl_clearance_s</code></h3><p>使用第一个请求后得到的 Cookies 继续发起第二段请求得到新的 JS 代码：</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000Y8Qgg2tnsDM.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000Y8Qgg2tnsDM.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000Y8Qgg2tnsDM.jpg">
        
    </a></p>
<p>代码被压缩了，不是很好看，使用在线 JS 美化（<code>https://spidertools.cn/#/formatJS</code>）后：</p>
<p>以下js代码需要用base64解码还原</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">dmFyIF8weDRmOWQgPSBbJ0huSnUnLCAndzRKb3c1QWsnLCAnQ0NyRHE4S1gnLCAnS01PVlpNT1gnLCAnTUNERGp6Zz0nLCAndzU1M3c1UERwdz09JywgJ0NzT1hiY09YJywgJ3dvWENoTU9Bd3EwPScsICdKc09QWGNPKycsICd3cGxGdzZKWScsICdiWDhwd3BVPScsICd3NmZEamt6Q213PT0nLCAnd29CMHdyckRrZz09JywgJ3c2SENtTU9pWkE9PScsICdHUmJDa2x3PScsICdkdzAzS3c9PScsICd3NDdEcWNPN1RnPT0nLCAnRDhPUmZ3ST0nLCAnR3NPQ1NzT3QnLCAnVGpVZVB3PT0nLCAnd3BYQ25IUkonLCAndzR4Unc3YkRyUT09JywgJ1NjS2R3cUREdVE9PScsICdNMWhEd3JRPScsICd3b0xDdXNPaHdvcz0nLCAnZUZaQnc3MD0nLCAndzdYRG9jS3NkQT09JywgJ0NEZkRqa009JywgJ3c2Y3pXY0s4JywgJ1gxZ3F3cmM9JywgJ3dyL0RvRHZEaWc9PScsICdmbEhEdUFnPScsICdIQmJEak1LTCcsICdRRkxDcGNPaScsICdJOE9CY2NPTScsICd3NkFtdzRuQ2xRPT0nLCAnUEVIQ29EZz0nLCAndzVSWXdvckRyZz09JywgJ3c0Wi93cUhEblE9PScsICdPaWZEZ0RjPScsICdIV3hsd3BrPScsICdhWDdEblFVPScsICd3NzNEdGNPbndvUT0nLCAnWW1IQ25jT0QnLCAnV1h3NXdwMD0nLCAnUDFiQ29zS2wnLCAnd3B6Q2o4T3J3clE9JywgJ3c0UUd3Nm5Ec1E9PScsICdhOEtzd3J2RGt3PT0nLCAnQUN6RG1IMD0nLCAnd29uRGw4T3R3ck09JywgJ0pXVmJ3cTA9JywgJ1ozWWR3cFE9JywgJ0NHakNnc0t4JywgJ3c1TWFQTU8zJywgJ3c1c2dMTU9UJywgJ0lsUEN0WDQ9JywgJ3c2ckRsOE9VVUE9PScsICd3NFREa3NPRFd3PT0nLCAnd3FMRHVDTERsQT09JywgJ3c2TERrc09PVmc9PScsICdWeGN3d3AwPScsICd3NXJDdjhLY0t3PT0nLCAnY2NLU0NzSzcnLCAnYW01WHc1Yz0nLCAndzc4Snc2bkRwUT09JywgJ0tVUENxc0tRJywgJ3c1M0NqY0tIQUE9PScsICd3N0hDbmNLNE5BPT0nLCAnd3JuQ3Q4T1p3b1E9JywgJ3dwTWZ3cFhDalE9PScsICd3NUFJQnNPVCcsICd3NWZEczFqQ2p3PT0nLCAndzVSRHc3TXonLCAnd3J3a3dxYkNxZz09JywgJ3c0VjZ3clhEaHc9PScsICdHQ3JEdkE9PScsICd3cWZEa01PV3c0VT0nLCAnR3gzRGtzS28nLCAndzZjNmJjS0UnLCAnRXdERHV3az0nLCAnZWh2Q2gyMD0nLCAndzZ0VXc1VENrdz09JywgJ3c0dEh3Ni9EaGc9PScsICdHTUtadzdIRHNnPT0nLCAndzVNQ0FNTzMnLCAndzdoU3c2bkRnQT09JywgJ3c3VERsY09Md3FJPScsICd3NjAyYThLNicsICd3N3A5dzd3dScsICd3cmt1dzZ3NCcsICd3NnRKdzVQQ213PT0nLCAnZmxqRHBCcz0nLCAndzZERHE4S1lTZz09JywgJ0xHSEN2OEtkJywgJ2VuYkN0WFE9JywgJzZLMmk1ckdtNmFpYTZLNmMnLCAndzRnQ0FzTzcnLCAnUHNPcllnST0nLCAnY0RJck5BPT0nLCAndzdQQ2doRVUnLCAnd3JzVHc1WENsUT09JywgJ3dwUUt3NFlxJywgJ0RRRERpUkk9JywgJ3c2N0R0TU9td3JVPScsICdEbWpDaU1LaycsICdYY0tCd3BuRG93PT0nLCAnd3FrMEhNTzAnLCAndzRZN3c2WERzdz09JywgJ3dyakR0Q0REaEE9PScsICd3b0REb1F2RGdnPT0nLCAnd28wNndyakN2QT09JywgJ3c1SmV3b0hEaVE9PScsICdOa0xDcGNLNicsICd3ckxDdUhwaScsICdZSG82d3BvPScsICd3N3ZDb3NLK3c3Yz0nLCAndzROTXc1c3cnLCAnd3BZMXdvWENpUT09JywgJ3dxc013b1RDb0E9PScsICd3NWRNd3B6RHRRPT0nLCAndzRKMXc0dkNxdz09JywgJ3c0SENvTU9WVkE9PScsICd3N3pDbzhLd3c1MD0nLCAnd3AvQ21VUmMnLCAndzdkS3c3SVcnLCAndzdJYndxST0nLCAnd3JEQ2pNT1l3cXM9JywgJ2FsM0NpY09sJywgJ3c1TENvc09jUWc9PScsICdKOE9JWk1PUicsICd3NEhEc3NLamZRPT0nLCAndzVaSndvckRpQT09JywgJ3c0d0JhY0tkJywgJ0pCekRuQkE9JywgJ3dvaGF3NnpEZ2c9PScsICd3NlZBdzdvVCcsICd3NXpDcE1LZHc2Yz0nLCAnYUJVV1BnPT0nLCAndzV6RHNNT2ZWUT09JywgJ3c3ZHR3b2ZEalE9PScsICd3cnZEcGhyRG9BPT0nLCAnd3FZbndxcEMnLCAnT3p6RG55dz0nLCAndzdMQ25zSzd3cjQ9JywgJ3c3MHB3NzdEaUE9PScsICd3cTk4dzV4UScsICdBaDNDbDF3PScsICd3clo0dzczRGdRPT0nLCAnSXNPalg4T3UnLCAnZW5GTXc3bz0nLCAndzUzRHBjS1BZZz09JywgJ3c3Sjl3cTNEbFE9PScsICdFOE9NZjhPQycsICdhUjRod3BZPScsICdOVExEaVRBPScsICdCTU92YkNBPScsICdaMjBwd29FPScsICd3cFp4dzVCWScsICdZRmpEb1NBPScsICd3NDNEb3NPcGZ3PT0nLCAndzd4Snc0YzYnLCAnd3JqQ24xSjQnLCAnd3JQQ3MyMVInLCAndzVkZnc2ZkNtZz09JywgJ2JjS3d3b1hEanc9PScsICdCM0Zvd3BZPScsICdXV2RhdzVJPScsICd3cTE0dzRSZScsICdLRm5DdWNLZScsICd3Nk00ZmNLbScsICdkSDlwdzVBPScsICd3b0xEak1PaXc1Zz0nLCAnSjBiQ3VnPT0nLCAnRTE3Q3FNSzgnLCAndzRGV3c0ZkRodz09JywgJ0Z4RERoajA9JywgJ3c0dkRyOE9nd3FVPScsICd3NEpOd3JqRG9BPT0nLCAnd3FnUUFNT2onLCAndzZsM3dxbkRsdz09JywgJ3dvd2ZSY09pJywgJ0pUUENoRzQ9JywgJ3c1UERvc09yd3JvPScsICd3cUl3QnNPOCcsICdDU2JEckVnPScsICdlblFoJywgJ084S3dMc09YJywgJ3c0cFR3NC9Da3c9PScsICd3b3pEdThPWXc3OD0nLCAnQVNUQ2dHND0nLCAndzZzTE84T3onLCAndzd2Q3JTd3knLCAnRlZyQ3FNSzknLCAndzVSNHc0VEN0dz09JywgJ0lzT1BhY093JywgJ3c1SERoOE8wV0E9PScsICd3b1Vid3AvRGp3PT0nLCAnd3BJY3c1d1onLCAnQmNPeWJjT08nLCAnRThLVnc0RERtQT09JywgJ2NCUXB3cjA9JywgJ3dxekNoOE9sd3FVPScsICdWMkpNdzdJPScsICd3NUJqdzY0MycsICd3NmNpdzczQ2p3PT0nLCAnTE1PRmNzT0gnLCAnWE1LMndwZkRqdz09JywgJ2ZFakRuajA9JywgJ0FNT1pROE9JJywgJ013SERnY0tCJywgJ3c2Tnp3cG5EbkE9PScsICdMekhEZ2NLVycsICdJOE9hU3pFPScsICd3cUFEdzVEQ3BBPT0nLCAnd29mRG5zT2p3NzA9JywgJ3dxRENuRmhXJywgJ3c1ckRyTU9OWEE9PScsICd3NEZRdzVnOCcsICd3NHRUdzZMRG9nPT0nLCAndzZKRXc0ckRqZz09JywgJ3c0aGN3bzNEdFE9PScsICdRbWJDcE1PKycsICdReFlRd3FJPScsICdjRWRGdzcwPScsICdBSEhDZ01LcCcsICdKOE9QYXNPSScsICdQUWZEaXNLZycsICdVc0t3d3B6RHJnPT0nLCAnS0dqQ29rST0nLCAnY01LM3dwYkNrUT09JywgJ3dvcytNY09DJywgJ1FXRlB3NjA9JywgJ3c3ZkRqVjdDblE9PScsICd3NzdEazhLZVNRPT0nLCAnQzhPUVNNT2gnLCAndzZQQ3RUa04nLCAndzZNV1g4S1AnLCAnRXNPTVpNT00nLCAnQ0JyRHV6MD0nLCAndzd2Q2s4Szl3Nzg9JywgJ0s4T2Vkc09sJywgJ3c0akRzc09Rd3B3PScsICd3cXJDZ01PZXdvVT0nLCAnd29WUnc0VmcnLCAndzZnSnc0L0Rvdz09JywgJ05nWERvY0txJywgJ3dxakN1c09Ed3JvPSddOwooZnVuY3Rpb24oXzB4MTkxMjFjLCBfMHg0ZjlkZmQpIHsKCXZhciBfMHgyNDJlN2UgPSBmdW5jdGlvbihfMHgxMjM0ZjIpIHsKCQl3aGlsZSAoLS1fMHgxMjM0ZjIpIHsKCQkJXzB4MTkxMjFjWydwdXNoJ10oXzB4MTkxMjFjWydzaGlmdCddKCkpCgkJfQoJfTsKCV8weDI0MmU3ZSgrK18weDRmOWRmZCkKfShfMHg0ZjlkLCAweGNkKSk7CnZhciBfMHgyNDJlID0gZnVuY3Rpb24oXzB4MTkxMjFjLCBfMHg0ZjlkZmQpIHsKCV8weDE5MTIxYyA9IF8weDE5MTIxYyAtIDB4MDsKCXZhciBfMHgyNDJlN2UgPSBfMHg0ZjlkW18weDE5MTIxY107CglpZiAoXzB4MjQyZVsncFdoYWpmJ10gPT09IHVuZGVmaW5lZCkgewoJCShmdW5jdGlvbigpIHsKCQkJdmFyIF8weDM3NGUzNyA9IGZ1bmN0aW9uKCkgewoJCQkJdmFyIF8weGMyNGJiMTsKCQkJCXRyeSB7CgkJCQkJXzB4YzI0YmIxID0gRnVuY3Rpb24oJ3JldHVyblx4MjAoZnVuY3Rpb24oKVx4MjAnICsgJ3t9LmNvbnN0cnVjdG9yKFx4MjJyZXR1cm5ceDIwdGhpc1x4MjIpKFx4MjApJyArICcpOycpKCkKCQkJCX0gY2F0Y2ggKF8weDM1YmUxMykgewoJCQkJCV8weGMyNGJiMSA9IHdpbmRvdwoJCQkJfQoJCQkJcmV0dXJuIF8weGMyNGJiMQoJCQl9OwoJCQl2YXIgXzB4MmJmNTc2ID0gXzB4Mzc0ZTM3KCk7CgkJCXZhciBfMHgxMTEzMTcgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLz0nOwoJCQlfMHgyYmY1NzZbJ2F0b2InXSB8fCAoXzB4MmJmNTc2WydhdG9iJ10gPSBmdW5jdGlvbihfMHg1ZGRlMTMpIHsKCQkJCXZhciBfMHg1YzczOTkgPSBTdHJpbmcoXzB4NWRkZTEzKVsncmVwbGFjZSddKC89KyQvLCAnJyk7CgkJCQl2YXIgXzB4MzVmODM0ID0gJyc7CgkJCQlmb3IgKHZhciBfMHhlNjcyNDggPSAweDAsIF8weDE5OTZlMCwgXzB4MTY4MzQ5LCBfMHhhNDk0MjUgPSAweDA7IF8weDE2ODM0OSA9IF8weDVjNzM5OVsnY2hhckF0J10oXzB4YTQ5NDI1KyspOyB</span><span class="o">+</span><span class="nx">XzB4MTY4MzQ5ICYmIChfMHgxOTk2ZTAgPSBfMHhlNjcyNDggJSAweDQgPyBfMHgxOTk2ZTAgKiAweDQwICsgXzB4MTY4MzQ5IDogXzB4MTY4MzQ5LCBfMHhlNjcyNDgrKyAlIDB4NCkgPyBfMHgzNWY4MzQgKz0gU3RyaW5nWydmcm9tQ2hhckNvZGUnXSgweGZmICYgXzB4MTk5NmUwID4</span><span class="o">+</span><span class="nx">ICgtMHgyICogXzB4ZTY3MjQ4ICYgMHg2KSkgOiAweDApIHsKCQkJCQlfMHgxNjgzNDkgPSBfMHgxMTEzMTdbJ2luZGV4T2YnXShfMHgxNjgzNDkpCgkJCQl9CgkJCQlyZXR1cm4gXzB4MzVmODM0CgkJCX0pCgkJfSgpKTsKCQl2YXIgXzB4MTQzMzFkID0gZnVuY3Rpb24oXzB4MjZhNTA5LCBfMHg1ZjMzNDYpIHsKCQkJdmFyIF8weDE1ODc5MyA9IFtdLAoJCQkJXzB4MjA0OWU5ID0gMHgwLAoJCQkJXzB4MzRhMTNmLCBfMHhhYTc5ZWIgPSAnJywKCQkJCV8weDQ3YmIzNiA9ICcnOwoJCQlfMHgyNmE1MDkgPSBhdG9iKF8weDI2YTUwOSk7CgkJCWZvciAodmFyIF8weDNlMjA4ZCA9IDB4MCwgXzB4NTM4YzFjID0gXzB4MjZhNTA5WydsZW5ndGgnXTsgXzB4M2UyMDhkIDwgXzB4NTM4YzFjOyBfMHgzZTIwOGQrKykgewoJCQkJXzB4NDdiYjM2ICs9ICclJyArICgnMDAnICsgXzB4MjZhNTA5WydjaGFyQ29kZUF0J10oXzB4M2UyMDhkKVsndG9TdHJpbmcnXSgweDEwKSlbJ3NsaWNlJ10oLTB4MikKCQkJfQoJCQlfMHgyNmE1MDkgPSBkZWNvZGVVUklDb21wb25lbnQoXzB4NDdiYjM2KTsKCQkJdmFyIF8weDEyMDY1MzsKCQkJZm9yIChfMHgxMjA2NTMgPSAweDA7IF8weDEyMDY1MyA8IDB4MTAwOyBfMHgxMjA2NTMrKykgewoJCQkJXzB4MTU4NzkzW18weDEyMDY1M10gPSBfMHgxMjA2NTMKCQkJfQoJCQlmb3IgKF8weDEyMDY1MyA9IDB4MDsgXzB4MTIwNjUzIDwgMHgxMDA7IF8weDEyMDY1MysrKSB7CgkJCQlfMHgyMDQ5ZTkgPSAoXzB4MjA0OWU5ICsgXzB4MTU4NzkzW18weDEyMDY1M10gKyBfMHg1ZjMzNDZbJ2NoYXJDb2RlQXQnXShfMHgxMjA2NTMgJSBfMHg1ZjMzNDZbJ2xlbmd0aCddKSkgJSAweDEwMDsKCQkJCV8weDM0YTEzZiA9IF8weDE1ODc5M1tfMHgxMjA2NTNdOwoJCQkJXzB4MTU4NzkzW18weDEyMDY1M10gPSBfMHgxNTg3OTNbXzB4MjA0OWU5XTsKCQkJCV8weDE1ODc5M1tfMHgyMDQ5ZTldID0gXzB4MzRhMTNmCgkJCX0KCQkJXzB4MTIwNjUzID0gMHgwOwoJCQlfMHgyMDQ5ZTkgPSAweDA7CgkJCWZvciAodmFyIF8weDFlOTU0ZiA9IDB4MDsgXzB4MWU5NTRmIDwgXzB4MjZhNTA5WydsZW5ndGgnXTsgXzB4MWU5NTRmKyspIHsKCQkJCV8weDEyMDY1MyA9IChfMHgxMjA2NTMgKyAweDEpICUgMHgxMDA7CgkJCQlfMHgyMDQ5ZTkgPSAoXzB4MjA0OWU5ICsgXzB4MTU4NzkzW18weDEyMDY1M10pICUgMHgxMDA7CgkJCQlfMHgzNGExM2YgPSBfMHgxNTg3OTNbXzB4MTIwNjUzXTsKCQkJCV8weDE1ODc5M1tfMHgxMjA2NTNdID0gXzB4MTU4NzkzW18weDIwNDllOV07CgkJCQlfMHgxNTg3OTNbXzB4MjA0OWU5XSA9IF8weDM0YTEzZjsKCQkJCV8weGFhNzllYiArPSBTdHJpbmdbJ2Zyb21DaGFyQ29kZSddKF8weDI2YTUwOVsnY2hhckNvZGVBdCddKF8weDFlOTU0ZikgXiBfMHgxNTg3OTNbKF8weDE1ODc5M1tfMHgxMjA2NTNdICsgXzB4MTU4NzkzW18weDIwNDllOV0pICUgMHgxMDBdKQoJCQl9CgkJCXJldHVybiBfMHhhYTc5ZWIKCQl9OwoJCV8weDI0MmVbJ2x6WW1TcCddID0gXzB4MTQzMzFkOwoJCV8weDI0MmVbJ05PS1hVTiddID0ge307CgkJXzB4MjQyZVsncFdoYWpmJ10gPSAhIVtdCgl9Cgl2YXIgXzB4MTIzNGYyID0gXzB4MjQyZVsnTk9LWFVOJ11bXzB4MTkxMjFjXTsKCWlmIChfMHgxMjM0ZjIgPT09IHVuZGVmaW5lZCkgewoJCWlmIChfMHgyNDJlWydhQWROcWsnXSA9PT0gdW5kZWZpbmVkKSB7CgkJCV8weDI0MmVbJ2FBZE5xayddID0gISFbXQoJCX0KCQlfMHgyNDJlN2UgPSBfMHgyNDJlWydselltU3AnXShfMHgyNDJlN2UsIF8weDRmOWRmZCk7CgkJXzB4MjQyZVsnTk9LWFVOJ11bXzB4MTkxMjFjXSA9IF8weDI0MmU3ZQoJfSBlbHNlIHsKCQlfMHgyNDJlN2UgPSBfMHgxMjM0ZjIKCX0KCXJldHVybiBfMHgyNDJlN2UKfTsKCmZ1bmN0aW9uIGhhc2goXzB4OTA2MGVjKSB7Cgl2YXIgXzB4NTZkOTNlID0ge307CglfMHg1NmQ5M2VbXzB4MjQyZSgnMHg4OCcsICdbZHdFJykgKyAnQiddID0gZnVuY3Rpb24oXzB4NTZkMzFjLCBfMHg0Njg0YzIpIHsKCQlyZXR1cm4gXzB4NTZkMzFjIF4gXzB4NDY4NGMyCgl9OwoJXzB4NTZkOTNlW18weDI0MmUoJzB4OTgnLCAnS0xzYicpICsgJ0snXSA9IGZ1bmN0aW9uKF8weDVkMWNiNCwgXzB4NGZlYzk3KSB7CgkJcmV0dXJuIF8weDVkMWNiNCArIF8weDRmZWM5NwoJfTsKCV8weDU2ZDkzZVtfMHgyNDJlKCcweGM5JywgJ1JkVW4nKSArICdRJ10gPSBmdW5jdGlvbihfMHgyODMwZjUsIF8weDMxMTVlZSkgewoJCXJldHVybiBfMHgyODMwZjUgJiBfMHgzMTE1ZWUKCX07CglfMHg1NmQ5M2VbXzB4MjQyZSgnMHgxYScsICd3SlhyJykgKyAnQyddID0gXzB4MjQyZSgnMHgzNycsICc3TWVLJykgKyBfMHgyNDJlKCcweDZhJywgJ1dpTiEnKSArIF8weDI0MmUoJzB4NTknLCAnNDQhYycpICsgXzB4MjQyZSgnMHgzNScsICcya3p1Jyk7CglfMHg1NmQ5M2VbXzB4MjQyZSgnMHgyNycsICdSZFVuJykgKyAnRSddID0gZnVuY3Rpb24oXzB4MWM5ODk3LCBfMHg0NWQxNjQpIHsKCQlyZXR1cm4gXzB4MWM5ODk3ID49IF8weDQ1ZDE2NAoJfTsKCV8weDU2ZDkzZVtfMHgyNDJlKCcweGI3JywgJ2p6KDgnKSArICdUJ10gPSBmdW5jdGlvbihfMHg0MjFmMDYsIF8weGQ1NWRkMikgewoJCXJldHVybiBfMHg0MjFmMDYgJiBfMHhkNTVkZDIKCX07CglfMHg1NmQ5M2VbXzB4MjQyZSgnMHg2ZScsICdES3h4JykgKyAndSddID0gZnVuY3Rpb24oXzB4NWYxNGUzLCBfMHhhYTFjZTApIHsKCQlyZXR1cm4gXzB4NWYxNGUzID4</span><span class="o">+</span><span class="nx">IF8weGFhMWNlMAoJfTsKCV8weDU2ZDkzZVtfMHgyNDJlKCcweDVmJywgJzJrenUnKSArICdXJ10gPSBmdW5jdGlvbihfMHgxZWU0NGEsIF8weDM1NzgzZikgewoJCXJldHVybiBfMHgxZWU0NGEgKiBfMHgzNTc4M2YKCX07CglfMHg1NmQ5M2VbXzB4MjQyZSgnMHgzNCcsICdSZFVuJykgKyAnYSddID0gZnVuY3Rpb24oXzB4NDZiN2YxLCBfMHg0YTIwZTUpIHsKCQlyZXR1cm4gXzB4NDZiN2YxIDwgXzB4NGEyMGU1Cgl9OwoJXzB4NTZkOTNlW18weDI0MmUoJzB4NzMnLCAnW3FWZycpICsgJ2gnXSA9IGZ1bmN0aW9uKF8weDE0ZGNkMiwgXzB4NGQ5ZDRkKSB7CgkJcmV0dXJuIF8weDE0ZGNkMiAhPT0gXzB4NGQ5ZDRkCgl9OwoJXzB4NTZkOTNlW18weDI0MmUoJzB4N2EnLCAnWW4jbycpICsgJ2QnXSA9IF8weDI0MmUoJzB4NjUnLCAnMzl3UicpICsgJ28nOwoJXzB4NTZkOTNlW18weDI0MmUoJzB4Y2EnLCAncnpAYicpICsgJ2cnXSA9IF8weDI0MmUoJzB4MmEnLCAnQWRkRCcpICsgJ0snOwoJXzB4NTZkOTNlW18weDI0MmUoJzB4Y2YnLCAnIU4lMCcpICsgJ2onXSA9IGZ1bmN0aW9uKF8weDQ4NjA1ZCwgXzB4MTg5OGQzKSB7CgkJcmV0dXJuIF8weDQ4NjA1ZCAtIF8weDE4OThkMwoJfTsKCV8weDU2ZDkzZVtfMHgyNDJlKCcweGE0JywgJyFOJTAnKSArICdGJ10gPSBmdW5jdGlvbihfMHg0ZjA5ZTYsIF8weDM3NWZiNikgewoJCXJldHVybiBfMHg0ZjA5ZTYgLSBfMHgzNzVmYjYKCX07CglfMHg1NmQ5M2VbXzB4MjQyZSgnMHhjNicsICdlVzhCJykgKyAnbyddID0gZnVuY3Rpb24oXzB4MzRlYjkzLCBfMHgzNzVmMDQpIHsKCQlyZXR1cm4gXzB4MzRlYjkzICogXzB4Mzc1ZjA0Cgl9OwoJXzB4NTZkOTNlW18weDI0MmUoJzB4MzYnLCAnW3FWZycpICsgJ2MnXSA9IGZ1bmN0aW9uKF8weGMyNTVlNCwgXzB4MjE4OTgxKSB7CgkJcmV0dXJuIF8weGMyNTVlNCAqIF8weDIxODk4MQoJfTsKCV8weDU2ZDkzZVtfMHgyNDJlKCcweGU4JywgJ0heKEgnKSArICdxJ10gPSBmdW5jdGlvbihfMHg5ZDI2ZTAsIF8weDJkNjY3NCkgewoJCXJldHVybiBfMHg5ZDI2ZTAgfCBfMHgyZDY2NzQKCX07CglfMHg1NmQ5M2VbXzB4MjQyZSgnMHhkJywgJ2hUJiMnKSArICdFJ10gPSBmdW5jdGlvbihfMHg0Y2JkMDEsIF8weDljMGJjZSkgewoJCXJldHVybiBfMHg0Y2JkMDEgPDwgXzB4OWMwYmNlCgl9OwoJXzB4NTZkOTNlW18weDI0MmUoJzB4NzUnLCAnKVhZTicpICsgJ3gnXSA9IGZ1bmN0aW9uKF8weDNjYTg2MCwgXzB4NWVlNzY4KSB7CgkJcmV0dXJuIF8weDNjYTg2MCB8IF8weDVlZTc2OAoJfTsKCV8weDU2ZDkzZVtfMHgyNDJlKCcweDUzJywgJzFQaVQnKSArICdHJ10gPSBmdW5jdGlvbihfMHg0YjA1MDcsIF8weDNmOWFkYikgewoJCXJldHVybiBfMHg0YjA1MDcgJiBfMHgzZjlhZGIKCX07CglfMHg1NmQ5M2VbXzB4MjQyZSgnMHgxNicsICdQcClSJykgKyAnayddID0gZnVuY3Rpb24oXzB4M2M4YjFlLCBfMHg0ZmJlYWYpIHsKCQlyZXR1cm4gXzB4M2M4YjFlICYgXzB4NGZiZWFmCgl9OwoJXzB4NTZkOTNlW18weDI0MmUoJzB4NzInLCAnajYkZScpICsgJ2wnXSA9IGZ1bmN0aW9uKF8weDNlYzFjNywgXzB4MzNkYzU0KSB7CgkJcmV0dXJuIF8weDNlYzFjNyBeIF8weDMzZGM1NAoJfTsKCV8weDU2ZDkzZVtfMHgyNDJlKCcweGFiJywgJ3FYdzcnKSArICdqJ10gPSBmdW5jdGlvbihfMHgxMDg5ZjgsIF8weDVjODdkNykgewoJCXJldHVybiBfMHgxMDg5ZjggPCBfMHg1Yzg3ZDcKCX07CglfMHg1NmQ5M2VbXzB4MjQyZSgnMHhjZCcsICddakRyJykgKyAnQyddID0gXzB4MjQyZSgnMHg0ZicsICdyekBiJykgKyBfMHgyNDJlKCcweGJiJywgJ0FkZEQnKSArIF8weDI0MmUoJzB4ZTAnLCAnajYkZScpICsgJzUnOwoJXzB4NTZkOTNlW18weDI0MmUoJzB4YjMnLCAnaFQmIycpICsgJ2QnXSA9IGZ1bmN0aW9uKF8weDVkN2I5MCwgXzB4NWE0MjVjKSB7CgkJcmV0dXJuIF8weDVkN2I5MCArIF8weDVhNDI1YwoJfTsKCV8weDU2ZDkzZVtfMHgyNDJlKCcweDk1JywgJ1ZTV3AnKSArICdQJ10gPSBmdW5jdGlvbihfMHg0ZWNiYjEsIF8weDUzNDEwYSkgewoJCXJldHVybiBfMHg0ZWNiYjEgLSBfMHg1MzQxMGEKCX07CglfMHg1NmQ5M2VbXzB4MjQyZSgnMHg3MScsICcpWFlOJykgKyAnTiddID0gZnVuY3Rpb24oXzB4NTJhYWZhLCBfMHgyOWRkYWEsIF8weDI3NTIyYSkgewoJCXJldHVybiBfMHg1MmFhZmEoXzB4MjlkZGFhLCBfMHgyNzUyMmEpCgl9OwoJXzB4NTZkOTNlW18weDI0MmUoJzB4ZGEnLCAnUFMqdCcpICsgJ2snXSA9IGZ1bmN0aW9uKF8weDc4MDlkMCwgXzB4NTQ3MGU3LCBfMHgzMzEyZjAsIF8weDRhMGZmMiwgXzB4MzRlMWI5KSB7CgkJcmV0dXJuIF8weDc4MDlkMChfMHg1NDcwZTcsIF8weDMzMTJmMCwgXzB4NGEwZmYyLCBfMHgzNGUxYjkpCgl9OwoJXzB4NTZkOTNlW18weDI0MmUoJzB4MCcsICc3TWVLJykgKyAnbCddID0gZnVuY3Rpb24oXzB4NThmODNiLCBfMHg1MDAwNTAsIF8weDFhM2RmNSkgewoJCXJldHVybiBfMHg1OGY4M2IoXzB4NTAwMDUwLCBfMHgxYTNkZjUpCgl9OwoJXzB4NTZkOTNlW18weDI0MmUoJzB4YmMnLCAnM1F3QScpICsgJ0MnXSA9IGZ1bmN0aW9uKF8weDIzNzU0NywgXzB4NDgwOGQ0KSB7CgkJcmV0dXJuIF8weDIzNzU0NyhfMHg0ODA4ZDQpCgl9OwoJXzB4NTZkOTNlW18weDI0MmUoJzB4MzEnLCAnYUhQMicpICsgJ0snXSA9IGZ1bmN0aW9uKF8weDMxYzIwYiwgXzB4M2YwMzhiKSB7CgkJcmV0dXJuIF8weDMxYzIwYiArIF8weDNmMDM4YgoJfTsKCV8weDU2ZDkzZVtfMHgyNDJlKCcweGE4JywgJ2hUJiMnKSArICdtJ10gPSBmdW5jdGlvbihfMHgzNGI1MGUsIF8weDFmOWMwNykgewoJCXJldHVybiBfMHgzNGI1MGUgKyBfMHgxZjljMDcKCX07CglfMHg1NmQ5M2VbXzB4MjQyZSgnMHhkYicsICdlVzhCJykgKyAnYSddID0gZnVuY3Rpb24oXzB4ZTQwMDhjLCBfMHg1MmFiMGYpIHsKCQlyZXR1cm4gXzB4ZTQwMDhjICsgXzB4NTJhYjBmCgl9OwoJXzB4NTZkOTNlW18weDI0MmUoJzB4OScsICdNREdNJykgKyAnTyddID0gZnVuY3Rpb24oXzB4MWFjMjVlLCBfMHg1OGZkOTkpIHsKCQlyZXR1cm4gXzB4MWFjMjVlKF8weDU4ZmQ5OSkKCX07CglfMHg1NmQ5M2VbXzB4MjQyZSgnMHgyNScsICc0NCFjJykgKyAndCddID0gZnVuY3Rpb24oXzB4MThkNmQ2LCBfMHhlZjQxZTQpIHsKCQlyZXR1cm4gXzB4MThkNmQ2KF8weGVmNDFlNCkKCX07Cgl2YXIgXzB4NWFhMzg4ID0gXzB4NTZkOTNlOwoKCWZ1bmN0aW9uIF8weDRmMjEwNShfMHg1NDhlMTEsIF8weGQ2ZjdlZSkgewoJCXJldHVybiBfMHg1YWEzODhbXzB4MjQyZSgnMHhkOScsICdpISljJykgKyAnQiddKF8weDVhYTM4OFtfMHgyNDJlKCcweDYxJywgJ2o2JGUnKSArICdLJ10oXzB4NTQ4ZTExICYgMHg3ZmZmZmZmZiwgXzB4NWFhMzg4W18weDI0MmUoJzB4YzQnLCAncl43aCcpICsgJ1EnXShfMHhkNmY3ZWUsIDB4N2ZmZmZmZmYpKSwgXzB4NTQ4ZTExICYgMHg4MDAwMDAwMCkgXiBfMHhkNmY3ZWUgJiAweDgwMDAwMDAwCgl9CgoJZnVuY3Rpb24gXzB4NDdiZjM5KF8weDFmMmRjYSkgewoJCXZhciBfMHgzYmU3YzYgPSBfMHg1YWEzODhbXzB4MjQyZSgnMHg3OCcsICdIXihIJykgKyAnQyddOwoJCXZhciBfMHg0MDNjZDIgPSAnJzsKCQlmb3IgKHZhciBfMHg0OWQ5YmIgPSAweDc7IF8weDVhYTM4OFtfMHgyNDJlKCcweDlkJywgJ11qRHInKSArICdFJ10oXzB4NDlkOWJiLCAweDApOyBfMHg0OWQ5YmItLSkgewoJCQlfMHg0MDNjZDIgKz0gXzB4M2JlN2M2W18weDI0MmUoJzB4M2YnLCAnXWpEcicpICsgJ0F0J10oXzB4NWFhMzg4W18weDI0MmUoJzB4OGQnLCAnNDExXicpICsgJ1QnXShfMHgxZjJkY2EgPj4gXzB4NDlkOWJiICogMHg0LCAweGYpKQoJCX0KCQlyZXR1cm4gXzB4NDAzY2QyCgl9CgoJZnVuY3Rpb24gXzB4Mzc0NjkxKF8weDM0MzFmNCkgewoJCXZhciBfMHgyMjc3ZmIgPSBfMHg1YWEzODhbXzB4MjQyZSgnMHgyNCcsICdXaU4hJykgKyAnSyddKF8weDVhYTM4OFtfMHgyNDJlKCcweDg5JywgJ2khKWMnKSArICd1J10oXzB4MzQzMWY0W18weDI0MmUoJzB4ZjUnLCAnQWRkRCcpICsgJ3RoJ10gKyAweDgsIDB4NiksIDB4MSksCgkJCV8weDRjMGUyZiA9IG5ldyBBcnJheShfMHg1YWEzODhbXzB4MjQyZSgnMHg0OScsICdLTHNiJykgKyAnVyddKF8weDIyNzdmYiwgMHgxMCkpOwoJCWZvciAodmFyIF8weDMwYWY5NyA9IDB4MDsgXzB4NWFhMzg4W18weDI0MmUoJzB4NDInLCAnMVBpVCcpICsgJ2EnXShfMHgzMGFmOTcsIF8weDVhYTM4OFtfMHgyNDJlKCcweGNjJywgJ2hUJiMnKSArICdXJ10oXzB4MjI3N2ZiLCAweDEwKSk7IF8weDMwYWY5NysrKSB7CgkJCWlmIChfMHg1YWEzODhbXzB4MjQyZSgnMHg2YycsICczUXdBJykgKyAnaCddKF8weDVhYTM4OFtfMHgyNDJlKCcweDYnLCAnanooOCcpICsgJ2QnXSwgXzB4NWFhMzg4W18weDI0MmUoJzB4MScsICdyXjdoJykgKyAnZyddKSkgewoJCQkJXzB4NGMwZTJmW18weDMwYWY5N10gPSAweDAKCQkJfSBlbHNlIHsKCQkJCXJldHVybgoJCQl9CgkJfQoJCWZvciAoXzB4MzBhZjk3ID0gMHgwOyBfMHgzMGFmOTcgPCBfMHgzNDMxZjRbXzB4MjQyZSgnMHhmNScsICdBZGREJykgKyAndGgnXTsgXzB4MzBhZjk3KyspIHsKCQkJXzB4NGMwZTJmW18weDMwYWY5NyA</span><span class="o">+</span><span class="nx">PiAweDJdIHw9IF8weDM0MzFmNFtfMHgyNDJlKCcweDMzJywgJ1dpTiEnKSArIF8weDI0MmUoJzB4MicsICdWU1dwJykgKyAnQXQnXShfMHgzMGFmOTcpIDw8IF8weDVhYTM4OFtfMHgyNDJlKCcweDhlJywgJzQzczInKSArICdqJ10oMHgxOCwgKF8weDMwYWY5NyAmIDB4MykgKiAweDgpCgkJfQoJCV8weDRjMGUyZltfMHg1YWEzODhbXzB4MjQyZSgnMHgxOCcsICcpclZHJykgKyAndSddKF8weDMwYWY5NywgMHgyKV0gfD0gMHg4MCA8PCBfMHg1YWEzODhbXzB4MjQyZSgnMHhlZScsICdhSFAyJykgKyAnRiddKDB4MTgsIF8weDVhYTM4OFtfMHgyNDJlKCcweGE3JywgJ11qRHInKSArICdXJ10oXzB4MzBhZjk3ICYgMHgzLCAweDgpKTsKCQlfMHg0YzBlMmZbXzB4NWFhMzg4W18weDI0MmUoJzB4ODMnLCAnWW4jbycpICsgJ28nXShfMHgyMjc3ZmIsIDB4MTApIC0gMHgxXSA9IF8weDVhYTM4OFtfMHgyNDJlKCcweDkxJywgJ25SQmonKSArICdjJ10oXzB4MzQzMWY0W18weDI0MmUoJzB4OTYnLCAnd0pYcicpICsgJ3RoJ10sIDB4OCk7CgkJcmV0dXJuIF8weDRjMGUyZgoJfQoKCWZ1bmN0aW9uIF8weDRiM2Y5MShfMHg1YjkwMjYsIF8weDNhZDM3YSkgewoJCXJldHVybiBfMHg1YWEzODhbXzB4MjQyZSgnMHg4ZicsICc1NUZwJykgKyAncSddKF8weDVhYTM4OFtfMHgyNDJlKCcweGVmJywgJzM5d1InKSArICdFJ10oXzB4NWI5MDI2LCBfMHgzYWQzN2EpLCBfMHg1YjkwMjYgPj4</span><span class="o">+</span><span class="nx">IDB4MjAgLSBfMHgzYWQzN2EpCgl9CgoJZnVuY3Rpb24gXzB4MWE1MWZlKF8weDE0NjAwNSwgXzB4MjA4ZWFiLCBfMHgzN2ViY2UsIF8weDIzMDBlYikgewoJCWlmIChfMHgxNDYwMDUgPCAweDE0KSByZXR1cm4gXzB4NWFhMzg4W18weDI0MmUoJzB4ZDYnLCAnUEExbicpICsgJ3gnXShfMHg1YWEzODhbXzB4MjQyZSgnMHg3ZicsICdEN0llJykgKyAnVCddKF8weDIwOGVhYiwgXzB4MzdlYmNlKSwgXzB4NWFhMzg4W18weDI0MmUoJzB4ZWQnLCAnIU4lMCcpICsgJ1QnXSh</span><span class="o">+</span><span class="nx">XzB4MjA4ZWFiLCBfMHgyMzAwZWIpKTsKCQlpZiAoXzB4NWFhMzg4W18weDI0MmUoJzB4ZjMnLCAnRDdJZScpICsgJ2EnXShfMHgxNDYwMDUsIDB4MjgpKSByZXR1cm4gXzB4NWFhMzg4W18weDI0MmUoJzB4MjEnLCAncl43aCcpICsgJ0InXShfMHgyMDhlYWIgXiBfMHgzN2ViY2UsIF8weDIzMDBlYik7CgkJaWYgKF8weDVhYTM4OFtfMHgyNDJlKCcweGFjJywgJ3lMNXAnKSArICdhJ10oXzB4MTQ2MDA1LCAweDNjKSkgcmV0dXJuIF8weDVhYTM4OFtfMHgyNDJlKCcweDI5JywgJ1BwKVInKSArICd4J10oXzB4MjA4ZWFiICYgXzB4MzdlYmNlIHwgXzB4NWFhMzg4W18weDI0MmUoJzB4NGEnLCAncnpAYicpICsgJ0cnXShfMHgyMDhlYWIsIF8weDIzMDBlYiksIF8weDVhYTM4OFtfMHgyNDJlKCcweDE3JywgJ1ZTV3AnKSArICdrJ10oXzB4MzdlYmNlLCBfMHgyMzAwZWIpKTsKCQlyZXR1cm4gXzB4NWFhMzg4W18weDI0MmUoJzB4OTknLCAnS0xzYicpICsgJ0InXShfMHg1YWEzODhbXzB4MjQyZSgnMHhkNCcsICdpISljJykgKyAnbCddKF8weDIwOGVhYiwgXzB4MzdlYmNlKSwgXzB4MjMwMGViKQoJfQoKCWZ1bmN0aW9uIF8weDU2NTdhNihfMHgyYjA3NmEpIHsKCQlyZXR1cm4gXzB4MmIwNzZhIDwgMHgxNCA</span><span class="o">/</span><span class="nx">IDB4NWE4Mjc5OTkgOiBfMHgyYjA3NmEgPCAweDI4ID8gMHg2ZWQ5ZWJhMSA6IF8weDVhYTM4OFtfMHgyNDJlKCcweDNiJywgJzM5d1InKSArICdqJ10oXzB4MmIwNzZhLCAweDNjKSA</span><span class="o">/</span><span class="nx">IC0weDcwZTQ0MzI0IDogLTB4MzU5ZDNlMmEKCX0KCXZhciBfMHg0MzNkNzcgPSBfMHgzNzQ2OTEoXzB4OTA2MGVjKTsKCXZhciBfMHgxNTIwZjMgPSBuZXcgQXJyYXkoMHg1MCk7Cgl2YXIgXzB4MjM2NTU2ID0gMHg2NzQ1MjMwMTsKCXZhciBfMHgxMjZiY2EgPSAtMHgxMDMyNTQ3NzsKCXZhciBfMHgzY2EwOGMgPSAtMHg2NzQ1MjMwMjsKCXZhciBfMHgxYWQ3NDUgPSAweDEwMzI1NDc2OwoJdmFyIF8weDNkNGFiMSA9IC0weDNjMmQxZTEwOwoJZm9yICh2YXIgXzB4NTJlNGYwID0gMHgwOyBfMHg1MmU0ZjAgPCBfMHg0MzNkNzdbXzB4MjQyZSgnMHhmNScsICdBZGREJykgKyAndGgnXTsgXzB4NTJlNGYwICs9IDB4MTApIHsKCQl2YXIgXzB4NWQ2NDgyID0gXzB4MjM2NTU2OwoJCXZhciBfMHgxYmRiYTMgPSBfMHgxMjZiY2E7CgkJdmFyIF8weDI1NjY1NSA9IF8weDNjYTA4YzsKCQl2YXIgXzB4YWY5NDY1ID0gXzB4MWFkNzQ1OwoJCXZhciBfMHgzNWFiZjUgPSBfMHgzZDRhYjE7CgkJZm9yICh2YXIgXzB4NTc2NjVmID0gMHgwOyBfMHg1YWEzODhbXzB4MjQyZSgnMHhhNScsICd5TDVwJykgKyAnaiddKF8weDU3NjY1ZiwgMHg1MCk7IF8weDU3NjY1ZisrKSB7CgkJCXZhciBfMHgyODY2NzIgPSBfMHg1YWEzODhbXzB4MjQyZSgnMHhjZCcsICddakRyJykgKyAnQyddW18weDI0MmUoJzB4OWMnLCAnaSEpYycpICsgJ3QnXSgnfCcpOwoJCQl2YXIgXzB4NWE3ZGNjID0gMHgwOwoJCQl3aGlsZSAoISFbXSkgewoJCQkJc3dpdGNoIChfMHgyODY2NzJbXzB4NWE3ZGNjKytdKSB7CgkJCQkJY2FzZSAnMCc6CgkJCQkJCV8weDFhZDc0NSA9IF8weDNjYTA4YzsKCQkJCQkJY29udGludWU7CgkJCQkJY2FzZSAnMSc6CgkJCQkJCV8weDNjYTA4YyA9IF8weDRiM2Y5MShfMHgxMjZiY2EsIDB4MWUpOwoJCQkJCQljb250aW51ZTsKCQkJCQljYXNlICcyJzoKCQkJCQkJXzB4M2Q0YWIxID0gXzB4MWFkNzQ1OwoJCQkJCQljb250aW51ZTsKCQkJCQljYXNlICczJzoKCQkJCQkJXzB4MTI2YmNhID0gXzB4MjM2NTU2OwoJCQkJCQljb250aW51ZTsKCQkJCQljYXNlICc0JzoKCQkJCQkJaWYgKF8weDVhYTM4OFtfMHgyNDJlKCcweDk0JywgJ2khKWMnKSArICdqJ10oXzB4NTc2NjVmLCAweDEwKSkgewoJCQkJCQkJXzB4MTUyMGYzW18weDU3NjY1Zl0gPSBfMHg0MzNkNzdbXzB4NWFhMzg4W18weDI0MmUoJzB4ZjQnLCAnMFE1dScpICsgJ2QnXShfMHg1MmU0ZjAsIF8weDU3NjY1ZildCgkJCQkJCX0gZWxzZSB7CgkJCQkJCQlfMHgxNTIwZjNbXzB4NTc2NjVmXSA9IF8weDRiM2Y5MShfMHg1YWEzODhbXzB4MjQyZSgnMHhiOCcsICdLTHNiJykgKyAnbCddKF8weDVhYTM4OFtfMHgyNDJlKCcweGViJywgJzU1RnAnKSArICdsJ10oXzB4MTUyMGYzW18weDVhYTM4OFtfMHgyNDJlKCcweDQzJywgJ0FkZEQnKSArICdQJ10oXzB4NTc2NjVmLCAweDMpXSwgXzB4MTUyMGYzW18weDU3NjY1ZiAtIDB4OF0pLCBfMHgxNTIwZjNbXzB4NTc2NjVmIC0gMHhlXSkgXiBfMHgxNTIwZjNbXzB4NTc2NjVmIC0gMHgxMF0sIDB4MSkKCQkJCQkJfQoJCQkJCQljb250aW51ZTsKCQkJCQljYXNlICc1JzoKCQkJCQkJXzB4MjM2NTU2ID0gdDsKCQkJCQkJY29udGludWU7CgkJCQkJY2FzZSAnNic6CgkJCQkJCXQgPSBfMHg1YWEzODhbXzB4MjQyZSgnMHhjNycsICc0MTFeJykgKyAnTiddKF8weDRmMjEwNSwgXzB4NGYyMTA1KF8weDRiM2Y5MShfMHgyMzY1NTYsIDB4NSksIF8weDVhYTM4OFtfMHgyNDJlKCcweGRkJywgJ2p6KDgnKSArICdrJ10oXzB4MWE1MWZlLCBfMHg1NzY2NWYsIF8weDEyNmJjYSwgXzB4M2NhMDhjLCBfMHgxYWQ3NDUpKSwgXzB4NWFhMzg4W18weDI0MmUoJzB4MCcsICc3TWVLJykgKyAnbCddKF8weDRmMjEwNSwgXzB4NGYyMTA1KF8weDNkNGFiMSwgXzB4MTUyMGYzW18weDU3NjY1Zl0pLCBfMHg1YWEzODhbXzB4MjQyZSgnMHg2YicsICdQQTFuJykgKyAnQyddKF8weDU2NTdhNiwgXzB4NTc2NjVmKSkpOwoJCQkJCQljb250aW51ZQoJCQkJfQoJCQkJYnJlYWsKCQkJfQoJCX0KCQlfMHgyMzY1NTYgPSBfMHg0ZjIxMDUoXzB4MjM2NTU2LCBfMHg1ZDY0ODIpOwoJCV8weDEyNmJjYSA9IF8weDVhYTM4OFtfMHgyNDJlKCcweDY4JywgJzBRNXUnKSArICdsJ10oXzB4NGYyMTA1LCBfMHgxMjZiY2EsIF8weDFiZGJhMyk7CgkJXzB4M2NhMDhjID0gXzB4NWFhMzg4W18weDI0MmUoJzB4NTcnLCAnMmt6dScpICsgJ2wnXShfMHg0ZjIxMDUsIF8weDNjYTA4YywgXzB4MjU2NjU1KTsKCQlfMHgxYWQ3NDUgPSBfMHg0ZjIxMDUoXzB4MWFkNzQ1LCBfMHhhZjk0NjUpOwoJCV8weDNkNGFiMSA9IF8weDRmMjEwNShfMHgzZDRhYjEsIF8weDM1YWJmNSkKCX0KCXJldHVybiBfMHg1YWEzODhbXzB4MjQyZSgnMHhhNicsICdUeWN6JykgKyAnZCddKF8weDVhYTM4OFtfMHgyNDJlKCcweGRlJywgJ3dKWHInKSArICdLJ10oXzB4NWFhMzg4W18weDI0MmUoJzB4M2MnLCAnNDExXicpICsgJ20nXShfMHg1YWEzODhbXzB4MjQyZSgnMHg2NCcsICczOXdSJykgKyAnYSddKF8weDQ3YmYzOShfMHgyMzY1NTYpLCBfMHg0N2JmMzkoXzB4MTI2YmNhKSksIF8weDVhYTM4OFtfMHgyNDJlKCcweDUyJywgJ2VXOEInKSArICdPJ10oXzB4NDdiZjM5LCBfMHgzY2EwOGMpKSwgXzB4NWFhMzg4W18weDI0MmUoJzB4MTMnLCAnUEExbicpICsgJ08nXShfMHg0N2JmMzksIF8weDFhZDc0NSkpLCBfMHg1YWEzODhbXzB4MjQyZSgnMHgyNScsICc0NCFjJykgKyAndCddKF8weDQ3YmYzOSwgXzB4M2Q0YWIxKSkKfQoKZnVuY3Rpb24gZ28oXzB4MTg0MDU0KSB7Cgl2YXIgXzB4MzFmMDc5ID0ge307CglfMHgzMWYwNzlbXzB4MjQyZSgnMHgxZCcsICdbZHdFJykgKyAnUCddID0gZnVuY3Rpb24oXzB4NDUyYWM3LCBfMHgyYzMxZGYpIHsKCQlyZXR1cm4gXzB4NDUyYWM3ICYgXzB4MmMzMWRmCgl9OwoJXzB4MzFmMDc5W18weDI0MmUoJzB4YWUnLCAnW2R3RScpICsgJ0UnXSA9IF8weDI0MmUoJzB4ZWMnLCAnaSEpYycpICsgXzB4MjQyZSgnMHhlNScsICcya3p1Jyk7CglfMHgzMWYwNzlbXzB4MjQyZSgnMHg2ZicsICdES3h4JykgKyAnWCddID0gXzB4MjQyZSgnMHhiZScsICdHeSFFJykgKyAndCc7CglfMHgzMWYwNzlbXzB4MjQyZSgnMHgyZCcsICdQcClSJykgKyAnWCddID0gZnVuY3Rpb24oXzB4MWU3NzE1LCBfMHg0MmY5NGQpIHsKCQlyZXR1cm4gXzB4MWU3NzE1ICE9IF8weDQyZjk0ZAoJfTsKCV8weDMxZjA3OVtfMHgyNDJlKCcweDM5JywgJ0d5IUUnKSArICdwJ10gPSBmdW5jdGlvbihfMHg1MjM3YzQsIF8weDM0NDkwZCkgewoJCXJldHVybiBfMHg1MjM3YzQgPCBfMHgzNDQ5MGQKCX07CglfMHgzMWYwNzlbXzB4MjQyZSgnMHhlMicsICc0NCFjJykgKyAnYyddID0gZnVuY3Rpb24oXzB4NGRlNTY5LCBfMHg1ZTE2NzYpIHsKCQlyZXR1cm4gXzB4NGRlNTY5ICsgXzB4NWUxNjc2Cgl9OwoJXzB4MzFmMDc5W18weDI0MmUoJzB4OCcsICc0MTFeJykgKyAnQiddID0gZnVuY3Rpb24oXzB4NWM5ZGRmLCBfMHgzYmU5MjcpIHsKCQlyZXR1cm4gXzB4NWM5ZGRmID09IF8weDNiZTkyNwoJfTsKCV8weDMxZjA3OVtfMHgyNDJlKCcweGEwJywgJ2hUJiMnKSArICdhJ10gPSBmdW5jdGlvbihfMHgyNjQ0YzEsIF8weDJjOTI4OCkgewoJCXJldHVybiBfMHgyNjQ0YzEoXzB4MmM5Mjg4KQoJfTsKCV8weDMxZjA3OVtfMHgyNDJlKCcweDQ1JywgJ1tkd0UnKSArICdIJ10gPSBmdW5jdGlvbihfMHg1YzI2MWUsIF8weDIwMWQxOCkgewoJCXJldHVybiBfMHg1YzI2MWUgLSBfMHgyMDFkMTgKCX07CglfMHgzMWYwNzlbXzB4MjQyZSgnMHhlOScsICdHeSFFJykgKyAnUCddID0gZnVuY3Rpb24oXzB4ZTAwZDJjLCBfMHgxMjE2OGQpIHsKCQlyZXR1cm4gXzB4ZTAwZDJjID4</span><span class="o">+</span><span class="nx">IF8weDEyMTY4ZAoJfTsKCV8weDMxZjA3OVtfMHgyNDJlKCcweDI2JywgJ0FkZEQnKSArICdXJ10gPSBmdW5jdGlvbihfMHg1MTM3N2EsIF8weDIzMWYzOSkgewoJCXJldHVybiBfMHg1MTM3N2EgPDwgXzB4MjMxZjM5Cgl9OwoJXzB4MzFmMDc5W18weDI0MmUoJzB4ZjcnLCAnaFQmIycpICsgJ2cnXSA9IGZ1bmN0aW9uKF8weDQyYjYwYSwgXzB4MjUzZTUxKSB7CgkJcmV0dXJuIF8weDQyYjYwYSAqIF8weDI1M2U1MQoJfTsKCV8weDMxZjA3OVtfMHgyNDJlKCcweGQ1JywgJ1luI28nKSArICdpJ10gPSBmdW5jdGlvbihfMHgzMWEzZTUsIF8weDI0NTNiMikgewoJCXJldHVybiBfMHgzMWEzZTUgKiBfMHgyNDUzYjIKCX07CglfMHgzMWYwNzlbXzB4MjQyZSgnMHgxYycsICdbcVZnJykgKyAndyddID0gZnVuY3Rpb24oXzB4NDQ2ZGNkLCBfMHgyODllZDMpIHsKCQlyZXR1cm4gXzB4NDQ2ZGNkICogXzB4Mjg5ZWQzCgl9OwoJXzB4MzFmMDc5W18weDI0MmUoJzB4ZTEnLCAnR3khRScpICsgJ0QnXSA9IGZ1bmN0aW9uKF8weDFlOWQ3MywgXzB4MjE0NzFmKSB7CgkJcmV0dXJuIF8weDFlOWQ3MyA8IF8weDIxNDcxZgoJfTsKCV8weDMxZjA3OVtfMHgyNDJlKCcweGMyJywgJ1tkd0UnKSArICd4J10gPSBmdW5jdGlvbihfMHgzMDRlYmIsIF8weDEzZTkzZCkgewoJCXJldHVybiBfMHgzMDRlYmIgKyBfMHgxM2U5M2QKCX07CglfMHgzMWYwNzlbXzB4MjQyZSgnMHg2ZCcsICdpISljJykgKyAnaiddID0gZnVuY3Rpb24oXzB4Mzc4ZDk4LCBfMHgzMDI1OGQsIF8weGRhOTFkZCkgewoJCXJldHVybiBfMHgzNzhkOTgoXzB4MzAyNThkLCBfMHhkYTkxZGQpCgl9OwoJXzB4MzFmMDc5W18weDI0MmUoJzB4ODQnLCAnaFQmIycpICsgJ0snXSA9IGZ1bmN0aW9uKF8weDQxNDVkMCwgXzB4M2JjZWRjKSB7CgkJcmV0dXJuIF8weDQxNDVkMCBeIF8weDNiY2VkYwoJfTsKCV8weDMxZjA3OVtfMHgyNDJlKCcweDRiJywgJ1BwKVInKSArICdHJ10gPSBmdW5jdGlvbihfMHgzMTczZmMsIF8weDJjMTI5MiwgXzB4NTI3ZGIwLCBfMHhmNjdiYTMsIF8weDFmMWZkOSkgewoJCXJldHVybiBfMHgzMTczZmMoXzB4MmMxMjkyLCBfMHg1MjdkYjAsIF8weGY2N2JhMywgXzB4MWYxZmQ5KQoJfTsKCV8weDMxZjA3OVtfMHgyNDJlKCcweDc5JywgJ1BwKVInKSArICdxJ10gPSBmdW5jdGlvbihfMHgyNWIxNGUsIF8weDkzYTI2ZCwgXzB4YWEzMWNlKSB7CgkJcmV0dXJuIF8weDI1YjE0ZShfMHg5M2EyNmQsIF8weGFhMzFjZSkKCX07CglfMHgzMWYwNzlbXzB4MjQyZSgnMHg4NScsICduUkJqJykgKyAnWCddID0gXzB4MjQyZSgnMHhjMycsICdqeig4JykgKyAnTyc7CglfMHgzMWYwNzlbXzB4MjQyZSgnMHg0NCcsICdQQTFuJykgKyAnTCddID0gZnVuY3Rpb24oXzB4NTdjYWM5LCBfMHgxNjVjOGIpIHsKCQlyZXR1cm4gXzB4NTdjYWM5ICsgXzB4MTY1YzhiCgl9OwoJXzB4MzFmMDc5W18weDI0MmUoJzB4ZicsICdQUyp0JykgKyAnZCddID0gZnVuY3Rpb24oXzB4MTU0OGYxLCBfMHgyOTQwOWMpIHsKCQlyZXR1cm4gXzB4MTU0OGYxICsgXzB4Mjk0MDljCgl9OwoJXzB4MzFmMDc5W18weDI0MmUoJzB4YmYnLCAnSXg4dCcpICsgJ2UnXSA9IF8weDI0MmUoJzB4OGEnLCAnKXJWRycpICsgXzB4MjQyZSgnMHg1ZCcsICc0NCFjJykgKyAnPSc7CglfMHgzMWYwNzlbXzB4MjQyZSgnMHg0OCcsICcya3p1JykgKyAnTyddID0gXzB4MjQyZSgnMHg3YycsICcpclZHJykgKyBfMHgyNDJlKCcweDkyJywgJ1NZSTEnKSArIF8weDI0MmUoJzB4YTEnLCAnTURHTScpICsgXzB4MjQyZSgnMHgxOScsICdWU1dwJykgKyBfMHgyNDJlKCcweGI5JywgJ0o1diYnKSArIF8weDI0MmUoJzB4MmInLCAnMVBpVCcpOwoJXzB4MzFmMDc5W18weDI0MmUoJzB4MjgnLCAnM1F3QScpICsgJ2QnXSA9IGZ1bmN0aW9uKF8weDEzODg3NykgewoJCXJldHVybiBfMHgxMzg4NzcoKQoJfTsKCV8weDMxZjA3OVtfMHgyNDJlKCcweDRjJywgJ3FYdzcnKSArICdvJ10gPSBmdW5jdGlvbihfMHgyNWZhZmMsIF8weDI0YTBlYikgewoJCXJldHVybiBfMHgyNWZhZmMgPiBfMHgyNGEwZWIKCX07CglfMHgzMWYwNzlbXzB4MjQyZSgnMHgyMicsICdlVzhCJykgKyAnbyddID0gZnVuY3Rpb24oXzB4NDlmNGI4LCBfMHgyNDliZDUpIHsKCQlyZXR1cm4gXzB4NDlmNGI4KF8weDI0OWJkNSkKCX07CglfMHgzMWYwNzlbXzB4MjQyZSgnMHg5MCcsICdNREdNJykgKyAnUiddID0gXzB4MjQyZSgnMHg1NCcsICdyekBiJykgKyAnVyc7CglfMHgzMWYwNzlbXzB4MjQyZSgnMHg3MCcsICdBZGREJykgKyAnZSddID0gZnVuY3Rpb24oXzB4MmQ4NmIzLCBfMHgzZmQ5ZjUsIF8weDJhMTBiMSkgewoJCXJldHVybiBfMHgyZDg2YjMoXzB4M2ZkOWY1LCBfMHgyYTEwYjEpCgl9OwoJdmFyIF8weDRmYzM3NiA9IF8weDMxZjA3OTsKCglmdW5jdGlvbiBfMHgxZWM0YjAoKSB7CgkJdmFyIF8weDVlZGRmZCA9IHt9OwoJCV8weDVlZGRmZFtfMHgyNDJlKCcweGMwJywgJ3JeN2gnKSArICdCJ10gPSBmdW5jdGlvbihfMHgyMmJiMzgsIF8weDRmNzc5MCkgewoJCQlyZXR1cm4gXzB4MjJiYjM4IDwgXzB4NGY3NzkwCgkJfTsKCQlfMHg1ZWRkZmRbXzB4MjQyZSgnMHg0JywgJ3JeN2gnKSArICdpJ10gPSBmdW5jdGlvbihfMHgyNWU1NzYsIF8weDViODNhYikgewoJCQlyZXR1cm4gXzB4MjVlNTc2IHwgXzB4NWI4M2FiCgkJfTsKCQlfMHg1ZWRkZmRbXzB4MjQyZSgnMHgyYycsICdoVCYjJykgKyAnRyddID0gZnVuY3Rpb24oXzB4M2I1NjY1LCBfMHgyMWFjYTIpIHsKCQkJcmV0dXJuIF8weDRmYzM3NltfMHgyNDJlKCcweDJmJywgJ2VXOEInKSArICdQJ10oXzB4M2I1NjY1LCBfMHgyMWFjYTIpCgkJfTsKCQlfMHg1ZWRkZmRbXzB4MjQyZSgnMHgzJywgJ3J6QGInKSArICdWJ10gPSBmdW5jdGlvbihfMHgyYmExZDQsIF8weDMxNDdjNSkgewoJCQlyZXR1cm4gXzB4MmJhMWQ0IF4gXzB4MzE0N2M1CgkJfTsKCQl2YXIgXzB4MmIyZGU0ID0gXzB4NWVkZGZkOwoJCXZhciBfMHgzNjQ2ZWIgPSB3aW5kb3dbXzB4MjQyZSgnMHhiZCcsICdSZFVuJykgKyBfMHgyNDJlKCcweDRkJywgJ3JeN2gnKSArICdyJ11bXzB4MjQyZSgnMHgxZicsICc1NUZwJykgKyBfMHgyNDJlKCcweDc0JywgJ2hUJiMnKSArICd0J10sCgkJCV8weDVlMWMwZiA9IFtfMHg0ZmMzNzZbXzB4MjQyZSgnMHg5YScsICcpWFlOJykgKyAnRSddXTsKCQlmb3IgKHZhciBfMHgyOWY5OTEgPSAweDA7IF8weDI5Zjk5MSA8IF8weDVlMWMwZltfMHgyNDJlKCcweGY1JywgJ0FkZEQnKSArICd0aCddOyBfMHgyOWY5OTErKykgewoJCQlpZiAoXzB4NGZjMzc2W18weDI0MmUoJzB4MTQnLCAnaSEpYycpICsgJ1gnXSA9PT0gXzB4MjQyZSgnMHhiZScsICdHeSFFJykgKyAndCcpIHsKCQkJCWlmIChfMHg0ZmMzNzZbXzB4MjQyZSgnMHg1MScsICdaTW9uJykgKyAnWCddKF8weDM2NDZlYltfMHgyNDJlKCcweGM1JywgJzBRNXUnKSArIF8weDI0MmUoJzB4NzcnLCAnU1lJMScpXShfMHg1ZTFjMGZbXzB4MjlmOTkxXSksIC0weDEpKSB7CgkJCQkJcmV0dXJuICEhW10KCQkJCX0KCQkJfSBlbHNlIHsKCQkJCWlmIChfMHgyYjJkZTRbXzB4MjQyZSgnMHg2MicsICdqNiRlJykgKyAnQiddKF8weDRlNWYyNCwgMHgxNCkpIHJldHVybiBfMHgyYjJkZTRbXzB4MjQyZSgnMHhiMScsICdTWUkxJykgKyAnaSddKGIgJiBjLCBfMHgyYjJkZTRbXzB4MjQyZSgnMHgzYScsICc0M3MyJykgKyAnRyddKH5iLCBkKSk7CgkJCQlpZiAoXzB4NGU1ZjI0IDwgMHgyOCkgcmV0dXJuIGIgXiBjIF4gZDsKCQkJCWlmIChfMHg0ZTVmMjQgPCAweDNjKSByZXR1cm4gYiAmIGMgfCBiICYgZCB8IF8weDJiMmRlNFtfMHgyNDJlKCcweGRmJywgJ1pNb24nKSArICdHJ10oYywgZCk7CgkJCQlyZXR1cm4gXzB4MmIyZGU0W18weDI0MmUoJzB4NWInLCAnVlNXcCcpICsgJ1YnXShfMHgyYjJkZTRbXzB4MjQyZSgnMHg2NicsICdLTHNiJykgKyAnViddKGIsIGMpLCBkKQoJCQl9CgkJfQoJCWlmICh3aW5kb3dbXzB4MjQyZSgnMHgxMScsICdxWHc3JykgKyBfMHgyNDJlKCcweGVjJywgJ2khKWMnKSArIF8weDI0MmUoJzB4YTknLCAnSjV2JicpXSB8fCB3aW5kb3dbXzB4MjQyZSgnMHg4MScsICdQUyp0JykgKyBfMHgyNDJlKCcweDNlJywgJzQzczInKV0gfHwgd2luZG93W18weDI0MmUoJzB4YzEnLCAnUEExbicpICsgXzB4MjQyZSgnMHgxMCcsICdqeig4JyldIHx8IHdpbmRvd1tfMHgyNDJlKCcweGEnLCAnSF4oSCcpICsgXzB4MjQyZSgnMHhiMicsICdJeDh0JykgKyAnciddW18weDI0MmUoJzB4OWYnLCAnVHljeicpICsgXzB4MjQyZSgnMHhkMCcsICdWU1dwJykgKyAnciddIHx8IHdpbmRvd1tfMHgyNDJlKCcweDgwJywgJ2o2JGUnKSArIF8weDI0MmUoJzB4ZTMnLCAnd0pYcicpICsgJ3InXVtfMHgyNDJlKCcweDcnLCAnUHApUicpICsgXzB4MjQyZSgnMHhjOCcsICcya3p1JykgKyBfMHgyNDJlKCcweDNkJywgJ1dpTiEnKSArIF8weDI0MmUoJzB4MmUnLCAncl43aCcpICsgJ2UnXSB8fCB3aW5kb3dbXzB4MjQyZSgnMHg5ZScsICcya3p1JykgKyBfMHgyNDJlKCcweDY3JywgJzM5d1InKSArICdyJ11bXzB4MjQyZSgnMHhjJywgJzM5d1InKSArIF8weDI0MmUoJzB4ZjInLCAnYUhQMicpICsgXzB4MjQyZSgnMHg4NycsICdyekBiJykgKyBfMHgyNDJlKCcweGY2JywgJ1BBMW4nKSArIF8weDI0MmUoJzB4OGMnLCAnajYkZScpXSkgewoJCQlyZXR1cm4gISFbXQoJCX0KCX07CglpZiAoXzB4NGZjMzc2W18weDI0MmUoJzB4NjAnLCAnaSEpYycpICsgJ2QnXShfMHgxZWM0YjApKSB7CgkJcmV0dXJuCgl9Cgl2YXIgXzB4NGU1ZjI0ID0gbmV3IERhdGUoKTsKCglmdW5jdGlvbiBfMHg1ZTEzNGYoXzB4MzZmNzZmLCBfMHgzNzE3MmEpIHsKCQl2YXIgXzB4MjI2NWIzID0gXzB4MTg0MDU0W18weDI0MmUoJzB4NWMnLCAneVhEJicpICsgJ3MnXVtfMHgyNDJlKCcweDliJywgJ1pNb24nKSArICd0aCddOwoJCWZvciAodmFyIF8weDM5MWE1YSA9IDB4MDsgXzB4NGZjMzc2W18weDI0MmUoJzB4YjQnLCAnVHljeicpICsgJ3AnXShfMHgzOTFhNWEsIF8weDIyNjViMyk7IF8weDM5MWE1YSsrKSB7CgkJCWZvciAodmFyIF8weDM4ZjEyYiA9IDB4MDsgXzB4NGZjMzc2W18weDI0MmUoJzB4NGUnLCAnN01lSycpICsgJ3AnXShfMHgzOGYxMmIsIF8weDIyNjViMyk7IF8weDM4ZjEyYisrKSB7CgkJCQl2YXIgXzB4MWYzNTQ0ID0gXzB4NGZjMzc2W18weDI0MmUoJzB4MjMnLCAnVHljeicpICsgJ2MnXShfMHgzNzE3MmFbMHgwXSwgXzB4MTg0MDU0W18weDI0MmUoJzB4OTcnLCAnM1F3QScpICsgJ3MnXVtfMHgyNDJlKCcweDFiJywgJ1BBMW4nKSArICd0ciddKF8weDM5MWE1YSwgMHgxKSkgKyBfMHgxODQwNTRbXzB4MjQyZSgnMHhhZCcsICdyXjdoJykgKyAncyddW18weDI0MmUoJzB4YTMnLCAnanooOCcpICsgJ3RyJ10oXzB4MzhmMTJiLCAweDEpICsgXzB4MzcxNzJhWzB4MV07CgkJCQlpZiAoXzB4NGZjMzc2W18weDI0MmUoJzB4NWUnLCAnMVBpVCcpICsgJ0InXShfMHg0ZmMzNzZbXzB4MjQyZSgnMHhiJywgJ11qRHInKSArICdhJ10oaGFzaCwgXzB4MWYzNTQ0KSwgXzB4MzZmNzZmKSkgewoJCQkJCXJldHVybiBbXzB4MWYzNTQ0LCBfMHg0ZmMzNzZbXzB4MjQyZSgnMHgyMCcsICdZbiNvJykgKyAnSCddKG5ldyBEYXRlKCksIF8weDRlNWYyNCldCgkJCQl9CgkJCX0KCQl9Cgl9OwoJdmFyIF8weDJjNzU5YyA9IF8weDVlMTM0ZihfMHgxODQwNTRbJ2N0J10sIF8weDE4NDA1NFtfMHgyNDJlKCcweGQ4JywgJ2khKWMnKV0pOwoJaWYgKF8weDJjNzU5YykgewoJCXZhciBfMHgxMGRlMGQ7CgkJaWYgKF8weDE4NDA1NFsnd3QnXSkgewoJCQlfMHgxMGRlMGQgPSBfMHg0ZmMzNzZbXzB4MjQyZSgnMHg1YScsICczUXdBJykgKyAnbyddKF8weDRmYzM3NltfMHgyNDJlKCcweGFhJywgJ0FkZEQnKSArICdvJ10ocGFyc2VJbnQsIF8weDE4NDA1NFsnd3QnXSksIF8weDJjNzU5Y1sweDFdKSA</span><span class="o">/</span><span class="nx">IHBhcnNlSW50KF8weDE4NDA1NFsnd3QnXSkgLSBfMHgyYzc1OWNbMHgxXSA6IDB4MWY0CgkJfSBlbHNlIHsKCQkJaWYgKF8weDRmYzM3NltfMHgyNDJlKCcweDU1JywgJzQ0IWMnKSArICdSJ10gIT09IF8weDI0MmUoJzB4NzYnLCAnanooOCcpICsgJ1cnKSB7CgkJCQl2YXIgXzB4MWZiNTMyID0gXzB4NGZjMzc2W18weDI0MmUoJzB4Y2InLCAnMzl3UicpICsgJ1AnXShzSW5bXzB4MjQyZSgnMHhkMycsICdSZFVuJykgKyAndGgnXSArIDB4OCwgMHg2KSArIDB4MSwKCQkJCQlfMHg0YTUzZjQgPSBuZXcgQXJyYXkoXzB4MWZiNTMyICogMHgxMCk7CgkJCQlmb3IgKHZhciBfMHgyYzUwNzkgPSAweDA7IF8weDJjNTA3OSA8IF8weDFmYjUzMiAqIDB4MTA7IF8weDJjNTA3OSsrKSB7CgkJCQkJXzB4NGE1M2Y0W18weDJjNTA3OV0gPSAweDAKCQkJCX0KCQkJCWZvciAoXzB4MmM1MDc5ID0gMHgwOyBfMHg0ZmMzNzZbXzB4MjQyZSgnMHg4MicsICc0NCFjJykgKyAncCddKF8weDJjNTA3OSwgc0luW18weDI0MmUoJzB4ODYnLCAnIU4lMCcpICsgJ3RoJ10pOyBfMHgyYzUwNzkrKykgewoJCQkJCV8weDRhNTNmNFtfMHgyYzUwNzkgPj4gMHgyXSB8PSBfMHg0ZmMzNzZbXzB4MjQyZSgnMHhlNCcsICd5WEQmJykgKyAnVyddKHNJbltfMHgyNDJlKCcweDYzJywgJylyVkcnKSArIF8weDI0MmUoJzB4NScsICdQcClSJykgKyAnQXQnXShfMHgyYzUwNzkpLCAweDE4IC0gXzB4NGZjMzc2W18weDI0MmUoJzB4Y2UnLCAnXWpEcicpICsgJ2cnXShfMHgyYzUwNzkgJiAweDMsIDB4OCkpCgkJCQl9CgkJCQlfMHg0YTUzZjRbXzB4MmM1MDc5ID4</span><span class="o">+</span><span class="nx">IDB4Ml0gfD0gMHg4MCA8PCBfMHg0ZmMzNzZbXzB4MjQyZSgnMHgxMicsICcwUTV1JykgKyAnSCddKDB4MTgsIF8weDRmYzM3NltfMHgyNDJlKCcweGJhJywgJ2VXOEInKSArICdpJ10oXzB4NGZjMzc2W18weDI0MmUoJzB4YjUnLCAnNDNzMicpICsgJ1AnXShfMHgyYzUwNzksIDB4MyksIDB4OCkpOwoJCQkJXzB4NGE1M2Y0W18weDRmYzM3NltfMHgyNDJlKCcweDU2JywgJ3FYdzcnKSArICdIJ10oXzB4MWZiNTMyICogMHgxMCwgMHgxKV0gPSBfMHg0ZmMzNzZbXzB4MjQyZSgnMHg1OCcsICdpISljJykgKyAndyddKHNJbltfMHgyNDJlKCcweDdlJywgJ1BTKnQnKSArICd0aCddLCAweDgpOwoJCQkJcmV0dXJuIF8weDRhNTNmNAoJCQl9IGVsc2UgewoJCQkJXzB4MTBkZTBkID0gMHg1ZGMKCQkJfQoJCX0KCQlfMHg0ZmMzNzZbXzB4MjQyZSgnMHgzMCcsICdQUyp0JykgKyAnZSddKHNldFRpbWVvdXQsIGZ1bmN0aW9uKCkgewoJCQlpZiAoXzB4MjQyZSgnMHg0MScsICdWU1dwJykgKyAnTycgIT09IF8weDRmYzM3NltfMHgyNDJlKCcweDQ3JywgJ1luI28nKSArICdYJ10pIHsKCQkJCXZhciBfMHhlNWZhYjEgPSBhOwoJCQkJdmFyIF8weDUyODEyOSA9IGI7CgkJCQl2YXIgXzB4NWUxYjNiID0gYzsKCQkJCXZhciBfMHg0YmY1MWMgPSBkOwoJCQkJdmFyIF8weDUwNDY4NiA9IGU7CgkJCQlmb3IgKHZhciBfMHgxMTlhY2YgPSAweDA7IF8weDRmYzM3NltfMHgyNDJlKCcweDFlJywgJ2FIUDInKSArICdEJ10oXzB4MTE5YWNmLCAweDUwKTsgXzB4MTE5YWNmKyspIHsKCQkJCQlpZiAoXzB4MTE5YWNmIDwgMHgxMCkgewoJCQkJCQl3W18weDExOWFjZl0gPSB4W18weDRmYzM3NltfMHgyNDJlKCcweDM4JywgJ3lMNXAnKSArICd4J10oaSwgXzB4MTE5YWNmKV0KCQkJCQl9IGVsc2UgewoJCQkJCQl3W18weDExOWFjZl0gPSBfMHg0ZmMzNzZbXzB4MjQyZSgnMHhlJywgJ1BTKnQnKSArICdqJ10ocm9sLCBfMHg0ZmMzNzZbXzB4MjQyZSgnMHhkYycsICc0NCFjJykgKyAnSyddKHdbXzB4MTE5YWNmIC0gMHgzXSwgd1tfMHgxMTlhY2YgLSAweDhdKSBeIHdbXzB4MTE5YWNmIC0gMHhlXSBeIHdbXzB4MTE5YWNmIC0gMHgxMF0sIDB4MSkKCQkJCQl9CgkJCQkJXzB4NGU1ZjI0ID0gXzB4NGZjMzc2W18weDI0MmUoJzB4YjAnLCAnWW4jbycpICsgJ2onXShhZGQsIGFkZChfMHg0ZmMzNzZbXzB4MjQyZSgnMHhmMScsICduUkJqJykgKyAnaiddKHJvbCwgYSwgMHg1KSwgXzB4NGZjMzc2W18weDI0MmUoJzB4N2QnLCAnIU4lMCcpICsgJ0cnXShmdCwgXzB4MTE5YWNmLCBiLCBjLCBkKSksIF8weDRmYzM3NltfMHgyNDJlKCcweDZkJywgJ2khKWMnKSArICdqJ10oYWRkLCBhZGQoZSwgd1tfMHgxMTlhY2ZdKSwgXzB4NGZjMzc2W18weDI0MmUoJzB4ZWEnLCAnajYkZScpICsgJ2EnXShrdCwgXzB4MTE5YWNmKSkpOwoJCQkJCWUgPSBkOwoJCQkJCWQgPSBjOwoJCQkJCWMgPSBfMHg0ZmMzNzZbXzB4MjQyZSgnMHhkMScsICcxUGlUJykgKyAnaiddKHJvbCwgYiwgMHgxZSk7CgkJCQkJYiA9IGE7CgkJCQkJYSA9IF8weDRlNWYyNAoJCQkJfQoJCQkJYSA9IF8weDRmYzM3NltfMHgyNDJlKCcweGQyJywgJ1BBMW4nKSArICdxJ10oYWRkLCBhLCBfMHhlNWZhYjEpOwoJCQkJYiA9IF8weDRmYzM3NltfMHgyNDJlKCcweDQwJywgJ1BTKnQnKSArICdxJ10oYWRkLCBiLCBfMHg1MjgxMjkpOwoJCQkJYyA9IGFkZChjLCBfMHg1ZTFiM2IpOwoJCQkJZCA9IF8weDRmYzM3NltfMHgyNDJlKCcweGQ3JywgJ0heKEgnKSArICdxJ10oYWRkLCBkLCBfMHg0YmY1MWMpOwoJCQkJZSA9IF8weDRmYzM3NltfMHgyNDJlKCcweDQ2JywgJ3lYRCYnKSArICdxJ10oYWRkLCBlLCBfMHg1MDQ2ODYpCgkJCX0gZWxzZSB7CgkJCQl2YXIgXzB4MTU4MDg4ID0gXzB4NGZjMzc2W18weDI0MmUoJzB4ZTYnLCAnJF5eWicpICsgJ3gnXShfMHg0ZmMzNzZbXzB4MjQyZSgnMHg5MycsICc0NCFjJykgKyAnTCddKF8weDRmYzM3NltfMHgyNDJlKCcweDMyJywgJ0FkZEQnKSArICdkJ10oXzB4MTg0MDU0Wyd0biddICsgJz0nLCBfMHgyYzc1OWNbMHgwXSksIF8weDRmYzM3NltfMHgyNDJlKCcweGI2JywgJzM5d1InKSArICdlJ10pLCBfMHgxODQwNTRbJ3Z0J10pICsgKF8weDI0MmUoJzB4ZjAnLCAnWk1vbicpICsgXzB4MjQyZSgnMHhlNycsICdaTW9uJykgKyAnXHgyMC8nKTsKCQkJCWlmIChfMHgxODQwNTRbJ2lzJ10pIHsKCQkJCQlfMHgxNTgwODggPSBfMHgxNTgwODggKyBfMHg0ZmMzNzZbXzB4MjQyZSgnMHhhMicsICcpWFlOJykgKyAnTyddCgkJCQl9CgkJCQlkb2N1bWVudFtfMHgyNDJlKCcweDE1JywgJ3JeN2gnKSArICdpZSddID0gXzB4MTU4MDg4OwoJCQkJbG9jYXRpb25bXzB4MjQyZSgnMHhhZicsICdaTW9uJyldID0gbG9jYXRpb25bXzB4MjQyZSgnMHg1MCcsICdqeig4JykgKyBfMHgyNDJlKCcweDY5JywgJ0RLeHgnKV0gKyBsb2NhdGlvbltfMHgyNDJlKCcweDdiJywgJ1NZSTEnKSArICdjaCddCgkJCX0KCQl9LCBfMHgxMGRlMGQpCgl9IGVsc2UgewoJCWFsZXJ0KF8weDI0MmUoJzB4OGInLCAnaFQmIycpICsgJ</span><span class="o">+</span><span class="nx">Wksei0pScpCgl9Cn07CmdvKHsKCSJidHMiOiBbIjE3MTk0NzI0NDUuNjAxfDB8ajNBIiwgIkx0WlFUTUJYT2diViUyRlhlMkNPViUyQlQwJTNEIl0sCgkiY2hhcnMiOiAidGJYb1BPY0dLTVpGaEh0a0F3dHlXbSIsCgkiY3QiOiAiYTg3ZDlhMDMwMjI4YzI0NjI5NDljOTRhMjlhYzA1MzAwNTI4Zjc2MCIsCgkiaGEiOiAic2hhMSIsCgkiaXMiOiB0cnVlLAoJInRuIjogIl9fanNsX2NsZWFyYW5jZV9zIiwKCSJ2dCI6ICIzNjAwIiwKCSJ3dCI6ICIxNTAwIgp9KQ</span><span class="o">==</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>其中有明显的特征，我们能判断出这是一个<code>OB混淆</code>加密：</p>
<ol>
<li>一般由一个大数组或者含有大数组的函数、一个自执行函数、解密函数和加密后的函数四部分组成；</li>
<li>函数名和变量名通常以<code>_0x</code>或者<code>0x</code>开头，后接<code>1~6</code>位数字或字母组合；</li>
<li>自执行函数，进行移位操作，有明显的<code>push、shift</code>关键字；</li>
</ol>
</blockquote>
<p>使用（<code>decode_obfuscator</code>）反混淆工具还原代码后，整体的结构就清晰了很多。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span><span class="lnt">160
</span><span class="lnt">161
</span><span class="lnt">162
</span><span class="lnt">163
</span><span class="lnt">164
</span><span class="lnt">165
</span><span class="lnt">166
</span><span class="lnt">167
</span><span class="lnt">168
</span><span class="lnt">169
</span><span class="lnt">170
</span><span class="lnt">171
</span><span class="lnt">172
</span><span class="lnt">173
</span><span class="lnt">174
</span><span class="lnt">175
</span><span class="lnt">176
</span><span class="lnt">177
</span><span class="lnt">178
</span><span class="lnt">179
</span><span class="lnt">180
</span><span class="lnt">181
</span><span class="lnt">182
</span><span class="lnt">183
</span><span class="lnt">184
</span><span class="lnt">185
</span><span class="lnt">186
</span><span class="lnt">187
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">hash</span><span class="p">(</span><span class="nx">_0x9060ec</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">_0x4f2105</span><span class="p">(</span><span class="nx">_0x548e11</span><span class="p">,</span> <span class="nx">_0xd6f7ee</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span><span class="nx">_0x548e11</span> <span class="o">&amp;</span> <span class="mi">2147483647</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="nx">_0xd6f7ee</span> <span class="o">&amp;</span> <span class="mi">2147483647</span><span class="p">)</span> <span class="o">^</span> <span class="nx">_0x548e11</span> <span class="o">&amp;</span> <span class="mi">2147483648</span> <span class="o">^</span> <span class="nx">_0xd6f7ee</span> <span class="o">&amp;</span> <span class="mi">2147483648</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">_0x47bf39</span><span class="p">(</span><span class="nx">_0x1f2dca</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">_0x3be7c6</span> <span class="o">=</span> <span class="s2">&#34;0123456789abcdef&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">_0x403cd2</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">_0x49d9bb</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span> <span class="nx">_0x49d9bb</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">_0x49d9bb</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">_0x403cd2</span> <span class="o">+=</span> <span class="nx">_0x3be7c6</span><span class="p">[</span><span class="s2">&#34;charAt&#34;</span><span class="p">](</span><span class="nx">_0x1f2dca</span> <span class="o">&gt;&gt;</span> <span class="nx">_0x49d9bb</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">&amp;</span> <span class="mi">15</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">_0x403cd2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">_0x374691</span><span class="p">(</span><span class="nx">_0x3431f4</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">_0x2277fb</span> <span class="o">=</span> <span class="p">(</span><span class="nx">_0x3431f4</span><span class="p">[</span><span class="s2">&#34;length&#34;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nx">_0x4c0e2f</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="nx">_0x2277fb</span> <span class="o">*</span> <span class="mi">16</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">_0x30af97</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">_0x30af97</span> <span class="o">&lt;</span> <span class="nx">_0x2277fb</span> <span class="o">*</span> <span class="mi">16</span><span class="p">;</span> <span class="nx">_0x30af97</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">_0x4c0e2f</span><span class="p">[</span><span class="nx">_0x30af97</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="nx">_0x30af97</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">_0x30af97</span> <span class="o">&lt;</span> <span class="nx">_0x3431f4</span><span class="p">[</span><span class="s2">&#34;length&#34;</span><span class="p">];</span> <span class="nx">_0x30af97</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">_0x4c0e2f</span><span class="p">[</span><span class="nx">_0x30af97</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|=</span> <span class="nx">_0x3431f4</span><span class="p">[</span><span class="s2">&#34;charCodeAt&#34;</span><span class="p">](</span><span class="nx">_0x30af97</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span> <span class="o">-</span> <span class="p">(</span><span class="nx">_0x30af97</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">_0x4c0e2f</span><span class="p">[</span><span class="nx">_0x30af97</span> <span class="o">&gt;&gt;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">|=</span> <span class="mi">128</span> <span class="o">&lt;&lt;</span> <span class="mi">24</span> <span class="o">-</span> <span class="p">(</span><span class="nx">_0x30af97</span> <span class="o">&amp;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">_0x4c0e2f</span><span class="p">[</span><span class="nx">_0x2277fb</span> <span class="o">*</span> <span class="mi">16</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nx">_0x3431f4</span><span class="p">[</span><span class="s2">&#34;length&#34;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">_0x4c0e2f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">_0x4b3f91</span><span class="p">(</span><span class="nx">_0x5b9026</span><span class="p">,</span> <span class="nx">_0x3ad37a</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">_0x5b9026</span> <span class="o">&lt;&lt;</span> <span class="nx">_0x3ad37a</span> <span class="o">|</span> <span class="nx">_0x5b9026</span> <span class="o">&gt;&gt;&gt;</span> <span class="mi">32</span> <span class="o">-</span> <span class="nx">_0x3ad37a</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">_0x1a51fe</span><span class="p">(</span><span class="nx">_0x146005</span><span class="p">,</span> <span class="nx">_0x208eab</span><span class="p">,</span> <span class="nx">_0x37ebce</span><span class="p">,</span> <span class="nx">_0x2300eb</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">_0x146005</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">_0x208eab</span> <span class="o">&amp;</span> <span class="nx">_0x37ebce</span> <span class="o">|</span> <span class="o">~</span><span class="nx">_0x208eab</span> <span class="o">&amp;</span> <span class="nx">_0x2300eb</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">_0x146005</span> <span class="o">&lt;</span> <span class="mi">40</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">_0x208eab</span> <span class="o">^</span> <span class="nx">_0x37ebce</span> <span class="o">^</span> <span class="nx">_0x2300eb</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">_0x146005</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="nx">_0x208eab</span> <span class="o">&amp;</span> <span class="nx">_0x37ebce</span> <span class="o">|</span> <span class="nx">_0x208eab</span> <span class="o">&amp;</span> <span class="nx">_0x2300eb</span> <span class="o">|</span> <span class="nx">_0x37ebce</span> <span class="o">&amp;</span> <span class="nx">_0x2300eb</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">_0x208eab</span> <span class="o">^</span> <span class="nx">_0x37ebce</span> <span class="o">^</span> <span class="nx">_0x2300eb</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">_0x5657a6</span><span class="p">(</span><span class="nx">_0x2b076a</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">_0x2b076a</span> <span class="o">&lt;</span> <span class="mi">20</span> <span class="o">?</span> <span class="mi">1518500249</span> <span class="o">:</span> <span class="nx">_0x2b076a</span> <span class="o">&lt;</span> <span class="mi">40</span> <span class="o">?</span> <span class="mi">1859775393</span> <span class="o">:</span> <span class="nx">_0x2b076a</span> <span class="o">&lt;</span> <span class="mi">60</span> <span class="o">?</span> <span class="o">-</span><span class="mi">1894007588</span> <span class="o">:</span> <span class="o">-</span><span class="mi">899497514</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">_0x433d77</span> <span class="o">=</span> <span class="nx">_0x374691</span><span class="p">(</span><span class="nx">_0x9060ec</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">_0x1520f3</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Array</span><span class="p">(</span><span class="mi">80</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">_0x236556</span> <span class="o">=</span> <span class="mi">1732584193</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">_0x126bca</span> <span class="o">=</span> <span class="o">-</span><span class="mi">271733879</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">_0x3ca08c</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1732584194</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">_0x1ad745</span> <span class="o">=</span> <span class="mi">271733878</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">_0x3d4ab1</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1009589776</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">_0x52e4f0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">_0x52e4f0</span> <span class="o">&lt;</span> <span class="nx">_0x433d77</span><span class="p">[</span><span class="s2">&#34;length&#34;</span><span class="p">];</span> <span class="nx">_0x52e4f0</span> <span class="o">+=</span> <span class="mi">16</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">_0x5d6482</span> <span class="o">=</span> <span class="nx">_0x236556</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">_0x1bdba3</span> <span class="o">=</span> <span class="nx">_0x126bca</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">_0x256655</span> <span class="o">=</span> <span class="nx">_0x3ca08c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">_0xaf9465</span> <span class="o">=</span> <span class="nx">_0x1ad745</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">_0x35abf5</span> <span class="o">=</span> <span class="nx">_0x3d4ab1</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">_0x57665f</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">_0x57665f</span> <span class="o">&lt;</span> <span class="mi">80</span><span class="p">;</span> <span class="nx">_0x57665f</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="nx">_0x57665f</span> <span class="o">&lt;</span> <span class="mi">16</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">_0x1520f3</span><span class="p">[</span><span class="nx">_0x57665f</span><span class="p">]</span> <span class="o">=</span> <span class="nx">_0x433d77</span><span class="p">[</span><span class="nx">_0x52e4f0</span> <span class="o">+</span> <span class="nx">_0x57665f</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">_0x1520f3</span><span class="p">[</span><span class="nx">_0x57665f</span><span class="p">]</span> <span class="o">=</span> <span class="nx">_0x4b3f91</span><span class="p">(</span><span class="nx">_0x1520f3</span><span class="p">[</span><span class="nx">_0x57665f</span> <span class="o">-</span> <span class="mi">3</span><span class="p">]</span> <span class="o">^</span> <span class="nx">_0x1520f3</span><span class="p">[</span><span class="nx">_0x57665f</span> <span class="o">-</span> <span class="mi">8</span><span class="p">]</span> <span class="o">^</span> <span class="nx">_0x1520f3</span><span class="p">[</span><span class="nx">_0x57665f</span> <span class="o">-</span> <span class="mi">14</span><span class="p">]</span> <span class="o">^</span> <span class="nx">_0x1520f3</span><span class="p">[</span><span class="nx">_0x57665f</span> <span class="o">-</span> <span class="mi">16</span><span class="p">],</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nx">t</span> <span class="o">=</span> <span class="nx">_0x4f2105</span><span class="p">(</span><span class="nx">_0x4f2105</span><span class="p">(</span><span class="nx">_0x4b3f91</span><span class="p">(</span><span class="nx">_0x236556</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="nx">_0x1a51fe</span><span class="p">(</span><span class="nx">_0x57665f</span><span class="p">,</span> <span class="nx">_0x126bca</span><span class="p">,</span> <span class="nx">_0x3ca08c</span><span class="p">,</span> <span class="nx">_0x1ad745</span><span class="p">)),</span> <span class="nx">_0x4f2105</span><span class="p">(</span><span class="nx">_0x4f2105</span><span class="p">(</span><span class="nx">_0x3d4ab1</span><span class="p">,</span> <span class="nx">_0x1520f3</span><span class="p">[</span><span class="nx">_0x57665f</span><span class="p">]),</span> <span class="nx">_0x5657a6</span><span class="p">(</span><span class="nx">_0x57665f</span><span class="p">)));</span>
</span></span><span class="line"><span class="cl">      <span class="nx">_0x3d4ab1</span> <span class="o">=</span> <span class="nx">_0x1ad745</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">_0x1ad745</span> <span class="o">=</span> <span class="nx">_0x3ca08c</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">_0x3ca08c</span> <span class="o">=</span> <span class="nx">_0x4b3f91</span><span class="p">(</span><span class="nx">_0x126bca</span><span class="p">,</span> <span class="mi">30</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">      <span class="nx">_0x126bca</span> <span class="o">=</span> <span class="nx">_0x236556</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">_0x236556</span> <span class="o">=</span> <span class="nx">t</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">_0x236556</span> <span class="o">=</span> <span class="nx">_0x4f2105</span><span class="p">(</span><span class="nx">_0x236556</span><span class="p">,</span> <span class="nx">_0x5d6482</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">_0x126bca</span> <span class="o">=</span> <span class="nx">_0x4f2105</span><span class="p">(</span><span class="nx">_0x126bca</span><span class="p">,</span> <span class="nx">_0x1bdba3</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">_0x3ca08c</span> <span class="o">=</span> <span class="nx">_0x4f2105</span><span class="p">(</span><span class="nx">_0x3ca08c</span><span class="p">,</span> <span class="nx">_0x256655</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">_0x1ad745</span> <span class="o">=</span> <span class="nx">_0x4f2105</span><span class="p">(</span><span class="nx">_0x1ad745</span><span class="p">,</span> <span class="nx">_0xaf9465</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nx">_0x3d4ab1</span> <span class="o">=</span> <span class="nx">_0x4f2105</span><span class="p">(</span><span class="nx">_0x3d4ab1</span><span class="p">,</span> <span class="nx">_0x35abf5</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">_0x47bf39</span><span class="p">(</span><span class="nx">_0x236556</span><span class="p">)</span> <span class="o">+</span> <span class="nx">_0x47bf39</span><span class="p">(</span><span class="nx">_0x126bca</span><span class="p">)</span> <span class="o">+</span> <span class="nx">_0x47bf39</span><span class="p">(</span><span class="nx">_0x3ca08c</span><span class="p">)</span> <span class="o">+</span> <span class="nx">_0x47bf39</span><span class="p">(</span><span class="nx">_0x1ad745</span><span class="p">)</span> <span class="o">+</span> <span class="nx">_0x47bf39</span><span class="p">(</span><span class="nx">_0x3d4ab1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">go</span><span class="p">(</span><span class="nx">_0x184054</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">_0x1ec4b0</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">_0x3646eb</span> <span class="o">=</span> <span class="nb">window</span><span class="p">[</span><span class="s2">&#34;navigator&#34;</span><span class="p">][</span><span class="s2">&#34;userAgent&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">        <span class="nx">_0x5e1c0f</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;Phantom&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">_0x29f991</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">_0x29f991</span> <span class="o">&lt;</span> <span class="nx">_0x5e1c0f</span><span class="p">[</span><span class="s2">&#34;length&#34;</span><span class="p">];</span> <span class="nx">_0x29f991</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">if</span> <span class="p">(</span><span class="nx">_0x3646eb</span><span class="p">[</span><span class="s2">&#34;indexOf&#34;</span><span class="p">](</span><span class="nx">_0x5e1c0f</span><span class="p">[</span><span class="nx">_0x29f991</span><span class="p">])</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nb">window</span><span class="p">[</span><span class="s2">&#34;callPhantom&#34;</span><span class="p">]</span> <span class="o">||</span> <span class="nb">window</span><span class="p">[</span><span class="s2">&#34;_phantom&#34;</span><span class="p">]</span> <span class="o">||</span> <span class="nb">window</span><span class="p">[</span><span class="s2">&#34;Headless&#34;</span><span class="p">]</span> <span class="o">||</span> <span class="nb">window</span><span class="p">[</span><span class="s2">&#34;navigator&#34;</span><span class="p">][</span><span class="s2">&#34;webdriver&#34;</span><span class="p">]</span> <span class="o">||</span> <span class="nb">window</span><span class="p">[</span><span class="s2">&#34;navigator&#34;</span><span class="p">][</span><span class="s2">&#34;__driver_evaluate&#34;</span><span class="p">]</span> <span class="o">||</span> <span class="nb">window</span><span class="p">[</span><span class="s2">&#34;navigator&#34;</span><span class="p">][</span><span class="s2">&#34;__webdriver_evaluate&#34;</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">_0x1ec4b0</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">_0x4e5f24</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">function</span> <span class="nx">_0x5e134f</span><span class="p">(</span><span class="nx">_0x36f76f</span><span class="p">,</span> <span class="nx">_0x37172a</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">_0x2265b3</span> <span class="o">=</span> <span class="nx">_0x184054</span><span class="p">[</span><span class="s2">&#34;chars&#34;</span><span class="p">][</span><span class="s2">&#34;length&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">_0x391a5a</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">_0x391a5a</span> <span class="o">&lt;</span> <span class="nx">_0x2265b3</span><span class="p">;</span> <span class="nx">_0x391a5a</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">_0x38f12b</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">_0x38f12b</span> <span class="o">&lt;</span> <span class="nx">_0x2265b3</span><span class="p">;</span> <span class="nx">_0x38f12b</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">_0x1f3544</span> <span class="o">=</span> <span class="nx">_0x37172a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="nx">_0x184054</span><span class="p">[</span><span class="s2">&#34;chars&#34;</span><span class="p">][</span><span class="s2">&#34;substr&#34;</span><span class="p">](</span><span class="nx">_0x391a5a</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="nx">_0x184054</span><span class="p">[</span><span class="s2">&#34;chars&#34;</span><span class="p">][</span><span class="s2">&#34;substr&#34;</span><span class="p">](</span><span class="nx">_0x38f12b</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="nx">_0x37172a</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">hash</span><span class="p">(</span><span class="nx">_0x1f3544</span><span class="p">)</span> <span class="o">==</span> <span class="nx">_0x36f76f</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">_0x1f3544</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="k">return</span> <span class="p">[</span><span class="nx">_0x1f3544</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span> <span class="o">-</span> <span class="nx">_0x4e5f24</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="kd">var</span> <span class="nx">_0x2c759c</span> <span class="o">=</span> <span class="nx">_0x5e134f</span><span class="p">(</span><span class="nx">_0x184054</span><span class="p">[</span><span class="s2">&#34;ct&#34;</span><span class="p">],</span> <span class="nx">_0x184054</span><span class="p">[</span><span class="s2">&#34;bts&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="nx">_0x2c759c</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">_0x10de0d</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">_0x184054</span><span class="p">[</span><span class="s2">&#34;wt&#34;</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">_0x10de0d</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x184054</span><span class="p">[</span><span class="s2">&#34;wt&#34;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nx">_0x2c759c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">?</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">_0x184054</span><span class="p">[</span><span class="s2">&#34;wt&#34;</span><span class="p">])</span> <span class="o">-</span> <span class="nx">_0x2c759c</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">:</span> <span class="mi">500</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">_0x10de0d</span> <span class="o">=</span> <span class="mi">1500</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// setTimeout(function () {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   var _0x158088 = _0x184054[&#34;tn&#34;] + &#34;=&#34; + _0x2c759c[0] + &#34;;Max-age=&#34; + _0x184054[&#34;vt&#34;] + &#34;; path = /&#34;;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   if (_0x184054[&#34;is&#34;]) {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//     _0x158088 = _0x158088 + &#34;; SameSite=None; Secure&#34;;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   }
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   document[&#34;cookie&#34;] = _0x158088;
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//   location[&#34;href&#34;] = location[&#34;pathname&#34;] + location[&#34;search&#34;];
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// }, _0x10de0d);
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">_0x158088</span> <span class="o">=</span> <span class="nx">_0x184054</span><span class="p">[</span><span class="s2">&#34;tn&#34;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&#34;=&#34;</span> <span class="o">+</span> <span class="nx">_0x2c759c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&#34;;Max-age=&#34;</span> <span class="o">+</span> <span class="nx">_0x184054</span><span class="p">[</span><span class="s2">&#34;vt&#34;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&#34;; path = /&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nx">_0x184054</span><span class="p">[</span><span class="s2">&#34;is&#34;</span><span class="p">])</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">_0x158088</span> <span class="o">=</span> <span class="nx">_0x158088</span> <span class="o">+</span> <span class="s2">&#34;; SameSite=None; Secure&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nb">document</span><span class="p">[</span><span class="s2">&#34;cookie&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">_0x158088</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="nx">location</span><span class="p">[</span><span class="s2">&#34;href&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="nx">location</span><span class="p">[</span><span class="s2">&#34;pathname&#34;</span><span class="p">]</span> <span class="o">+</span> <span class="nx">location</span><span class="p">[</span><span class="s2">&#34;search&#34;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">_0x158088</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="nx">_0x158088</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">alert</span><span class="p">(</span><span class="s2">&#34;请求验证失败&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nx">go</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;bts&#34;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;1719472445.601|0|j3A&#34;</span><span class="p">,</span> <span class="s2">&#34;LtZQTMBXOgbV%2FXe2COV%2BT0%3D&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;chars&#34;</span><span class="o">:</span> <span class="s2">&#34;tbXoPOcGKMZFhHtkAwtyWm&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;ct&#34;</span><span class="o">:</span> <span class="s2">&#34;a87d9a030228c2462949c94a29ac05300528f760&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;ha&#34;</span><span class="o">:</span> <span class="s2">&#34;sha1&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;is&#34;</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;tn&#34;</span><span class="o">:</span> <span class="s2">&#34;__jsl_clearance_s&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;vt&#34;</span><span class="o">:</span> <span class="s2">&#34;3600&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="s2">&#34;wt&#34;</span><span class="o">:</span> <span class="s2">&#34;1500&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>setTimeout</code>函数是异步执行的，它不会立即返回值，做一下处理，并让<code>go</code>函数返回<code>cookies</code>。</p>
<blockquote>
<p><code>OB反混淆工具</code>有很多（你们常用哪些，欢迎评论区告诉我，让我<code>涨涨脑子</code>）:</p>
<ul>
<li><code>https://tool.yuanrenxue.cn/decode_obfuscator</code></li>
<li><code>https://de4js.kshift.me/</code>、<code>https://www.dejs.vip/2obfuscator</code></li>
<li>浏览器插件<code>v_tools</code>等</li>
</ul>
</blockquote>
<p>然后，我们迫不及待的运行：</p>
<p><code>node.exe .\final.js</code></p>
<p>回应我们的就是<code>ReferenceError: window is not defined</code>等报错，依次补上：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nb">window</span> <span class="o">=</span> <span class="p">{}</span> <span class="nb">window</span><span class="p">.</span><span class="nx">navigator</span><span class="o">=</span><span class="p">{</span> <span class="s1">&#39;userAgent&#39;</span><span class="o">:</span><span class="s1">&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.131 Safari/537.36&#39;</span> <span class="p">}</span> <span class="nb">document</span> <span class="o">=</span> <span class="nx">global</span> <span class="nx">location</span> <span class="o">=</span> <span class="p">{}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>再次运行得到：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">(</span>haige-py3.10<span class="o">)</span> &gt; node.exe .<span class="se">\f</span>inal.js
</span></span><span class="line"><span class="cl">1719472445.601<span class="p">|</span>0<span class="p">|</span>j3AZtLtZQTMBXOgbV%2FXe2COV%2BT0%3D
</span></span><span class="line"><span class="cl"><span class="nv">__jsl_clearance_s</span><span class="o">=</span>1719472445.601<span class="p">|</span>0<span class="p">|</span>j3AZtLtZQTMBXOgbV%2FXe2COV%2BT0%3D<span class="p">;</span>Max-age<span class="o">=</span>3600<span class="p">;</span> <span class="nv">path</span> <span class="o">=</span> /<span class="p">;</span> <span class="nv">SameSite</span><span class="o">=</span>None<span class="p">;</span> Secure
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>拿去和抓包得到的cookie进行比较，结果一致。</p>
</blockquote>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001qPkWG1rHzdx.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001qPkWG1rHzdx.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001qPkWG1rHzdx.jpg">
        
    </a></p>
<p>在<code>Pycharm</code>调试时，我们注意到：</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00002JyrsN0yGVqr.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00002JyrsN0yGVqr.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00002JyrsN0yGVqr.jpg">
        
    </a></p>
<p>我们注意到：条件成立时<code>_0x1f3544</code>为<code>1719472445.601|0|j3AZtLtZQTMBXOgbV%2FXe2COV%2BT0%3D</code>，正好是<code>__jsl_clearance_s</code>的值。</p>
<hr>
<p>尝试着全局搜索参数里的<code>sha1</code>：</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000307eR136NyIX.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000307eR136NyIX.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000307eR136NyIX.jpg">
        
    </a></p>
<p>发现只有参数里带了，所以不难推断：</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000014YDFA1a7xeM.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000014YDFA1a7xeM.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000014YDFA1a7xeM.jpg">
        
    </a></p>
<p>再找个在线网址验证下<code>sha1</code>也即这里的<code>hash</code>方法是否为魔改过的：</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000023kcxa2GGrHg.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000023kcxa2GGrHg.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000023kcxa2GGrHg.jpg">
        
    </a></p>
<p>至此，我们其实已经概率性拿到一些数据了（？？）。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#! -*-conding=: UTF-8 -*-</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @Author  : 海哥python</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @Software: PyCharm</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">sys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">execjs</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">loguru</span> <span class="kn">import</span> <span class="n">logger</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">fake_useragent</span> <span class="kn">import</span> <span class="n">UserAgent</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">ua</span> <span class="o">=</span> <span class="n">UserAgent</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_first_cookie</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">cookies</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cookies</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">cookies</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">aa_encode_text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;document.cookie=(.*?);location&#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">__jsl_clearance_s</span> <span class="o">=</span> <span class="n">execjs</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">aa_encode_text</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;;&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">cookies</span><span class="p">[</span><span class="s2">&#34;__jsl_clearance_s&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">__jsl_clearance_s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;=&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;get_first_cookie: </span><span class="si">{</span><span class="n">cookies</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">cookies</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_second_cookie_go_params</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">cookies</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">go_params</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;;go\((.*?)\)&lt;/script&gt;&#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">go_params</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_response_data</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">cookies</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;max&#34;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&#34;offset&#34;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">                           <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s2">&#34;utf-8&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">logger</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_second_cookies</span><span class="p">(</span><span class="n">cookies</span><span class="p">,</span> <span class="n">go_params</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">__jsl_clearance_s</span> <span class="o">=</span> <span class="n">execjs</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&#34;final.js&#34;</span><span class="p">,</span> <span class="s2">&#34;r&#34;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s2">&#34;go&#34;</span><span class="p">,</span> <span class="n">go_params</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">go_params</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cookies</span><span class="p">[</span><span class="s2">&#34;__jsl_clearance_s&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">__jsl_clearance_s</span>
</span></span><span class="line"><span class="cl">    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;cookies: </span><span class="si">{</span><span class="n">cookies</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">cookies</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.xxxx.xxx.cn/flaw/typelist?typeId=27&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">ua</span><span class="o">.</span><span class="n">random</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cookies</span> <span class="o">=</span> <span class="n">get_first_cookie</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">go_params</span> <span class="o">=</span> <span class="n">get_second_cookie_go_params</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">cookies</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cookies</span> <span class="o">=</span> <span class="n">get_second_cookies</span><span class="p">(</span><span class="n">cookies</span><span class="p">,</span> <span class="n">go_params</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">go_params</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">get_response_data</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">cookies</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>然鹅~~并不是每次都能得到我们要的数据！</strong></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00003NWZZM2MT00J.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00003NWZZM2MT00J.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00003NWZZM2MT00J.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000oz7tL0vfUO2.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000oz7tL0vfUO2.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000oz7tL0vfUO2.jpg">
        
    </a></p>
<blockquote>
<p>通过尝试（抓包），发现加密函数共有<code>sha256</code>、<code>sha1</code>、<code>md5</code>三种情况。</p>
</blockquote>
<p>因此，我们完全可以按照之前的步骤分别得到<code>sha256</code>、<code>sha1</code>、<code>md5</code>三种情况下的<code>js</code>代码，并根据第二次请求时返回的<code>js</code>中的<code>ha</code>调用对应的<code>js</code>得到最终的<code>__jsl_clearance_s</code>。</p>
<blockquote>
<p>又因<code>sha256</code>、<code>sha1</code>、<code>md5</code>的实现并未被魔改，因此完全可以使用<code>Javascript</code>（<code>npm install crypto-js</code>）或<code>python</code>进行简化改写。</p>
</blockquote>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000JW4ge1uBApB.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000JW4ge1uBApB.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000JW4ge1uBApB.jpg">
        
    </a></p>
<h2 id="其它调试方式" class="headerLink">
    <a href="#%e5%85%b6%e5%ae%83%e8%b0%83%e8%af%95%e6%96%b9%e5%bc%8f" class="header-mark"></a>其它调试方式</h2><p>其它调试方式还有很多，比较推荐的有：</p>
<h3 id="hook-cookie值使用油猴断一下set-cookie位置" class="headerLink">
    <a href="#hook-cookie%e5%80%bc%e4%bd%bf%e7%94%a8%e6%b2%b9%e7%8c%b4%e6%96%ad%e4%b8%80%e4%b8%8bset-cookie%e4%bd%8d%e7%bd%ae" class="header-mark"></a><code>Hook Cookie</code>值：使用油猴断一下set cookie位置</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;use strict&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">org</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="p">.</span><span class="nx">__lookupSetter__</span><span class="p">(</span><span class="s1">&#39;cookie&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nb">document</span><span class="p">.</span><span class="nx">__defineSetter__</span><span class="p">(</span><span class="s1">&#39;cookie&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">cookie</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="p">(</span><span class="nx">cookie</span><span class="p">.</span><span class="nx">indexOf</span><span class="p">(</span><span class="s1">&#39;__jsl_clearance_s&#39;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="kr">debugger</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="nx">org</span> <span class="o">=</span> <span class="nx">cookie</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">    <span class="nb">document</span><span class="p">.</span><span class="nx">__defineGetter__</span><span class="p">(</span><span class="s1">&#39;cookie&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="nx">org</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">})();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00002H04We1otCEl.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00002H04We1otCEl.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00002H04We1otCEl.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00003mTMq71j363h.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00003mTMq71j363h.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00003mTMq71j363h.jpg">
        
    </a></p>
<p>清除 cookie 重新刷新页面，页面被成功断住：</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00002NoBjd1DTy9w.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00002NoBjd1DTy9w.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00002NoBjd1DTy9w.jpg">
        
    </a></p>
<p>然后就可以尝试调试了，这里不做过多介绍。</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00003ngElC1lUMqt.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00003ngElC1lUMqt.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00003ngElC1lUMqt.jpg">
        
    </a></p>
<hr>
<h3 id="文件替换利用-fiddler-的自动响应" class="headerLink">
    <a href="#%e6%96%87%e4%bb%b6%e6%9b%bf%e6%8d%a2%e5%88%a9%e7%94%a8-fiddler-%e7%9a%84%e8%87%aa%e5%8a%a8%e5%93%8d%e5%ba%94" class="header-mark"></a>文件替换：利用 Fiddler 的<code>自动响应</code>。</h3><p>将第二次请求获取的<code>js</code>代码保存下来，可以手动复制，也可以向下面这样：</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001M1d5h2Orjxl.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001M1d5h2Orjxl.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001M1d5h2Orjxl.jpg">
        
    </a></p>
<p>对响应内容进行<code>js</code>美化（<code>https://spidertools.cn/#/formatJS</code>）</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00003XxAnC3DLpkP.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00003XxAnC3DLpkP.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00003XxAnC3DLpkP.jpg">
        
    </a></p>
<p>清除cookie刷新，也能进行调试了：</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001toKXM3KoqTY.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001toKXM3KoqTY.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001toKXM3KoqTY.jpg">
        
    </a></p>
<hr>
<h3 id="文件替换利用-chrome-的文件替换" class="headerLink">
    <a href="#%e6%96%87%e4%bb%b6%e6%9b%bf%e6%8d%a2%e5%88%a9%e7%94%a8-chrome-%e7%9a%84%e6%96%87%e4%bb%b6%e6%9b%bf%e6%8d%a2" class="header-mark"></a>文件替换：利用 Chrome 的文件替换</h3><p>同上，将<code>js</code>代码美化后保存在本地，可能需要一些微调，例如：首尾<code>Script</code>标签前后会多出空格以及脚本最后可能多出<code>/</code>等。补上<code>debuuger;</code>即可进行替换调试：</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000043rZnD4ScgIS.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000043rZnD4ScgIS.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000043rZnD4ScgIS.jpg">
        
    </a></p>
<p>然后将文件内容替换为上面美化处理后的<code>js</code>代码，清除 cookies 并刷新页面即可调试。</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00003nF4tq1MvPjz.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00003nF4tq1MvPjz.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00003nF4tq1MvPjz.jpg">
        
    </a></p>
<h2 id="结果验证" class="headerLink">
    <a href="#%e7%bb%93%e6%9e%9c%e9%aa%8c%e8%af%81" class="header-mark"></a>结果验证</h2><p>根据上面的分析，我们拿到了每次请求所需要的<code>cookie</code>，发起请求就是很简单的事了。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span><span class="lnt">83
</span><span class="lnt">84
</span><span class="lnt">85
</span><span class="lnt">86
</span><span class="lnt">87
</span><span class="lnt">88
</span><span class="lnt">89
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#! -*-conding=: UTF-8 -*-</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @Author  : 海哥python</span>
</span></span><span class="line"><span class="cl"><span class="c1"># @Software: PyCharm</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">hashlib</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">execjs</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">loguru</span> <span class="kn">import</span> <span class="n">logger</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">fake_useragent</span> <span class="kn">import</span> <span class="n">UserAgent</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">ua</span> <span class="o">=</span> <span class="n">UserAgent</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_first_cookie</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">cookies</span> <span class="o">=</span> <span class="p">{}</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cookies</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">cookies</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">aa_encode_text</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;document.cookie=(.*?);location&#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">__jsl_clearance_s</span> <span class="o">=</span> <span class="n">execjs</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">aa_encode_text</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;;&#34;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">cookies</span><span class="p">[</span><span class="s2">&#34;__jsl_clearance_s&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">__jsl_clearance_s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&#34;=&#34;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;get_first_cookie: </span><span class="si">{</span><span class="n">cookies</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">cookies</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_second_cookie_go_params</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">cookies</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">go_params</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;;go\((.*?)\)&lt;/script&gt;&#39;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">go_params</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_final_jsl_clearance</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">chars</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;chars&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">chars</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">chars</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">            <span class="n">clearance</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bts&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;chars&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;chars&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;bts&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">            <span class="n">encrypt</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ha&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;md5&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">encrypt</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">md5</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ha&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;sha1&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">encrypt</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha1</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">elif</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ha&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;sha256&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">encrypt</span> <span class="o">=</span> <span class="n">hashlib</span><span class="o">.</span><span class="n">sha256</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="n">encrypt</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">clearance</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span> <span class="o">=</span> <span class="n">encrypt</span><span class="o">.</span><span class="n">hexdigest</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ct&#39;</span><span class="p">]:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="n">clearance</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_response_data</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">cookies</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;max&#34;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&#34;offset&#34;</span><span class="p">:</span> <span class="mi">20</span><span class="p">},</span>
</span></span><span class="line"><span class="cl">                            <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">response</span><span class="o">.</span><span class="n">encoding</span> <span class="o">=</span> <span class="s2">&#34;utf-8&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">logger</span><span class="o">.</span><span class="n">success</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_second_cookies</span><span class="p">(</span><span class="n">cookies</span><span class="p">,</span> <span class="n">go_params</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 方法一：原始js, 这里只有sha1的，所以md5和sha256时会拿不到数据，请按照教程自己分析</span>
</span></span><span class="line"><span class="cl">    <span class="n">__jsl_clearance_s</span> <span class="o">=</span> <span class="n">execjs</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&#34;final.js&#34;</span><span class="p">,</span> <span class="s2">&#34;r&#34;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">call</span><span class="p">(</span><span class="s2">&#34;go&#34;</span><span class="p">,</span> <span class="n">go_params</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">go_params</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># 方法二： js改写</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># __jsl_clearance_s = execjs.compile(open(&#34;__jsl_clearance_s.js&#34;, &#34;r&#34;, encoding=&#34;utf-8&#34;).read()).call(</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># &#34;get__jsl_clearance_s&#34;, go_params)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># 方法三：python改写</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># __jsl_clearance_s = get_final_jsl_clearance(go_params)  # 通过python脚本获取到jsl_clearance_s</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">cookies</span><span class="p">[</span><span class="s2">&#34;__jsl_clearance_s&#34;</span><span class="p">]</span> <span class="o">=</span> <span class="n">__jsl_clearance_s</span>
</span></span><span class="line"><span class="cl">    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;cookies: </span><span class="si">{</span><span class="n">cookies</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">cookies</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
</span></span><span class="line"><span class="cl">    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.xxxx.xxx.cn/flaw/typelist?typeId=27&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">ua</span><span class="o">.</span><span class="n">random</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">cookies</span> <span class="o">=</span> <span class="n">get_first_cookie</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">go_params</span> <span class="o">=</span> <span class="n">get_second_cookie_go_params</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">cookies</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">cookies</span> <span class="o">=</span> <span class="n">get_second_cookies</span><span class="p">(</span><span class="n">cookies</span><span class="p">,</span> <span class="n">go_params</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">go_params</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">get_response_data</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">cookies</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">main</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="小结" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93" class="header-mark"></a>小结</h2><p>遵循文章的指导逆向操作整个解密流程，您会发现这一过程相对简单。关键在于熟练掌握三次请求的顺序及其各自的特征，一旦熟悉这些要点，整个过程将无甚难度。</p>
<h2 id="最后" class="headerLink">
    <a href="#%e6%9c%80%e5%90%8e" class="header-mark"></a>最后</h2><p>如果你觉得文章还不错，请大家<code>点赞、关注、分享、在看</code>下，因为这将是我持续输出更多优质文章的最强动力！</p>
<p>欢迎随时与我联系，我期待与大家交流心得，共同学习，共同进步。</p>]]></description>
</item></channel>
</rss>
